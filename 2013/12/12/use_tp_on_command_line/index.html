<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>在Command Line中使用TexturePacker - Justbilt</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=Tool,TexturePacker>
  
    <meta name="description" content="A game developer">
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  
    <link rel="alternate" href="/atom.xml " title="Justbilt" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/style.css">
</head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">Justbilt</a>
    <div class="subtitle">A game developer</div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">主页</a>
        </li>
      
        <li class="menu-item">
          <a href="/about" class="menu-item-link">关于</a>
        </li>
      
        <li class="menu-item">
          <a href="/atom.xml" class="menu-item-link">RSS</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">在Command Line中使用TexturePacker</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2013-12-12</span>
  </div>
  <div class="post-content">
    <p>TexturePacker是一个非常好用的小图合并工具,介绍它的文章非常多,多数都是使用GUI工具的,但是:</p>
<ol>
<li>如果原始图片发生了改变,我们就需要重新手动拼接一下,麻烦.</li>
<li>使用GUI界面<strong>非常不高端</strong>,我高大猿族绝对首选使用Command Line啊.</li>
</ol>
<p>安装TexturePacker会附带一个command line工具,让我们一起学习一下如何使用吧.<br><a id="more"></a></p>
<p>##环境搭建<br>我一般首选在Windows下开发(不要打我),这里就只讲Windows环境的配置</p>
<p>1.先去<a href="http://www.codeandweb.com/texturepacker" target="_blank" rel="noopener">这里</a>下载安装文件,完成后一路无脑下一步,OK.</p>
<p>2.大家在<code>C:\Program Files\TexturePacker\bin</code>目录下可以看到两个exe文件,<code>TexturePacker.exe</code>和<code>TexturePackerGUI.exe</code>,前者是命令行工具,后者是GUI工具.</p>
<p>3.默认<code>TexturePacker</code>是没有加到环境变量中的,我们需要手动来,右键点击<strong>计算机</strong>-&gt;<strong>属性</strong>-&gt;<strong>高级系统设置</strong>-&gt;<strong>环境变量</strong>,找到<code>PATH</code>后将<code>C:\Program Files\TexturePacker\bin</code>添加到末尾,注意要在前面加<code>;</code>.</p>
<p>4.运行cmd,输入<code>TexturePacker</code>大家应该能够看到下面的内容:<br><img src="http://ww1.sinaimg.cn/large/7f870d23jw1ebgr9fza56j20mo08rabj.jpg" alt=""><br>如果不能的话请检查拼写和第<code>2</code>步.大家可以仔细阅读一下内容,写的十分详细,用过TexturePacker的话基本上都能对应起来.</p>
<p>##小试牛刀<br>你过你看完打印出的信息的话可以发下末尾部分有三个示例,如下:<br><img src="http://ww4.sinaimg.cn/large/7f870d23jw1ebgrdsac69j20qj06rgmj.jpg" alt=""><br>看起啦十分简单,让我们试一下吧,感谢微博小伙伴<a href="http://weibo.com/1061005610/A8lXXwagW" target="_blank" rel="noopener">@sosoayaen</a>发现的小秘密,使得我们可以快速的在任意位置打开命令行.找一个有这一堆图片的文件夹的上层目录,按住<code>Shift</code>点击<code>右键</code>,会发现一个菜单项<code>在当前目录打开命令行</code>,打开后按照示例输入<code>TexturePacker 001/*.png</code>,然后如示例说的:</p>
<blockquote>
<p>creates out.plist and out.png from all png files in assets<br> trimming all files and creating a texture with max. 2048x2048px</p>
</blockquote>
<p>实际情况却不完全是这样的,你可能会得到这样的错误:</p>
<p><img src="http://ww1.sinaimg.cn/large/7f870d23jw1ebgt6ya8d9j20iq0820te.jpg" alt=""><br>卧槽,这是什么情况啊,明明就是按照官方的示例来的嘛,google完全没有任何答案啊,经过一番痛苦的实验后,终于发现了原因所在,这里不能输入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TexturePacker 001/*.png</span><br></pre></td></tr></table></figure></p>
<p>而应该是这个样子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TexturePacker 001</span><br></pre></td></tr></table></figure></p>
<p><strong>这个问题可能是由于我使用的版本太旧或使用Windows导致的,如果你没有遇到,那么最好!</strong></p>
<p>##参数详解<br>本想着把所有参数都讲一遍,写到一半发现卧槽太多了,而且好些都用不到,这里挑一些常用的分析下,<strong>以下内容都有进行测试</strong>,还是比较准确的,如果有问题,欢迎指出.<br>注:</p>
<ol>
<li>选项含有<code>&lt;...&gt;</code>的选项表示含有参数需要填写.</li>
<li>粗体表示比较重要的选项.</li>
</ol>
<h2 id="输出"><a href="#输出" class="headerlink" title="####输出"></a>####输出</h2><p><strong>–sheet</strong> <code>&lt;filename&gt;</code><br>+生成的图片名,支持<strong>png,jpg,pvr,pvr.czz,pvr.gz</strong>格式<br>+示例:<code>--sheet out.png</code></p>
<p><strong>–data</strong> <code>&lt;filename&gt;</code></p>
<ul>
<li>生成的plist文件名 </li>
<li>示例:<code>--data out.plist</code></li>
</ul>
<p><strong>–format</strong> <code>&lt;format&gt;</code></p>
<ul>
<li>生成的plist格式,我们使用cocos2d格式 </li>
<li>示例:<code>--format cocos2d</code></li>
<li>注:其他支持格式见下图:<br><img src="http://ww1.sinaimg.cn/large/7f870d23jw1ebgwbnyra9j20fx083aay.jpg" alt=""></li>
</ul>
<p><strong>–auto-sd</strong></p>
<ul>
<li>自动生成sd资源</li>
<li>示例:<code>--auto-sd</code></li>
<li>注:这个要注意一点,如果要使用这个参数,你输入的<code>sheet</code>和<code>data</code>名必须含有<code>-hd</code>或<code>@2x</code>,TP会自动生成不带后缀的sd数据.</li>
</ul>
<p>–texturepath <code>&lt;path&gt;</code></p>
<ul>
<li>在生成的<code>sheet</code>文件的路径前加你<path></path></li>
<li>示例:<code>--texturepath image/tower</code> 这样在plist文件中<code>realTextureFileName</code>的值为<code>image/tower/out.png</code></li>
<li>注:这个参数主要用在当你的<strong>图片与plist文件不再同一个目录</strong>时使用,不会改变<code>out.png</code>的目录</li>
</ul>
<p>–trim-sprite-name</p>
<ul>
<li>剪裁掉拼接图片的后缀名</li>
<li>示例:<code>--trim-sprite-name</code> 这样在plist文件中<code>&lt;key&gt;001.png&lt;/key&gt;</code>会变成<code>&lt;key&gt;001&lt;/key&gt;</code></li>
<li>注:是剪裁用来拼接的文件而不是生成文件,如果你的资源管理类似于android那样,使用图片时不加后缀名,那么打包时可以使用这个选项</li>
</ul>
<p><strong>–replace</strong> <code>&lt;regexp&gt;=&lt;string&gt;</code></p>
<ul>
<li>按照原文的翻译是使用<code>&lt;string&gt;</code>替换掉拼接图片的文件名中正则表达式匹配的字符串</li>
<li><strong>卧槽,正则表达式啊一听就尼玛高大强啊,可惜老夫不会啊,怎么办呢?回家去翻翻金瓶梅改天告诉大家.</strong></li>
<li>这个TM太有用了,后面我遇到的那个问题,用这个来解决最好不过了</li>
</ul>
<p>–ignore-files <code>&lt;regexp&gt;</code></p>
<ul>
<li>按照原文的翻译是忽略所有满足给定条件的图片(可以使用时间作为条件),你可以使用<code>*</code>或<code>?</code>,但在使用bash时应避免使用通配符.</li>
</ul>
<h2 id="尺寸"><a href="#尺寸" class="headerlink" title="####尺寸"></a>####尺寸</h2><p>先上一张cocos2d-x支持的最大图片尺寸:<br><img src="http://ww4.sinaimg.cn/large/7f870d23jw1ebh3kmq7ebj205i05awej.jpg" alt=""><br>还有官方的这句话:</p>
<blockquote>
<p> For the developers, if you want to cross platforms and run your games smoothly, you should keep your texture size <strong>less than 1024*1024</strong>, that is the lowest restriction for most machines.</p>
</blockquote>
<p><strong>–width/–height</strong> <code>&lt;int&gt;</code></p>
<ul>
<li>两个参数,放在一块说了,设置输出图片的宽度/高度</li>
<li>示例:<code>--width 100</code> <code>--height 100</code></li>
<li>注:这个值设置的大了无所谓,会产生空白区域,但是如果太小,就会报错:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: Could not fit all sprites into the sprite sheet.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>–max-width/–max-height/–max-size</strong> <code>&lt;int&gt;</code></p>
<ul>
<li>设置输出图片的最大宽度/高度/尺寸</li>
<li>示例:<code>--max-width 1024</code> <code>--max-height 1024</code> 前面两个等价于后面 <code>--max-size 1024</code></li>
<li>注:<br>  1.和上面两个参数的区别在于告诉TP实际值别超过这个值就OK,而上边那两个参数告诉TP实际值一定是这个.<br>  2.默认值为<code>2048</code><br>  3.如果实际值大于设置的最大值会产生错误:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: Sprite sheet size is too small.</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>–allow-free-size</strong></p>
<ul>
<li>允许输出图片不是2的幂,以最小尺寸输出</li>
<li>示例:<code>--allow-free-size</code></li>
<li>注:这个一般开启,cocos2d-x2.0开始就已经支持图片不是2的幂了</li>
</ul>
<h2 id="间距和旋转"><a href="#间距和旋转" class="headerlink" title="####间距和旋转"></a>####间距和旋转</h2><p>–shape-padding <code>&lt;int&gt;</code></p>
<ul>
<li>图块之间缝隙的宽度,默认值是<code>2</code></li>
<li>示例:<code>--shape-padding 100</code></li>
</ul>
<p>–border-padding <code>&lt;int&gt;</code></p>
<ul>
<li>可以理解为边框的宽度,默认值为<code>2</code></li>
<li>示例:<code>--border-padding 100</code></li>
</ul>
<p>–padding <int></int></p>
<ul>
<li>间距,这个参数等价于上面两个参数同时同时作用</li>
<li>示例:<code>--padding 100</code></li>
<li>注:如果没有开启<code>--allow-free-size</code>可能和你想象的不太一样</li>
</ul>
<p>–inner-padding <int></int></p>
<ul>
<li>试了一下,这个参数的作用应该是给每个sprite的周围加一个边框,默认值为0</li>
<li>示例:<code>--inner-padding 100</code></li>
<li>注:上面的这几个参数作用都不是很大</li>
</ul>
<p>–enable-rotation/diable-rotation</p>
<ul>
<li>开启/关闭旋转,默认值和输出的格式有关系,cococ2d格式默认enable</li>
<li>示例<code>--enable-rotation</code> <code>--diable-rotation</code></li>
<li>注:这个很好理解,为了排版更密集些,有的图片会被旋转</li>
</ul>
<p><strong>–trim/no-trim</strong></p>
<ul>
<li>剪裁图片,即移除图片周围的透明像素,保留原始尺寸,默认开启</li>
<li>示例:<code>--trim</code> <code>no-trim</code></li>
<li>注:这个要格外注意一下,这个参数略<strong>微有些问题</strong>,如果没有了解带来的后果的话还是使用<code>--no-trim</code>更安全些,我会在后面的仔细讲一下.</li>
</ul>
<p><strong>–crop</strong></p>
<ul>
<li>与上面的一条类似,移除图片四周的透明像素,不保留原始尺寸,保存为一张更小的图片</li>
<li>示例:<code>--crop</code></li>
<li>注:同上,要小心使用,尽量不在这里使用,而是改为前期用其它工具处理</li>
</ul>
<p>–trim-threshold <int></int></p>
<ul>
<li>与Trim类似,只是这个选项有一个参数,表示剪裁掉alpha值小于这个参数的像素,取值<code>0~255</code>,默认为<code>0</code>.</li>
<li>示例:<code>--trim-threshold</code></li>
</ul>
<p><strong>–disable-auto-alias</strong></p>
<ul>
<li>关闭自动命名,什么意思呢?<strong>TP在打包时会自动识别相同的图片,最终在大图里只会保留一张</strong>,这样会更加的节省资源,这个参数将会关闭这个功能</li>
<li>示例:<code>--disable-auto-alias</code></li>
<li>注:这样参数还是<strong>不要设置</strong>的好</li>
</ul>
<h2 id="其他常用选项"><a href="#其他常用选项" class="headerlink" title="####其他常用选项"></a>####其他常用选项</h2><p><strong>–opt</strong> <pixelformat></pixelformat></p>
<ul>
<li>设置输出图片的像素格式 一般默认RGBA8888</li>
<li>示例:<code>--opt RGB444</code></li>
<li>注:这个选项一般不做更改,如果想压缩资源体积的话,可以改为RGBA4444这样图片可以减小一半的体积.具体大家可以看下面这张图:<br><img src="http://ww3.sinaimg.cn/large/7f870d23jw1ebi5nnszqmj20po0g0go5.jpg" alt=""></li>
</ul>
<p>##常见问题</p>
<p><strong>错误:</strong> error: Error in sprite: <em>.png: Failed to load image!<br><strong>解决方案:</strong> 去掉目标路径末尾的</em>.png试试.</p>
<p><strong>错误:</strong> error: Could not fit all sprites into the sprite sheet.<br><strong>解决方案:</strong><br>1.查看有无设置<code>--width or --height</code>,这个错误通常是由于输出图片的尺寸太小导致的.<br>2.查看有无<code>--max-width/--max-height/--max-size</code>,没有的话加上,有的话将参数值改大一些.</p>
<p><strong>错误:</strong> error: Sprite sheet size is too small.<br><strong>解决方案:</strong>参见上个错误中的解决方案2,<code>--max-width/--max-height/--max-size</code>默认值为<code>2048</code>,试着改成<code>4096</code>试试,如果解决了,不要高兴,因为大多数移动设备都不支持这个尺寸,可以考虑分开打包.</p>
<p><strong>错误:</strong> error: Unknown argument –XXX - please check parameters or visit <a href="http://www.texturepacker.com" target="_blank" rel="noopener">http://www.texturepacker.com</a> for newer version<br><strong>解决方案:</strong> 检查XXX的拼写是否正确</p>
<p><strong>问题:</strong> 程序中获得图片的尺寸与打包前不一致<br><strong>解决方案:</strong> 检查参数是否含有<code>--crop</code>,有的话删除,有没有<code>--no-trim</code>,没有的话加上.</p>
<p>##后记<br>讲了那么多参数,其实常用的没有几个,下面这个是我最终使用的命令:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TexturePacker --sheet out.png --data out.plist --allow-free-size --no-trim --max-size 1024 --format cocos2d animation</span><br></pre></td></tr></table></figure></p>
<p>文章到这里就要结束了,但其实还没有完,<code>--trim</code>到底为什么不建议使用?使用了会发生什么问题?它和<code>--crop</code>的具体区别在哪里?plist文件中frame的路径和其他plist的重复了怎么办?程序中怎么做才能做到打包和不打包的差异最小化?金瓶梅你什么时候看完?</p>
<p>我后面会再写一篇文章来讲这些东西(逃).</p>
<p><strong>全文完</strong></p>

  </div>
  <div class="post-footer">
    
      <ul class="post-tag-list"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/TexturePacker/">TexturePacker</a></li><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/Tool/">Tool</a></li></ul>
    

    <a href="#top" class="top">返回顶部</a>
  </div>
</article>
<footer>
  &copy; 2018
  <span class="author">
    justbilt
  </span>
</footer>
    </div>
  </body>
</html>