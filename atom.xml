<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Justbilt</title>
  <icon>https://www.gravatar.com/avatar/6429058864fe769b15bf04d2dbb7cb98</icon>
  <subtitle>A game developer</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.justbilt.com/"/>
  <updated>2017-12-18T15:02:18.539Z</updated>
  <id>http://blog.justbilt.com/</id>
  
  <author>
    <name>justbilt</name>
    <email>wangbilt@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç”¨ python æ’¸ä¸€ä¸ª ccbwriter</title>
    <link href="http://blog.justbilt.com/2017/12/17/python-ccbwriter/"/>
    <id>http://blog.justbilt.com/2017/12/17/python-ccbwriter/</id>
    <published>2017-12-17T04:50:25.000Z</published>
    <updated>2017-12-18T15:02:18.539Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å¯èƒ½å’Œå¤§å®¶è¯´è¿‡æˆ‘ä»¬é¡¹ç›®çš„ UI ç¼–è¾‘å™¨æ˜¯ä¸Šå¤ç¥å™¨ <a href="https://github.com/cocos2d/CocosBuilder" target="_blank" rel="noopener">CocosBuilder</a>, è¿™ä¸ªç¼–è¾‘å™¨çš„è¯ç”Ÿåœ¨é‚£ä¸ª cocos2d-x è¿˜éœ€æ‰‹å†™ ui ä»£ç çš„å¹´ä»£, ç¡®å®æ˜¯ cocos å‘å±•å²ä¸Šé‡è¦çš„è½¬æŠ˜ç‚¹, å®ƒæ ‡å¿—ç€è§¦å±æ‰‹æœºæ¸¸æˆè¡Œä¸š ui ä¸å†åƒä¹‹å‰é‚£æ ·åªæ˜¯ç®€å•çš„ä¸²è”çš„ä½œç”¨, è€Œæ˜¯åƒç«¯æ¸¸é‚£æ ·é‡äº¤äº’, å¯è§†åŒ–ç¼–è¾‘çš„è·¯çº¿.</p><p>å°½ç®¡åœ¨ä»Šå¤©, CocosBuilder æƒ³æ¯”äºå·²ç»æ­»æ‰çš„ CocosStudio, ç”šè‡³äº Cocos ç°åœ¨å¤§åŠ›æ¨å¹¿çš„ CocosCreator éƒ½æœ‰ä¸€äº›éš¾ä»¥æ›¿ä»£çš„ç†ç”±, å°¤å…¶æ˜¯åœ¨å¼€æºå’Œç¨³å®šæ€§æ–¹é¢. æˆ‘ä»¬ä¹Ÿä¸ä¾‹å¤–, ç°åœ¨ä»æœ‰å¤šæ¬¾é¡¹ç›®åœ¨ä½¿ç”¨è¿™ä¸ªç¼–è¾‘å™¨, å•ä¸ªé¡¹ç›® CocosBuilder çš„ç•Œé¢ ccb æ–‡ä»¶æ•°é‡æœ€é«˜åœ¨ 500+, è¿™å¯¹äºç»´æŠ¤è¿™äº›ç•Œé¢çš„ç¾æœ¯åŒå­¦æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æŒ‘æˆ˜. ä¸ºäº†ä¸è®©å¯çˆ±çš„ç¾æœ¯å¦¹å­ç–²äºå¥”å‘½, æˆ‘ä»¬ç¨‹åºç»„è‡ªç„¶è¦è´¡çŒ®æˆ‘ä»¬çš„ä¸€ä»½åŠ›é‡, å†™ä¸€äº›æ‰¹å¤„ç†çš„è„šæœ¬, è§£å†³é‚£äº›æ— è„‘ä½†æ˜¯ä¼šå¤§é‡é‡å¤çš„å·¥ä½œ, æ‹¯æ•‘å¦¹å­ä»¬ä¸æ°´ç«ä¹‹ä¸­.</p><p>åœ¨å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­, ä¸å…è¦å’Œ ccb æ–‡ä»¶æ‰“äº¤é“, è¿™ç§æ–‡ä»¶çš„å…¸å‹æ ¼å¼æ˜¯è¿™æ ·çš„:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>CocosBuilder<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>fileVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">integer</span>&gt;</span>4<span class="tag">&lt;/<span class="name">integer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>guides<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>position<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">real</span>&gt;</span>-2346<span class="tag">&lt;/<span class="name">real</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>jsControlled<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>nodeGraph<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>baseClass<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>CCNode<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>children<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>customClass<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span><span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>displayName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>CCNode<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æ ccb2lua é¡¹ç›®æ—¶æˆ‘æ›¾å†™è¿‡ä¸€ä¸ª ccbreader ç»„ä»¶, æŠŠ ccb æ–‡ä»¶å½“åš xml æ¥è§£æ, ä¸€è¡Œæ˜¯ <code>key</code>, ä¸‹ä¸€è¡Œæ˜¯ <code>value</code>. ç›´åˆ°åœ¨ Mac ä¸Šå·¥ä½œçš„ä¹…äº†, æ‰çŸ¥é“è¿™ç§ç‰¹æ®Šçš„ xml æ˜¯ä¸€ç§åä¸º <a href="https://zh.wikipedia.org/wiki/%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8" target="_blank" rel="noopener">Property List</a> çš„æ–‡ä»¶.</p><h1 id="ä¸€-ä½¿ç”¨-python-plistlib-åº“è§£æ"><a href="#ä¸€-ä½¿ç”¨-python-plistlib-åº“è§£æ" class="headerlink" title="ä¸€. ä½¿ç”¨ python plistlib åº“è§£æ"></a>ä¸€. ä½¿ç”¨ python plistlib åº“è§£æ</h1><p>è€Œä½œä¸ºæˆ‘å¸ç¬¬ä¸€è¯­è¨€çš„ Python è‡ªç„¶ä¹Ÿæœ‰å¯¹åº”çš„è§£æåº“ <a href="https://docs.python.org/2/library/plistlib.html" target="_blank" rel="noopener">plistlib</a>, è¿™æ˜¯ä¸€ä¸ªå†…ç½®çš„åº“, ä¸éœ€è¦å®‰è£…ç›´æ¥å°±èƒ½ä½¿ç”¨, ç”¨æ³•ä¹Ÿå¾ˆç®€å•.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plistlib</span><br><span class="line">plist = plistlib.readPlist(<span class="string">"/path/of/you/plistfile"</span>)</span><br><span class="line"><span class="keyword">print</span> plist</span><br><span class="line">plist[<span class="string">"somekey"</span>] = <span class="string">"some value"</span></span><br><span class="line">plistlib.writePlist(plist, <span class="string">"/path/of/you/another/plistfile"</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„è¯»å–ä¿®æ”¹å†™å…¥ plist æ–‡ä»¶çš„ä¾‹å­, ä½†æ˜¯ä»¤äººæ²®ä¸§çš„æ˜¯å³ä¾¿æˆ‘ä»€ä¹ˆéƒ½ä¸åš, ä½†æ˜¯è¯»å–å†å†™å…¥æ•´ä¸ªæ–‡ä»¶ä¹Ÿä¼šå‘ç”Ÿå¾ˆå¤šçš„å˜åŠ¨:</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@@ -18,7 +18,7 @@</span></span><br><span class="line">                        &lt;key&gt;position&lt;/key&gt;</span><br><span class="line"><span class="deletion">-                       &lt;real&gt;-2346&lt;/real&gt;</span></span><br><span class="line"><span class="addition">+                       &lt;real&gt;-2346.0&lt;/real&gt;</span></span><br><span class="line"><span class="meta">@@ -33,7 +33,8 @@</span></span><br><span class="line">                                &lt;key&gt;children&lt;/key&gt;</span><br><span class="line"><span class="deletion">-                               &lt;array/&gt;</span></span><br><span class="line"><span class="addition">+                               &lt;array&gt;</span></span><br><span class="line"><span class="addition">+                               &lt;/array&gt;</span></span><br><span class="line"><span class="meta">@@ -62,8 +63,8 @@</span></span><br><span class="line">                                                &lt;string&gt;ScaleLock&lt;/string&gt;</span><br><span class="line">                                                &lt;key&gt;value&lt;/key&gt;</span><br><span class="line">                                                &lt;array&gt;</span><br><span class="line"><span class="deletion">-                                                       &lt;real&gt;1&lt;/real&gt;</span></span><br><span class="line"><span class="deletion">-                                                       &lt;real&gt;1&lt;/real&gt;</span></span><br><span class="line"><span class="addition">+                                                       &lt;real&gt;1.0&lt;/real&gt;</span></span><br><span class="line"><span class="addition">+                                                       &lt;real&gt;1.0&lt;/real&gt;</span></span><br><span class="line">                                                &lt;/array&gt;</span><br></pre></td></tr></table></figure><p>ä¸»è¦å‘ç”Ÿåœ¨è¿™ä¹ˆå‡ ä¸ªåœ°æ–¹:</p><h2 id="1-æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜"><a href="#1-æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜" class="headerlink" title="1. æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜"></a>1. æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åŸå§‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">real</span>&gt;</span>-2346<span class="tag">&lt;/<span class="name">real</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å˜ä¸º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">real</span>&gt;</span>-2346.0<span class="tag">&lt;/<span class="name">real</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åŸå§‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">real</span>&gt;</span>941.91412353515625<span class="tag">&lt;/<span class="name">real</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å˜ä¸º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">real</span>&gt;</span>941.9141235351562<span class="tag">&lt;/<span class="name">real</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-ç©ºçš„-array-å’Œ-dict"><a href="#2-ç©ºçš„-array-å’Œ-dict" class="headerlink" title="2. ç©ºçš„ array å’Œ dict"></a>2. ç©ºçš„ array å’Œ dict</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åŸå§‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å˜ä¸º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åŸå§‹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å˜ä¸º --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™äº›å˜åŠ¨ä¸ä¼šå½±å“è¯¥æ–‡ä»¶çš„å†æ¬¡è¯»å–, å¹¶ä¸”å½“åœ¨ CocosBuilder å†æ¬¡ä¿å­˜æ—¶åˆä¼šè¿˜åŸå›å», ä½†æ˜¯è¿™ä¼šé€ æˆä¸¤ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜:</p><ol><li>å½±å“å…¶ä»–æˆå‘˜ review æ›´æ”¹, æ— æ³•è¯†åˆ«å‡ºçœŸæ­£çš„å˜åŠ¨</li><li>å¢åŠ åˆå¹¶æ—¶äº§ç”Ÿå†²çªçš„å¯èƒ½</li></ol><p>å°¤å…¶æ˜¯ç¬¬äºŒç‚¹, ccb æ–‡ä»¶ä¸€æ—¦å†²çª, åŸºæœ¬å¾ˆéš¾è§£å†³, åªèƒ½é€‰æ‹©æ”¾å¼ƒä¸€æ–¹çš„ä¿®æ”¹, è¿™ä¸ªæŸå¤±æ˜¯æ— æ³•å®¹å¿çš„. è¦è§£å†³è¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¯ä»¥æœ‰å¤šç§è§£å†³æ–¹æ¡ˆ:</p><ol><li>åƒå½“æ—¶å†™ ccbreader ä¸€æ ·å®Œå…¨æ‰‹æ’¸ä¸€ä¸ª ccbwriter</li><li>çœ‹ä¸‹ plistlib æ˜¯å¦å¯ä»¥å®šåˆ¶ä¸‹è§£æå™¨å’Œå†™å…¥ä»£ç </li></ol><h1 id="äºŒ-æ”¹é€ -plistlib"><a href="#äºŒ-æ”¹é€ -plistlib" class="headerlink" title="äºŒ. æ”¹é€  plistlib"></a>äºŒ. æ”¹é€  plistlib</h1><p>ç»è¿‡ä¸€ç•ªè€ƒè™‘, æˆ‘é€‰æ‹©äº†ç¬¬äºŒç§æ–¹æ¡ˆ, å®˜æ–¹æ–‡æ¡£ä¸Šå¯¹ plistlib è¯´æ˜å¾ˆå°‘, æˆ‘ä»¬åªèƒ½ä»å®ƒçš„æºç å…¥æ‰‹. æˆ‘ç”µè„‘ä¸Šå®ƒä½äºè¿™ä¸ªä½ç½®:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é‡ç‚¹çœ‹ <code>readPlist</code> å’Œ <code>writePlist</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">readPlist</span><span class="params">(pathOrFile)</span>:</span></span><br><span class="line">    didOpen = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(pathOrFile, (str, unicode)):</span><br><span class="line">        pathOrFile = open(pathOrFile)</span><br><span class="line">        didOpen = <span class="number">1</span></span><br><span class="line">    p = PlistParser()</span><br><span class="line">    rootObject = p.parse(pathOrFile)</span><br><span class="line">    <span class="keyword">if</span> didOpen:</span><br><span class="line">        pathOrFile.close()</span><br><span class="line">    <span class="keyword">return</span> rootObject</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">writePlist</span><span class="params">(rootObject, pathOrFile)</span>:</span></span><br><span class="line">    didOpen = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(pathOrFile, (str, unicode)):</span><br><span class="line">        pathOrFile = open(pathOrFile, <span class="string">"w"</span>)</span><br><span class="line">        didOpen = <span class="number">1</span></span><br><span class="line">    writer = PlistWriter(pathOrFile)</span><br><span class="line">    writer.writeln(<span class="string">"&lt;plist version=\"1.0\"&gt;"</span>)</span><br><span class="line">    writer.writeValue(rootObject)</span><br><span class="line">    writer.writeln(<span class="string">"&lt;/plist&gt;"</span>)</span><br><span class="line">    <span class="keyword">if</span> didOpen:</span><br><span class="line">        pathOrFile.close()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢åˆ†åˆ«ç”¨åˆ°äº† <code>PlistParser</code> å’Œ <code>PlistWriter</code> ä½œä¸ºè§£æå’Œå†™å…¥å·¥å…·ç±», æˆ‘ä»¬å®Œå…¨ç»§æ‰¿è‡ªè¿™ä¸¤ä¸ªç±»å†™ä¸€ä¸ªè‡ªå®šä¹‰ <code>Parser</code> å’Œ <code>Writer</code>, å¤„ç†æ‰ä¹‹å‰çš„ç‰¹æ®Šæƒ…å†µ.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCBReal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        self.value_raw = value</span><br><span class="line">        self.value = float(value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">float</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.value</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">raw</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.value_raw</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCBParser</span><span class="params">(plistlib.PlistParser)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_real</span><span class="params">(self)</span>:</span></span><br><span class="line">        value = self.getData()</span><br><span class="line">        self.addObject(CCBReal(value))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CCBWriter</span><span class="params">(plistlib.PlistWriter)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeValue</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(value, CCBReal):</span><br><span class="line">            self.simpleElement(<span class="string">"real"</span>, value.raw())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plistlib.PlistWriter.writeValue(self, value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeArray</span><span class="params">(self, array)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(array) &lt;= <span class="number">0</span>:</span><br><span class="line">            self.writeln(<span class="string">"&lt;array/&gt;"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plistlib.PlistWriter.writeArray(self, array)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writeDict</span><span class="params">(self, d)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(d) &lt;= <span class="number">0</span>:</span><br><span class="line">            self.writeln(<span class="string">"&lt;dict/&gt;"</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plistlib.PlistWriter.writeDict(self, d)</span><br></pre></td></tr></table></figure><p>å¯¹ç©ºçš„ <code>dict</code> å’Œ <code>array</code> å¤„ç†å¾ˆç®€å•, åˆ¤æ–­ä¸‹é•¿åº¦å°±å¯ä»¥å•¦. ä½†æ˜¯å¯¹ <code>real</code> çš„å¤„ç†å°±è´¹äº†ä¸€ç•ªå‘¨æŠ˜.</p><p>æˆ‘ä¸€å¼€å§‹æƒ³ç€ç”¨ python ä¸­çš„é«˜ç²¾åº¦ç±»å‹æ¥ä¿å­˜ real çš„å€¼, ä½†æ˜¯è¿‡ç¨‹ååˆ†æ›²æŠ˜, æ•°å€¼å®Œå…¨å¯¹ä¸ä¸Š, å„ç§ä¿®æ”¹æµ‹è¯•ä¾ç„¶ä¸è¡Œ. ç»æœ›ä¸´è¿‘æ”¾å¼ƒä¹‹é™…, çªç„¶çµå…‰ä¸€ç°, å¯ä»¥ç”¨ä¸€ä¸ªå¤æ‚çš„ç±»å‹åŒæ—¶è®°å½•ä¸‹åŸå§‹çš„å€¼ (string ç±»å‹) å’Œè½¬åŒ–ä¸º float ä¸­çš„å€¼, è¿™æ ·å¦‚æœåœ¨æ•´ä¸ªç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­æ²¡æœ‰æ”¹å˜è¿™ä¸ªå€¼çš„è¯å°±å¯ä»¥æŠŠåŸå§‹å€¼å†™å…¥è¿›å», è¿™æ ·å°±ä¸ä¼šæœ‰ä»»ä½•æ„æ–™ä¹‹å¤–çš„æ›´æ”¹äº†.</p><p>å…¨éƒ¨ä»£ç å·²ç»æ”¾åˆ°<a href="https://gist.github.com/justbilt/cc21b7c6573bac7668282faa56dfdd9b" target="_blank" rel="noopener">æˆ‘çš„ gist ä¸Š</a>äº†, æœ‰éœ€è¦å¯ä»¥è‡ªå–.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plist = readPlist(<span class="string">"/path/of/you/ccb"</span>)</span><br><span class="line"><span class="keyword">print</span> plist.guides[<span class="number">0</span>].position</span><br><span class="line"><span class="keyword">print</span> plist.guides[<span class="number">0</span>].position.float()</span><br><span class="line">plist.guides[<span class="number">0</span>].position = <span class="number">5.5</span></span><br><span class="line"><span class="keyword">print</span> plist.guides[<span class="number">0</span>].position</span><br><span class="line">writePlist(plist, ccb)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç å½“ç„¶å°‘ä¸äº†å•¦, æ„Ÿè§‰è‡ªå·±æ£’æ£’å“’, æ™šé¥­ç”³è¯·åŠ ä¸ªğŸ—. </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¹‹å‰å¯èƒ½å’Œå¤§å®¶è¯´è¿‡æˆ‘ä»¬é¡¹ç›®çš„ UI ç¼–è¾‘å™¨æ˜¯ä¸Šå¤ç¥å™¨ &lt;a href=&quot;https://github.com/cocos2d/CocosBuilder&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CocosBuilder&lt;/a&gt;, è¿™ä¸ªç¼–è¾‘å™¨çš„è¯ç”Ÿåœ¨é‚£ä¸ª
      
    
    </summary>
    
    
      <category term="Python" scheme="http://blog.justbilt.com/tags/Python/"/>
    
      <category term="CocosBuilder" scheme="http://blog.justbilt.com/tags/CocosBuilder/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä¸º Creator æ·»åŠ  js/ts ç¬¬ä¸‰æ–¹åº“æ”¯æŒ</title>
    <link href="http://blog.justbilt.com/2017/12/10/creator-add-package/"/>
    <id>http://blog.justbilt.com/2017/12/10/creator-add-package/</id>
    <published>2017-12-10T11:57:39.000Z</published>
    <updated>2017-12-10T14:02:24.397Z</updated>
    
    <content type="html"><![CDATA[<p>æ­£å¦‚çŸ¥ä¹<a href="https://www.zhihu.com/question/66819338/answer/259901965" target="_blank" rel="noopener">æˆ‘çš„è¿™ä¸ªå›ç­”</a>ä¸­æ‰€è¯´, æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ Cocos Creaor å¼€å‘æ–°çš„é¡¹ç›®, æ‰€ä»¥ä»¥åè¿™ä¸ªåšå®¢ä¼šé™†ç»­å¼€å§‹æ›´æ–°ä¸€äº› Creator ç›¸å…³çš„æ–‡ç« .</p><p>æˆ‘ä»¬åœ¨é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­, è‚¯å®šä¼šé‡åˆ°ä¸€äº›é¡¹ç›®é—´é€šç”¨çš„éœ€æ±‚, æ¯”å¦‚ <code>å‹ç¼©/åŠ å¯†</code> ä¹‹ç±»çš„, æˆ‘ä»¬å½“ç„¶å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ª, ä½†æ›´å¥½çš„åšæ³•æ˜¯æ‰¾æ‰¾ç½‘ä¸Šæœ‰æ²¡æœ‰åˆ«äººå®ç°å¥½çš„åº“ç›´æ¥æ‹¿æ¥ç”¨, ä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä¸º Creator æ·»åŠ æ·»åŠ  js/ts ç¬¬ä¸‰æ–¹åº“æ”¯æŒ.</p><a id="more"></a><h1 id="ä¸€-ä¸‹è½½æºæ–‡ä»¶"><a href="#ä¸€-ä¸‹è½½æºæ–‡ä»¶" class="headerlink" title="ä¸€. ä¸‹è½½æºæ–‡ä»¶"></a>ä¸€. ä¸‹è½½æºæ–‡ä»¶</h1><p>ä»¥ <a href="https://github.com/jakesgordon/javascript-state-machine" target="_blank" rel="noopener">javascript-state-machine</a> ä¸ºä¾‹, æˆ‘ä»¬å¯ä»¥åœ¨ <code>Clone or Download</code> ä¸­é€‰æ‹© <code>Download Zip</code> ä¸‹è½½æºæ–‡ä»¶å‹ç¼©åŒ…, è§£å‹ååœ¨å°† <code>dist/state-machine.js</code> å¤åˆ¶åˆ°æˆ‘ä»¬é¡¹ç›®ä¸­çš„ <code>assets/Script</code> ç›®å½•ä¸­.</p><p>ç„¶ååœ¨æˆ‘ä»¬çš„ä»£ç ä¸­:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> StateMachine <span class="keyword">from</span> <span class="string">"state-machine"</span>;</span><br><span class="line">cc.Class(&#123;</span><br><span class="line">    extends: cc.Component,</span><br><span class="line">    properties: &#123;</span><br><span class="line">        label: &#123;</span><br><span class="line">            <span class="keyword">default</span>: <span class="literal">null</span>,</span><br><span class="line">            type: cc.Label</span><br><span class="line">        &#125;,</span><br><span class="line">        text: <span class="string">'Hello, World!'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    onLoad: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.label.string = <span class="keyword">this</span>.text;</span><br><span class="line">        <span class="keyword">var</span> fsm = <span class="keyword">new</span> StateMachine(&#123;</span><br><span class="line">            init: <span class="string">'solid'</span>,</span><br><span class="line">            transitions: [</span><br><span class="line">              &#123; <span class="attr">name</span>: <span class="string">'melt'</span>,     <span class="attr">from</span>: <span class="string">'solid'</span>,  <span class="attr">to</span>: <span class="string">'liquid'</span> &#125;,</span><br><span class="line">              &#123; <span class="attr">name</span>: <span class="string">'freeze'</span>,   <span class="attr">from</span>: <span class="string">'liquid'</span>, <span class="attr">to</span>: <span class="string">'solid'</span>  &#125;,</span><br><span class="line">              &#123; <span class="attr">name</span>: <span class="string">'vaporize'</span>, <span class="attr">from</span>: <span class="string">'liquid'</span>, <span class="attr">to</span>: <span class="string">'gas'</span>    &#125;,</span><br><span class="line">              &#123; <span class="attr">name</span>: <span class="string">'condense'</span>, <span class="attr">from</span>: <span class="string">'gas'</span>,    <span class="attr">to</span>: <span class="string">'liquid'</span> &#125;</span><br><span class="line">            ],</span><br><span class="line">            methods: &#123;</span><br><span class="line">              onMelt:     <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I melted'</span>)    &#125;,</span><br><span class="line">              onFreeze:   <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I froze'</span>)     &#125;,</span><br><span class="line">              onVaporize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I vaporized'</span>) &#125;,</span><br><span class="line">              onCondense: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I condensed'</span>) &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        fsm.melt();       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å°ä¸­å¯ä»¥çœ‹åˆ°è¾“å‡º:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I melted</span><br></pre></td></tr></table></figure><h1 id="äºŒ-ä½¿ç”¨-npm"><a href="#äºŒ-ä½¿ç”¨-npm" class="headerlink" title="äºŒ. ä½¿ç”¨ npm"></a>äºŒ. ä½¿ç”¨ npm</h1><p>æ js çš„åŒå­¦éƒ½ä¼šçŸ¥é“ <a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a> è¿™ä¸ª js æœ€å¤§çš„è½®å­é›†ä¸­è¥, å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿çš„å¸®ä½ å®‰è£…/ç®¡ç†æ‰€éœ€çš„ç¬¬ä¸‰æ–¹ä¾èµ–åº“. å¦‚æœä½ è§‰å¾—ä¸Šé¢ä¸‹è½½ä»£ç çš„å½¢å¼å¤ªè¿‡ç¹ççš„è¯, å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ npm æ¥å®‰è£…. </p><p>npm ä¼šåœ¨ä½ å®‰è£… <a href="https://nodejs.org/zh-cn/" target="_blank" rel="noopener">nodejs</a> æ—¶è‡ªåŠ¨æ‹¥æœ‰, å¯ä»¥ä½¿ç”¨ <code>npm -v</code> å‘½ä»¤æ£€æŸ¥ npm çŠ¶æ€. ä¸‹é¢æˆ‘ä»¬è¦è§‚å¯Ÿä¸‹ä½ çš„é¡¹ç›®æœ‰æ²¡æœ‰ <code>package.json</code> è¿™ä¸ªæ–‡ä»¶, å¦‚æœæ²¡æœ‰çš„è¯æˆ‘ä»¬è¦å…ˆä½¿ç”¨:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–é¡¹ç›®, éœ€è¦å¡«ä¸€å †ä¿¡æ¯, åŸºæœ¬ä¸Šä¸€è·¯å›è½¦å°±å¯ä»¥. å®Œæˆä¹‹åæˆ‘ä»¬å¯ä»¥å» npm çš„ç½‘ç«™ä¸Šæœç´¢ä¸‹æ˜¯å¦å­˜åœ¨æˆ‘ä»¬éœ€è¦çš„åº“, ç„¶åç”¨ <code>npm instal xxx --save</code> å‘½ä»¤å®‰è£….</p><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥ <code>javascript-state-machine</code> è·ç¦», æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å®ƒåœ¨ npm ä¸Šçš„<a href="https://www.npmjs.com/package/javascript-state-machine" target="_blank" rel="noopener">è¿™ä¸ªé¡µé¢</a>, ç„¶åå®‰è£…:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install javascript-state-machine --save</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆå, æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ–°çš„é—®é¢˜, å¦‚ä½•å» require è¿™ä¸ªæ–‡ä»¶å‘¢ ? ä¹‹å‰æºç ç›´æ¥ require çš„æ–¹å¼è‚¯å®šæ˜¯ä¸è¡Œçš„äº†, æœ€ç»ˆåœ¨è®ºå›ä¸­æ‰¾åˆ°äº†<a href="http://forum.cocos.com/t/npm/37930/2?u=justbilt" target="_blank" rel="noopener">è§£å†³æ–¹æ¡ˆ</a>, æˆ‘ä»¬éœ€è¦è¿™æ ·:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> StateMachine <span class="keyword">from</span> <span class="string">"javascript-state-machine"</span>;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-åœ¨-TypeScript-ä¸­ä½¿ç”¨-npm-å®‰è£…çš„ä¸‰æ–¹åº“"><a href="#ä¸‰-åœ¨-TypeScript-ä¸­ä½¿ç”¨-npm-å®‰è£…çš„ä¸‰æ–¹åº“" class="headerlink" title="ä¸‰. åœ¨ TypeScript ä¸­ä½¿ç”¨ npm å®‰è£…çš„ä¸‰æ–¹åº“"></a>ä¸‰. åœ¨ TypeScript ä¸­ä½¿ç”¨ npm å®‰è£…çš„ä¸‰æ–¹åº“</h1><p>ä¸Šé¢è®²çš„éƒ½æ˜¯ js çš„é¡¹ç›®, é‚£ä¹ˆ ts çš„é¡¹ç›®åˆè¯¥å¦‚ä½•æå‘¢ ? æˆ‘ä»¬é™¤äº† js ä¸­çš„é‚£äº›æ“ä½œå¤–è¿˜éœ€è¦å®‰è£…ä¸€ä¸ª ts çš„æ ‡æ³¨åº“. </p><p>æˆ‘ä»¬å…ˆå» <a href="https://microsoft.github.io/TypeSearch/" target="_blank" rel="noopener">TypeSearch</a> æœç´¢ä¸‹æ˜¯å¦æœ‰æˆ‘ä»¬éœ€è¦çš„åº“çš„æ ‡æ³¨åº“:</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fmc08dgaohj30gc07zq3j.jpg" alt=""></p><p>ç‚¹å‡»åä¼šè·³è½¬çš„ npm å¯¹åº”çš„é¡µé¢, æˆ‘ä»¬è¦æ ¹æ®æç¤ºå®‰è£…è¿™ä¸ªåº“:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save @types/javascript-state-machine</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ TypeScript ä¸­ä½¿ç”¨ä¸‹é¢ä»£ç å» import :</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> StateMachine <span class="keyword">from</span> <span class="string">"javascript-state-machine"</span>;</span><br></pre></td></tr></table></figure><p>å€¼å¾—ä¸€æçš„æ˜¯, è¿™äº› @types çš„åº“å¾ˆå¤šéƒ½æ˜¯å¤§å®¶è‡ªå·±åˆ¶ä½œåè´¡çŒ®ç»™ç¤¾åŒºçš„, é›†åˆåœ¨ <a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="noopener">DefinitelyTyped</a> è¿™ä¸ªä»“åº“ä¸­, çœå»äº†æˆ‘ä¹ˆè‡ªå·±æ ‡æ³¨çš„å·¥ä½œ, æ„Ÿè°¢è¿™äº›è´¡çŒ®è€…ä»¬. </p><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜, è¿™äº›æ ‡æ³¨åº“æ›´æ–°å¯èƒ½è½åäºåŸå§‹é¡¹ç›®, å› æ­¤æˆ‘ä»¬è¦å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„åŸå§‹åº“æ‰èƒ½å¤Ÿæ­£ç¡®æç¤º, å¯¹åº”ç‰ˆæœ¬å¯ä»¥åœ¨ <code>node_modules/@types/javascript-state-machine/index.d.ts</code> æ‰¾åˆ°:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// Type definitions <span class="keyword">for</span> Finite State Machine 2.4</span><br></pre></td></tr></table></figure><p>å› æ­¤, æˆ‘ä»¬è¦å®‰è£… <code>javascript-state-machine</code> éœ€è¦æŒ‡å®šç‰ˆæœ¬:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install javascript-state-machine@2.4 --save</span><br></pre></td></tr></table></figure><hr><p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬å®‰è£…ç¬¬ä¸‰æ–¹åº“çš„ç»éªŒ, å¸Œæœ›èƒ½å¤Ÿå¸®åŠ©åˆ°å¤§å®¶. æˆ‘ä»¬ä¹Ÿæ˜¯æ‰å¼€å§‹ä½¿ç”¨ Creator, å¦‚æœé‡åˆ°é—®é¢˜, å¸Œæœ›å¯ä»¥å’Œå¤§å®¶å¤šå¤šäº¤æµ.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ­£å¦‚çŸ¥ä¹&lt;a href=&quot;https://www.zhihu.com/question/66819338/answer/259901965&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æˆ‘çš„è¿™ä¸ªå›ç­”&lt;/a&gt;ä¸­æ‰€è¯´, æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ Cocos Creaor å¼€å‘æ–°çš„é¡¹ç›®, æ‰€ä»¥ä»¥åè¿™ä¸ªåšå®¢ä¼šé™†ç»­å¼€å§‹æ›´æ–°ä¸€äº› Creator ç›¸å…³çš„æ–‡ç« .&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­, è‚¯å®šä¼šé‡åˆ°ä¸€äº›é¡¹ç›®é—´é€šç”¨çš„éœ€æ±‚, æ¯”å¦‚ &lt;code&gt;å‹ç¼©/åŠ å¯†&lt;/code&gt; ä¹‹ç±»çš„, æˆ‘ä»¬å½“ç„¶å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ª, ä½†æ›´å¥½çš„åšæ³•æ˜¯æ‰¾æ‰¾ç½‘ä¸Šæœ‰æ²¡æœ‰åˆ«äººå®ç°å¥½çš„åº“ç›´æ¥æ‹¿æ¥ç”¨, ä»Šå¤©æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•ä¸º Creator æ·»åŠ æ·»åŠ  js/ts ç¬¬ä¸‰æ–¹åº“æ”¯æŒ.&lt;/p&gt;
    
    </summary>
    
    
      <category term="CocosCreaor" scheme="http://blog.justbilt.com/tags/CocosCreaor/"/>
    
  </entry>
  
  <entry>
    <title>iOS æ‰“åŒ…å·¥å…·åœ¨ XCode9 ä¸‹çš„æ”¹åŠ¨</title>
    <link href="http://blog.justbilt.com/2017/12/02/xcode9-package-tools/"/>
    <id>http://blog.justbilt.com/2017/12/02/xcode9-package-tools/</id>
    <published>2017-12-02T05:26:04.000Z</published>
    <updated>2017-12-04T12:42:29.330Z</updated>
    
    <content type="html"><![CDATA[<p>ç›¸ä¿¡å¤§å®¶éƒ½ä¼šç”¨åˆ° iOS çš„è‡ªåŠ¨æ‰“åŒ…å·¥å…·, è€Œä¸æ˜¯æ¯æ¬¡éƒ½æ˜¯é€šè¿‡ XCode çš„ Archive åæ‰‹åŠ¨å¯¼å‡ºçš„, é‚£æ ·æ•ˆç‡ä½ä¸‹ä¸è¯´è¿˜å¢åŠ å‡ºé”™çš„å¯èƒ½.</p><p>æˆ‘ä»¬å›¢é˜Ÿä¹Ÿæ˜¯å¦‚æ­¤, ç”¨ Python æäº†ä¸€å¥—æ‰“åŒ…å·¥å…·, è¿™å¥—å·¥å…·çš„æ ¸å¿ƒæ˜¯ XCode é™„å¸¦çš„å‘½ä»¤è¡Œå·¥å…· <code>xcodebuild</code>, ç½‘ä¸Šå…¶ä»–å¼€æºçš„æ‰“åŒ…å·¥å…·ä¹Ÿéƒ½å¤§åŒå°å¼‚. è¿™å¥—å·¥å…·è‡ªè¯ç”Ÿä»¥æ¥ä¸€ç›´è¿è¡Œçš„å¾ˆç¨³å®š, ç´¯è®¡ä¸ºæˆ‘ä»¬æ‰“äº†æ•°ç™¾ä¸ªåŒ…, ä¸ºå›¢é˜ŸèŠ‚çœçš„æ—¶é—´ä¼°è®¡ä¹Ÿåœ¨æ•°åƒåˆ†é’Ÿäº†.</p><a id="more"></a><h1 id="ä¸€-æ— æ³•å¯¼å‡º-ipa"><a href="#ä¸€-æ— æ³•å¯¼å‡º-ipa" class="headerlink" title="ä¸€. æ— æ³•å¯¼å‡º ipa"></a>ä¸€. æ— æ³•å¯¼å‡º ipa</h1><p>ä½†æ˜¯åœ¨æ›´æ–° XCode9 ä¹‹å, å·¥å…·æŒ‚æ‰äº†, åœ¨å¯¼å‡ºåŒ…çš„æ—¶å€™ä¼šæç¤º:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error: exportArchive: <span class="string">"wobwopr.app"</span> requires a provisioning profile with the Push Notifications feature.</span><br><span class="line">Error Domain=IDEProvisioningErrorDomain Code=9 <span class="string">""</span>wobwopr.app<span class="string">" requires a provisioning profile with the Push Notifications feature."</span> UserInfo=&#123;NSLocalizedDescription=<span class="string">"wobwopr.app"</span> requires a provisioning profile with the Push Notifications feature., NSLocalizedRecoverySuggestion=Add a profile to the <span class="string">"provisioningProfiles"</span> dictionary <span class="keyword">in</span> your Export Options property list.&#125;</span><br></pre></td></tr></table></figure><p>ç®€å• Google äº†ä¸‹, ä¹Ÿæœ‰å…¶ä»–æ‰“åŒ…å·¥å…·ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„é”™è¯¯:</p><p><a href="https://github.com/fastlane/fastlane/issues/9589" target="_blank" rel="noopener">fastlane: https://github.com/fastlane/fastlane/issues/9589</a></p><p>è¿˜æœ‰è¿™äº›æ–‡ç« :</p><p><a href="https://blog.bitrise.io/new-export-options-plist-in-xcode-9" target="_blank" rel="noopener">New export options Plist in Xcode 9</a><br><a href="https://htge.github.io/osx/ios/2017/09/21/xcode9-export-ipa/" target="_blank" rel="noopener">Xcode9å‘½ä»¤è¡Œæ–°æ‰“åŒ…æ–¹æ³•</a></p><p>æ€»ç»“äº†ä¸‹, é”™è¯¯çš„åŸå› æ˜¯è¿™ä¸ªæ ·å­çš„, é€šè¿‡ <code>xcodebuild</code> å¯¼å‡º ipa åŒ…æ—¶éœ€è¦ä¼ å…¥å‚æ•° <code>exportOptionsPlist</code> æŒ‡å®šå¯¼å‡ºé…ç½®, XCode9 ä¹‹å‰è¿™ä¸ªæœ€ç®€å•çš„é…ç½®æ˜¯è¿™ä¸ªæ ·å­çš„:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>method<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>&#123;method&#125;<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>method å¯é€‰çš„å€¼æœ‰: </p><ul><li>app-store</li><li>ad-hoc</li><li>package</li><li>enterprise</li><li>development</li><li>developer-id</li><li>mac-application</li></ul><p>è€Œ XCode9 ä¹‹åæœ€å°åŒ–çš„é…ç½®å˜æˆäº†:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>method<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>&#123;method&#125;<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>provisioningProfiles<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>&#123;bundleid&#125;<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>&#123;provision&#125;<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–°å¢äº† <code>provisioningProfiles</code> å­—æ®µ, å®ƒæ˜¯ä¸€ä¸ªç”± <code>åŒ…å:é…ç½®æ–‡ä»¶åå­—æˆ–udid</code> ç»„æˆçš„å­—å…¸. é‚£ä¹ˆæˆ‘ä»¬æ”¹å¦‚ä½•è·å–è¿™äº›å‚æ•°å‘¢ ?</p><h2 id="1-ä½¿ç”¨-XCode-å¯¼å‡ºåä¿å­˜"><a href="#1-ä½¿ç”¨-XCode-å¯¼å‡ºåä¿å­˜" class="headerlink" title="1. ä½¿ç”¨ XCode å¯¼å‡ºåä¿å­˜"></a>1. ä½¿ç”¨ XCode å¯¼å‡ºåä¿å­˜</h2><p>è¿™ä¸ªæ˜¯ç›®å‰ç½‘ä¸Šæä¾›çš„æœ€å¤šçš„è§£å†³æ–¹æ¡ˆ, å…·ä½“æ­¥éª¤å¦‚ä¸‹:</p><ol><li>ä½¿ç”¨ XCode æ‰“å¼€ä½ çš„é¡¹ç›®, <code>Projuct/Archive</code> å½’æ¡£å·¥ç¨‹. æˆ–è€…ç›´æ¥ç”¨ XCode æ‰“å¼€ä½ çš„ <code>xcarchive</code> æ–‡ä»¶.</li><li>ç‚¹å‡» <code>Export</code> é€‰æ‹© <code>App Store/Development</code> åä¸‹ä¸€æ­¥, é€‰æ‹©è¯ä¹¦å’Œé…ç½®æ–‡ä»¶åå¯¼å‡º.</li><li>åœ¨å¯¼å‡ºæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ° <code>ExportOptions.plist</code>, è¿™ä¸ªé‡Œé¢çš„æœ‰ä½ æƒ³è¦çš„å‚æ•°.</li></ol><p>è¿™ä¸ªæ–¹æ³•ç›¸å¯¹ç®€å•, å´ä¸æ˜¯å®Œç¾çš„è§£å†³æ–¹æ¡ˆ, å®ƒå­˜åœ¨è¿™ä¹ˆä¸¤ä¸ªç¼ºç‚¹:</p><ol><li>æ²¡æ³•è‡ªåŠ¨æ¥åšè¿™ä»¶äº‹æƒ…, æµ‹è¯•/å‘å¸ƒå¾—æä¸¤æ¬¡, æ¯ä¸ªæ–°çš„é¡¹ç›®éƒ½è¦åšä¸€é.</li><li>é¡¹ç›®è¯ä¹¦å‘ç”Ÿå˜åŒ–ååˆå¾—é‡æ–°æ¥ä¸€é.</li></ol><p>æƒ³åˆ°ä»¥åæ¯ä¸ªé¡¹ç›®éƒ½è¦æ‰‹åŠ¨æ¥æ, é‚£æ‰“åŒ…å·¥å…·çš„æ„ä¹‰æœ‰ä½•åœ¨å‘¢ ?</p><h2 id="2-ä»-xcodeproj-ä¸­è¯»å–"><a href="#2-ä»-xcodeproj-ä¸­è¯»å–" class="headerlink" title="2. ä» xcodeproj ä¸­è¯»å–"></a>2. ä» xcodeproj ä¸­è¯»å–</h2><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fm3foq44n2j30jh0a2my7.jpg" alt=""></p><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»åœ¨ XCode ä¸­é…ç½®è¿‡äº†è¿™äº›å‚æ•°, é‚£æˆ‘ä»¬èƒ½å¦ä» XCode å·¥ç¨‹æ–‡ä»¶ä¸­è¯»å–åˆ°è¿™å†™å‚æ•°å‘¢ ? è®©æˆ‘ä»¬å…ˆæ‰“å¼€ä¸€ä¸ªå·¥ç¨‹å¯»æ‰¾ä¸€ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRODUCT_BUNDLE_IDENTIFIER = com.xxx.xxx;</span><br><span class="line">PROVISIONING_PROFILE = &quot;74c78746-9aa9-4a37-9533-a991f42b7f58&quot;;</span><br><span class="line">PROVISIONING_PROFILE_SPECIFIER = &quot;xxx-dev&quot;;</span><br></pre></td></tr></table></figure><p>å“ˆå“ˆ, ä¸è´¹å¹ç°ä¹‹åŠ›ä¾¿æ‰¾åˆ°äº†. ä¸‹ä¸€æ­¥å°±æ˜¯å¦‚ä½•åœ¨ä»£ç ä¸­è¯»å–è¿™äº›å‚æ•°äº†? æˆ‘ä»¬çš„æ‰“åŒ…è„šæœ¬æ˜¯ä½¿ç”¨ python å†™çš„, å› æ­¤æˆ‘é€‰æ‹© <a href="https://github.com/kronenthaler/mod-pbxproj" target="_blank" rel="noopener">pbxproj</a> è¿™ä¸ªåº“æ¥è§£æ pbxproj æ–‡ä»¶:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pbxproj <span class="keyword">import</span> XcodeProject</span><br><span class="line">project = XcodeProject.load(<span class="string">"path/of/your/pbxproj"</span>)</span><br><span class="line"><span class="keyword">for</span> configuration <span class="keyword">in</span> project.objects.get_configurations_on_targets(<span class="string">"&#123;target&#125;"</span>, <span class="string">"&#123;configuration&#125;"</span>):</span><br><span class="line">    bundleid = configuration.buildSettings.PRODUCT_BUNDLE_IDENTIFIER</span><br><span class="line">    specifier = configuration.buildSettings.PROVISIONING_PROFILE_SPECIFIER</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>target</code> æ˜¯ XCode ä¸­ target åˆ—è¡¨ä¸­çš„åå­—, <code>configuration</code> å€¼å¯é€‰ <code>Debug/Release</code> . æˆ‘ä»¬å¾ˆè½»æ˜“çš„ä¾¿è·å–åˆ°äº†åŒ…åå’Œé…ç½®æ–‡ä»¶çš„åå­—, å¯¹æ‰“åŒ…è„šæœ¬ç¨ä½œä¿®æ”¹ä¾¿å¯¼å‡ºæˆåŠŸäº†.</p><p>åœ¨ä½¿ç”¨ <code>pbxproj</code> åº“çš„è¿‡ç¨‹ä¸­æˆ‘è¿˜é‡åˆ°äº†ä¸€ä¸ªå°é—®é¢˜, åœ¨ç»™ä½œè€…<a href="https://github.com/kronenthaler/mod-pbxproj/issues/185" target="_blank" rel="noopener">æå‡º Issue </a>åå¾ˆå¿«ä¾¿æ”¶åˆ°äº†è§£å†³æ–¹æ¡ˆ, åŸæ¥æ˜¯æˆ‘çš„æµ‹è¯•æ–‡ä»¶ <code>test.py</code> è§¦å‘äº†ä¸€ä¸ª py3 å…¼å®¹åº“çš„ bug. </p><h1 id="äºŒ-XCode9-ä¸å†ç”Ÿæˆ-xcscheme-æ–‡ä»¶"><a href="#äºŒ-XCode9-ä¸å†ç”Ÿæˆ-xcscheme-æ–‡ä»¶" class="headerlink" title="äºŒ. XCode9 ä¸å†ç”Ÿæˆ .xcscheme æ–‡ä»¶"></a>äºŒ. XCode9 ä¸å†ç”Ÿæˆ .xcscheme æ–‡ä»¶</h1><p>ä½¿ç”¨ <code>xcodebuild</code> ç”Ÿæˆ xcarchive æ–‡ä»¶æ—¶éœ€è¦æŒ‡å®š <code>-scheme</code> å‚æ•°, è€Œä¸æ˜¯ <code>-target</code>, ä¸ç„¶ä¼šæç¤º:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild: error: The flag -scheme is required when specifying -archivePath but not -exportArchive.</span><br></pre></td></tr></table></figure><p><code>scheme</code> å’Œ <code>target</code> ä»åå­—ä¸Šæœ‰ä¸€å®šçš„è”ç³», ç¬¬ä¸€æ¬¡æ‰“å¼€ä¸€ä¸ª XCode å·¥ç¨‹æ—¶, ä¼šåœ¨ <code>.xcodeproj</code> æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆå¤šä¸ªå’Œ target ä¸€ä¸€å¯¹åº”çš„ <code>xcscheme</code> æ–‡ä»¶:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcuserdata/*.xcuserdatad/xcschemes/xxx.xcscheme</span><br></pre></td></tr></table></figure><p>åœ¨ XCode9 å‰å¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶æ˜¯æ— æ³•ç”Ÿæˆ <code>xcarchive</code> æ–‡ä»¶çš„, ä¸ºäº†èƒ½å¤Ÿåšåˆ°æŒç»­é›†æˆ, æˆ‘ä»¬çš„åšæ³•æ˜¯: </p><blockquote><p>å¦‚æœæ£€æµ‹åˆ°è¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨çš„è¯, å°±ç”¨ <code>open xxx.xcodeproj</code> å‘½ä»¤æ‰“å¼€è¿™ä¸ªå·¥ç¨‹, è¿™æ ·å°±ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶äº†</p></blockquote><p>è€Œåœ¨ XCode9 ä¸­, å·²ç»ä¸å†ç”Ÿæˆ <code>xcscheme</code> æ–‡ä»¶äº†, å–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ª <code>xcschememanagement.plist</code> æ–‡ä»¶äº†. <strong>è€Œä¸”é‡è¦çš„æ˜¯å³æ—¶è¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨, ä¹Ÿæ˜¯èƒ½å¤Ÿæ­£å¸¸ç”Ÿæˆ xcarchive æ–‡ä»¶çš„</strong>.</p><p>é‚£ä¹ˆåœ¨ XCode9 ä¸­æˆ‘ä»¬ä¹‹å‰æ£€æµ‹ xcscheme æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶ç”Ÿæˆçš„é€»è¾‘å°±ä¸éœ€è¦äº†, æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ XCode ç‰ˆæœ¬å°±è¡Œå•¦.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> distutils.version <span class="keyword">import</span> LooseVersion</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_xcode9</span><span class="params">()</span>:</span></span><br><span class="line">    out, err = subprocess.Popen(<span class="string">"xcodebuild -version"</span>, shell=<span class="keyword">True</span>, stdout=subprocess.PIPE).communicate()</span><br><span class="line">    verison = out.strip().replace(<span class="string">"\n"</span>, <span class="string">" "</span>).split(<span class="string">" "</span>)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> LooseVersion(verison) &gt;= LooseVersion(<span class="string">"9.0.0"</span>)</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-allowProvisioningUpdates-è‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶"><a href="#ä¸‰-allowProvisioningUpdates-è‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸‰. allowProvisioningUpdates è‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶"></a>ä¸‰. allowProvisioningUpdates è‡ªåŠ¨æ›´æ–°é…ç½®æ–‡ä»¶</h1><p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒçš„æè¿°:</p><blockquote><p>Allow xcodebuild to communicate with the Apple Developer website. For automatically signed targets, xcodebuild will create and update profiles, app IDs, and certificates. For manually signed targets, xcodebuild will download missing or updated provisioning profiles. Requires a developer account to have been added in Xcodeâ€™s Accounts preference pane.</p></blockquote><p>XCode ç®¡ç†è¯ä¹¦å’Œé…ç½®æ–‡ä»¶æœ‰ä¸¤ä¸­æ–¹å¼: <code>automatically</code> å’Œ <code>manually</code>, å¦‚è¿‡åœ¨ XCode ä¸­å‹¾é€‰äº† <code>Automatically manager signing</code> çš„è¯, å½’æ¡£å‡ºæ¥çš„åŒ…å°±æ˜¯ automatically çš„, åä¹‹åˆ™æ˜¯ manually çš„.</p><p>åªæœ‰ automatically ç±»å‹çš„é…ç½®æŒ‡å®š <code>allowProvisioningUpdates</code> æ‰æœ‰ç”¨. è¿™ä¸ªå‚æ•°åœ¨å½’æ¡£å’Œå¯¼å‡ºé˜¶æ®µéƒ½å¯ä»¥ç”¨åˆ°, å‰ææ˜¯ä½ å¾—åœ¨ XCode çš„è´¦å·è®¾ç½®ä¸­ç™»å½•å¼€å‘è€…è´¦å·.</p><p>åœ¨å½’æ¡£é˜¶æ®µ, æ¯”è¾ƒå¯èƒ½æ˜¯ç¼ºå°‘ <code>Development</code> è¯ä¹¦, å¦‚æœæ²¡æœ‰è¿™ä¸ªå‚æ•°, ä½ ä¼šæ”¶åˆ°è¿™ä¸ªé”™è¯¯:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Code Signing Error: No signing certificate &quot;iOS Development&quot; found:  No &quot;iOS Development&quot; signing certificate matching team ID &quot;G76Y748JJ2&quot; with a private key was found.</span><br><span class="line">Code Signing Error: Code signing is required for product type &apos;Application&apos; in SDK &apos;iOS 11.1&apos;</span><br><span class="line">** ARCHIVE FAILED **</span><br></pre></td></tr></table></figure><p>è€ŒæŒ‡å®šå, ç†æƒ³æƒ…å†µä¸‹æ˜¯ä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºæˆ–ä¸‹è½½è¯ä¹¦, <strong>ä½†ç°åœ¨å¯èƒ½ä¸å¤Ÿå®Œå–„, æ²¡èƒ½åšåˆ°è¿™ç‚¹</strong>, ç°åœ¨ä¼šé‡åˆ°å¦‚ä¸‹é”™è¯¯:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2017-12-03 16:08:22.837 xcodebuild[20785:1078389]  DVTAssertions: Warning <span class="keyword">in</span> /Library/Caches/com.apple.xbs/Sources/IDEFrameworks/IDEFrameworks-13532/IDEFoundation/Provisioning/Logging/IDEProvisioningLedger.m:167</span><br><span class="line">Details:  Unable to close provisioning ledger entry because not all of its subentries are closed</span><br><span class="line">Object:   &lt;IDEProvisioningLedgerEntry: 0x7fa9540a4a90&gt;</span><br><span class="line">Method:   -closeWithError:</span><br><span class="line">Thread:   &lt;NSThread: 0x7fa9540b8740&gt;&#123;number = 15, name = (null)&#125;</span><br><span class="line">Please file a bug at http://bugreport.apple.com with this warning message and any useful information you can provide.</span><br><span class="line">=== BUILD TARGET wobwopr OF PROJECT newship_wobwopr WITH CONFIGURATION Release ===</span><br><span class="line">Code Signing Error: Revoke certificate:  Your account already has a signing certificate <span class="keyword">for</span> this machine but it is not present <span class="keyword">in</span> your keychain. To create a new one, you must first revoke the existing certificate.</span><br><span class="line">Code Signing Error: No signing certificate <span class="string">"iOS Development"</span> found:  No <span class="string">"iOS Development"</span> signing certificate matching team ID <span class="string">"G76Y748JJ2"</span> with a private key was found.</span><br><span class="line">Code Signing Error: Code signing is required <span class="keyword">for</span> product <span class="built_in">type</span> <span class="string">'Application'</span> <span class="keyword">in</span> SDK <span class="string">'iOS 11.1'</span></span><br><span class="line">** ARCHIVE FAILED **</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯åœ¨å¯¼å‡ºé˜¶æ®µ, ç­¾åé˜¶æ®µçš„, æœ€æœ‰å¯èƒ½çš„æ˜¯ç¼ºå°‘ <code>Distribution</code> é…ç½®æ–‡ä»¶, ä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªæ–‡ä»¶æ˜¯éœ€è¦æ‰‹åŠ¨åœ¨å¼€å‘è€…åå°åˆ›å»ºå¹¶ä¸‹è½½çš„. ä½†æ˜¯å¦‚æœæŒ‡å®šäº†è¿™ä¸ªå‚æ•°çš„è¯ xcodebuild ä¼šå¸®ä½ è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª, å¾ˆç¥å¥‡çš„æ˜¯è¿™ä¸ª Profile åœ¨å¼€å‘è€…åå°æ˜¯çœ‹ä¸åˆ°çš„, ä¹Ÿä¸ä¼šå½±å“åˆ°ä½ ä¹‹å‰æ‰‹åŠ¨åˆ›å»ºçš„é…ç½®æ–‡ä»¶.</p><p>æ€»ä¹‹, è¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§, æœŸå¾…è‹¹æœç»§ç»­å®Œå–„å®ƒ.</p><hr><p>ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ç›®å‰ä¸ºæ­¢é‡åˆ°çš„ XCode9 çš„ xcodebuild é—®é¢˜, å¦‚æœå¤§å®¶ä¹Ÿé‡åˆ°äº†å…¶ä»–çš„é—®é¢˜, æ¬¢è¿ä¸€èµ·è®¨è®º.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç›¸ä¿¡å¤§å®¶éƒ½ä¼šç”¨åˆ° iOS çš„è‡ªåŠ¨æ‰“åŒ…å·¥å…·, è€Œä¸æ˜¯æ¯æ¬¡éƒ½æ˜¯é€šè¿‡ XCode çš„ Archive åæ‰‹åŠ¨å¯¼å‡ºçš„, é‚£æ ·æ•ˆç‡ä½ä¸‹ä¸è¯´è¿˜å¢åŠ å‡ºé”™çš„å¯èƒ½.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿä¹Ÿæ˜¯å¦‚æ­¤, ç”¨ Python æäº†ä¸€å¥—æ‰“åŒ…å·¥å…·, è¿™å¥—å·¥å…·çš„æ ¸å¿ƒæ˜¯ XCode é™„å¸¦çš„å‘½ä»¤è¡Œå·¥å…· &lt;code&gt;xcodebuild&lt;/code&gt;, ç½‘ä¸Šå…¶ä»–å¼€æºçš„æ‰“åŒ…å·¥å…·ä¹Ÿéƒ½å¤§åŒå°å¼‚. è¿™å¥—å·¥å…·è‡ªè¯ç”Ÿä»¥æ¥ä¸€ç›´è¿è¡Œçš„å¾ˆç¨³å®š, ç´¯è®¡ä¸ºæˆ‘ä»¬æ‰“äº†æ•°ç™¾ä¸ªåŒ…, ä¸ºå›¢é˜ŸèŠ‚çœçš„æ—¶é—´ä¼°è®¡ä¹Ÿåœ¨æ•°åƒåˆ†é’Ÿäº†.&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>æ›´æ–° spine çš„ cocos2d-x runtimes (äºŒ)</title>
    <link href="http://blog.justbilt.com/2017/11/19/upgrad-spine-runtime-2/"/>
    <id>http://blog.justbilt.com/2017/11/19/upgrad-spine-runtime-2/</id>
    <published>2017-11-19T08:10:54.000Z</published>
    <updated>2017-12-04T12:42:29.330Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´ä¸€ä¸ªæœ‹å‹å‘æˆ‘å’¨è¯¢æ’­æ”¾ spine åŠ¨ç”»æ—¶é‡åˆ°çš„é—®é¢˜:</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79ly1flngumf7luj30ht04mq41.jpg" alt=""></p><p>è¿™ä¸ªé—®é¢˜æˆ‘ä»¬åœ¨å¾ˆä¹…ä¹‹å‰ä¹Ÿé‡åˆ°è¿‡, å½“æ—¶æ˜¯å¦ä¸ªä¸€å°ä¼™ä¼´è´Ÿè´£çš„. å½“æ—¶çŒœæµ‹å¯èƒ½æ˜¯ <code>spine runtimes</code> éœ€è¦å‡çº§, ä½†æ˜¯å‡çº§æ—¶é‡åˆ°äº†æŠ€æœ¯é—®é¢˜, æ°å¥½é¡¹ç›®æ¯”è¾ƒç´§, ä¾¿è®©ç¾æœ¯åŒå­¦é‡æ–°ç”¨è€ç‰ˆçš„ Spine ç¼–è¾‘å™¨é‡æ–°åšäº†ä¸€é.</p><a id="more"></a><p>æ— ç‹¬æœ‰å¶, ä¸Šå‘¨å¦ä¸€ä¸ªå°ä¼™ä¼´åœ¨æ’­æ”¾ spine åŠ¨ç”»æ—¶é‡åˆ°äº† <code>å´©æºƒ</code> çš„é—®é¢˜, è€Œæ”¾åˆ° creator ä¸­æµ‹è¯•æ˜¯æ²¡æœ‰é—®é¢˜çš„, çœ‹æ¥åˆæ˜¯è¿è¡Œåº“å¤ªè¿‡é™ˆæ—§çš„åŸå› .</p><p>è¶ç€å‘¨æœ«æœ‰ç‚¹æ—¶é—´, æˆ‘ä¹Ÿæ¥å°è¯•æ›´æ–°ä¸‹ <code>spine runtimes</code>. 15 å¹´çš„æ—¶å€™å°±æ›´æ–°è¿‡ä¸€æ¬¡, å½“æ—¶è¿˜å†™äº†ä¸€ç¯‡å¾ˆæ°´çš„æ–‡ç«  <a href="/2015/08/16/upgrad-spine-runtime/">&lt;&lt;æ›´æ–° spine çš„ cocos2d-x runtimes&gt;&gt;</a>, æ—¶éš”ä¸¤å¹´, è¿™æ¬¡æ˜¯å¦ä¹Ÿä¼šä¾ç„¶é¡ºåˆ©å‘¢ ?</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1flnh9m7zekj307w04x746.jpg" alt=""></p><p>æˆ‘è¿™æ¬¡å¹¶æ²¡æœ‰é€‰æ‹©ä» spine çš„<a href="https://github.com/EsotericSoftware/spine-runtimes" target="_blank" rel="noopener">å®˜æ–¹ä»“åº“</a> æ›´æ–° runtimes, æ—¢ç„¶ creator ä¸­æ˜¯æ²¡æœ‰é—®é¢˜çš„, ä¸ºä»€ä¹ˆä¸é€‰æ‹©ç›´æ¥ä» creator é™„å¸¦çš„ <a href="https://github.com/cocos-creator/cocos2d-x-lite/subscription" target="_blank" rel="noopener">cocos2d-lite</a> ä¸­å¤åˆ¶è¿‡æ¥å‘¢ ?</p><h2 id="1-æ›¿æ¢æœ€æ–°çš„-spine-runtimes"><a href="#1-æ›¿æ¢æœ€æ–°çš„-spine-runtimes" class="headerlink" title="1. æ›¿æ¢æœ€æ–°çš„ spine runtimes"></a>1. æ›¿æ¢æœ€æ–°çš„ spine runtimes</h2><p>ç®€å•æµè§ˆäº†ä¸‹, ç›®å½•ç»“æ„æ²¡æœ‰å‘ç”Ÿå˜åŒ–, çœ‹æ¥æ˜¯ä¸€ä¸ªå¥½çš„å¼€ç«¯. æˆ‘ä»¬å…ˆä»ç”¨ cocos2d-lite ä¸­çš„ <code>cocos/editor-support/spine</code> æ›¿æ¢æ‰ quick-cocos2d-x ä¸­çš„åŒåç›®å½•.</p><p>ç”¨ XCode æ‰“å¼€ <code>quick/player/proj.mac/player3.xcodeproj</code> æ¨¡æ‹Ÿå™¨å·¥ç¨‹, æˆ‘ä»¬ç”¨ quick-cocos2d-x çš„ Mac ç‰ˆæ¥å®Œæˆåç»­çš„å·¥ä½œ. åœ¨ <code>Project Navigator</code> æ‰¾åˆ° <code>spine</code> æ–‡ä»¶å¤¹, åˆ é™¤æ‰çº¢è‰²çš„ç¼ºå¤±æ–‡ä»¶, å³é”® <code>Add files to &#39;cocos2d_libs.xcodepro&#39;</code> æ·»åŠ ä¸Šæ–°å¢çš„æ–‡ä»¶, ç¼–è¯‘ä¸€ä¸‹.</p><h2 id="2-ä¿®å¤-lua-binding-é”™è¯¯"><a href="#2-ä¿®å¤-lua-binding-é”™è¯¯" class="headerlink" title="2. ä¿®å¤ lua binding é”™è¯¯"></a>2. ä¿®å¤ lua binding é”™è¯¯</h2><p>å‘ç°æœ‰ <code>lua_cocos2dx_spine_auto.cpp</code> æœ‰æŠ¥é”™, é”™è¯¯å†…å®¹:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...lua_cocos2dx_spine_auto.cpp:701:32: No viable conversion from 'function&lt;void (int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:758:43: No viable conversion from 'function&lt;void (int, spEvent *)&gt;' to 'const function&lt;void (spTrackEntry *, spEvent *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:815:46: No viable conversion from 'function&lt;void (int, int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:872:43: No viable conversion from 'function&lt;void (int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:925:35: No viable conversion from 'function&lt;void (int, int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:982:41: No viable conversion from 'function&lt;void (int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:1035:32: No viable conversion from 'function&lt;void (int, spEvent *)&gt;' to 'const function&lt;void (spTrackEntry *, spEvent *)&gt;'</span><br><span class="line">...lua_cocos2dx_spine_auto.cpp:1143:30: No viable conversion from 'function&lt;void (int)&gt;' to 'const function&lt;void (spTrackEntry *)&gt;'</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶åå°±åº”è¯¥è”æƒ³åˆ°æ²¡æœ‰é‡æ–°ç”Ÿæˆ lua ç»‘å®šçš„ä»£ç . æ‰“å¼€ç»ˆç«¯è¿›å…¥ <code>tools/tolua</code>, è¿è¡Œ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python genbindings.py</span><br></pre></td></tr></table></figure><p>å¦‚æœä¹‹å‰æ²¡æœ‰è¿è¡Œè¿‡è¿™ä¸ªè„šæœ¬çš„è¯, å¯ä»¥<a href="https://github.com/dualface/v3quick/blob/v3/tools/tolua/README.mdown" target="_blank" rel="noopener">å‚ç…§è¿™ä»½å®˜æ–¹æ–‡æ¡£</a>éœ€è¦æ­å»ºç¯å¢ƒ. ç­‰å¾…è¿è¡Œç»“æŸå, å†æ¬¡ç¼–è¯‘.</p><h2 id="3-ä¿®å¤-API-å˜åŠ¨å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯"><a href="#3-ä¿®å¤-API-å˜åŠ¨å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯" class="headerlink" title="3. ä¿®å¤ API å˜åŠ¨å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯"></a>3. ä¿®å¤ API å˜åŠ¨å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯</h2><h3 id="1-Listener-å›è°ƒå‡½æ•°å‚æ•°å˜åŒ–"><a href="#1-Listener-å›è°ƒå‡½æ•°å‚æ•°å˜åŒ–" class="headerlink" title="1. *Listener å›è°ƒå‡½æ•°å‚æ•°å˜åŒ–"></a>1. *Listener å›è°ƒå‡½æ•°å‚æ•°å˜åŒ–</h3><p>è¿™æ¬¡æ”¹ä¸º <code>lua_cocos2dx_spine_manual.cpp</code> å‡ºé”™äº†:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...lua_cocos2dx_spine_manual.cpp:233:48: No viable conversion from '(lambda at ...lua_cocos2dx_spine_manual.cpp:233:48)' to 'const StartListener' (aka 'const function&lt;void (spTrackEntry *)&gt;')</span><br><span class="line">...lua_cocos2dx_spine_manual.cpp:241:46: No viable conversion from '(lambda at ...lua_cocos2dx_spine_manual.cpp:241:46)' to 'const EndListener' (aka 'const function&lt;void (spTrackEntry *)&gt;')</span><br><span class="line">...lua_cocos2dx_spine_manual.cpp:249:51: No viable conversion from '(lambda at ...lua_cocos2dx_spine_manual.cpp:249:51)' to 'const CompleteListener' (aka 'const function&lt;void (spTrackEntry *)&gt;')</span><br><span class="line">...lua_cocos2dx_spine_manual.cpp:257:48: No viable conversion from '(lambda at ...lua_cocos2dx_spine_manual.cpp:257:48)' to 'const EventListener' (aka 'const function&lt;void (spTrackEntry *, spEvent *)&gt;')</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶ä¸­æ”¾çš„æ˜¯æ‰‹åŠ¨å¯¼å‡º lua æ¥å£çš„ä»£ç , æˆ‘ä»¬éœ€è¦æ¨æµ‹ä¸€ä¸‹è¿™äº›é”™è¯¯å‘ç”Ÿçš„åŸå› . è®©æˆ‘ä»¬çœ‹ä¸‹å‡ºé”™çš„å…·ä½“ä»£ç :</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self-&gt;setStartListener([=](<span class="keyword">int</span> trackIndex)&#123;</span><br><span class="line">    executeSpineEvent(self, handler, eventType, trackIndex);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>StartListener</code> æ˜¯å£°æ˜åœ¨ <code>SkeletonAnimation.h</code> ä¸­çš„, ç›¸å…³ä»£ç çš„ git diff å¦‚ä¸‹:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span> trackIndex)&gt; StartListener;</span><br><span class="line">-<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span> trackIndex)&gt; EndListener;</span><br><span class="line">-<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span> trackIndex, <span class="keyword">int</span> loopCount)&gt; CompleteListener;</span><br><span class="line">-<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span> trackIndex, spEvent* event)&gt; EventListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry)&gt; StartListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry)&gt; InterruptListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry)&gt; EndListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry)&gt; DisposeListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry)&gt; CompleteListener;</span><br><span class="line">+<span class="keyword">typedef</span> <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(spTrackEntry* entry, spEvent* event)&gt; EventListener;</span><br></pre></td></tr></table></figure><p>æ˜¾è€Œæ˜“è§, å‡½æ•°çš„å‚æ•°å‘ç”Ÿäº†å˜åŒ–, æˆ‘ä»¬ä¿®æ”¹ä¸‹ lambda å‡½æ•°å‚æ•°å³å¯, åŒæ—¶è¿˜éœ€è¦è€ƒè™‘ <code>executeSpineEvent</code> å‡½æ•°çš„å˜åŒ–. æˆ‘çš„ä¿®æ”¹å¦‚ä¸‹:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">executeSpineEvent</span><span class="params">(LuaSkeletonAnimation* skeletonAnimation, <span class="keyword">int</span> handler, spEventType eventType,  spTrackEntry * entry, <span class="keyword">int</span> loopCount = <span class="number">0</span>, spEvent* event = <span class="literal">nullptr</span> )</span></span></span><br></pre></td></tr></table></figure><p>æ”¹å˜äº†è¿™ä¸ªå‡½æ•°çš„å‚æ•°, è°ƒç”¨çš„åœ°æ–¹ä¹Ÿè¦æ”¹å˜, è¿™ä¸ªå°±ä¸è´´ä»£ç äº†.</p><h3 id="spEventType-å˜åŒ–"><a href="#spEventType-å˜åŒ–" class="headerlink" title="spEventType å˜åŒ–"></a>spEventType å˜åŒ–</h3><p>è¿˜éœ€è¦æ³¨æ„åˆ°çš„ä¸€ä¸ªå˜åŒ–æ˜¯:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;</span><br><span class="line">    SP_ANIMATION_START, SP_ANIMATION_INTERRUPT, SP_ANIMATION_END, SP_ANIMATION_COMPLETE, SP_ANIMATION_DISPOSE, SP_ANIMATION_EVENT</span><br><span class="line">&#125; spEventType;</span><br></pre></td></tr></table></figure></p><p>æƒ³å¿…ä¹‹å‰å¤šäº† <code>SP_ANIMATION_INTERRUPT</code> å’Œ <code>SP_ANIMATION_DISPOSE</code> äº‹ä»¶, æˆ‘ä»¬è¦æ›´æ–°æ‰€æœ‰ç”¨åˆ° <code>spEventType</code> çš„åœ°æ–¹.</p><p>SpineConstants.lua :</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sp.EventType =</span><br><span class="line">&#123;</span><br><span class="line">    ANIMATION_START = <span class="number">0</span>, </span><br><span class="line">    ANIMATION_INTERRUPT = <span class="number">1</span>, </span><br><span class="line">    ANIMATION_END = <span class="number">2</span>, </span><br><span class="line">    ANIMATION_COMPLETE = <span class="number">3</span>, </span><br><span class="line">    ANIMATION_DISPOSE = <span class="number">4</span>, </span><br><span class="line">    ANIMATION_EVENT = <span class="number">5</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥åŠ <code>LuaScriptHandlerMgr.h</code> å’Œ <code>lua_cocos2dx_spine_manual.cpp</code> ä¸­å…±è®¡äº”å¤„å˜åŒ–.</p><h3 id="TrianglesCommand-å‚æ•°é”™è¯¯"><a href="#TrianglesCommand-å‚æ•°é”™è¯¯" class="headerlink" title="TrianglesCommand å‚æ•°é”™è¯¯"></a>TrianglesCommand å‚æ•°é”™è¯¯</h3><p>è§£å†³äº†è¿™ä¸ªé—®é¢˜, ç¼–è¯‘åå‘ç°è¿˜æœ‰ä¸€ä¸ªé”™è¯¯:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SkeletonBatch.cpp:95:37: No matching member function for call to 'init'</span><br></pre></td></tr></table></figure><p>æ˜¯è°ƒç”¨ <code>TrianglesCommand:init</code> æ—¶å¤šä¼ å…¥äº†ä¸€ä¸ªå‚æ•°, å¯èƒ½æ˜¯æ–°ç‰ˆ cocos çš„ api æ”¹åŠ¨å§, æˆ‘ä»¬ç›´æ¥åˆ æ‰æœ€åä¸€ä¸ªå‚æ•°:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-        _command-&gt;trianglesCommand-&gt;init(globalZOrder, textureID, glProgramState, blendFunc, *_command-&gt;triangles, transform, transformFlags);</span><br><span class="line">+        _command-&gt;trianglesCommand-&gt;init(globalZOrder, textureID, glProgramState, blendFunc, *_command-&gt;triangles, transform);</span><br></pre></td></tr></table></figure><hr><p>åˆ°æ­¤æå®šäº†æ‰€æœ‰çš„ç¼–è¯‘é—®é¢˜, å°è¯•äº†ä¸‹ Android å’Œ iOS çš„ç¼–è¯‘, ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜. è®©æˆ‘ä»¬è¿è¡Œä¸‹çœ‹ä¸‹æ•ˆæœ:</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1flnr7bq9vtg306v08skah.gif" alt=""></p><p>åè®°:</p><h1 id="1-Spine-Error-Unknown-attachment-type-skinnedmesh"><a href="#1-Spine-Error-Unknown-attachment-type-skinnedmesh" class="headerlink" title="1. Spine Error:Unknown attachment type: skinnedmesh"></a>1. Spine Error:Unknown attachment type: skinnedmesh</h1><p>è·Ÿæ–°å®Œåæœ‰çš„ Spine æ–‡ä»¶ä¼šæŠ¥è¿™ä¸ªé”™è¯¯, <a href="http://forum.cocos.com/t/1-3-1-spine-c-spine-skinnedmesh/41180/2" target="_blank" rel="noopener">è®ºå›é‡Œæœ‰è§£å†³æ–¹æ¡ˆ</a>, è™½ç„¶ä¸æŠ¥é”™äº†, ä½†æ˜¯ä¹Ÿä¸åŠ¨äº†, å¯èƒ½éœ€è¦ç¾æœ¯é‡æ–°åšä¸€é.</p><h1 id="2-çœŸçš„æœ‰å¿…è¦ä»-cocos2d-x-lite-ä¸­æ›´æ–°å—"><a href="#2-çœŸçš„æœ‰å¿…è¦ä»-cocos2d-x-lite-ä¸­æ›´æ–°å—" class="headerlink" title="2. çœŸçš„æœ‰å¿…è¦ä» cocos2d-x-lite ä¸­æ›´æ–°å—?"></a>2. çœŸçš„æœ‰å¿…è¦ä» cocos2d-x-lite ä¸­æ›´æ–°å—?</h1><p>ç»è¿‡å¥½å‹ @éƒ­å½¬ çš„æé†’, ç¡®å®æ²¡æœ‰å¿…è¦, ä»–å°±æ˜¯ä»å®˜æ–¹ä»“åº“æ›´æ–°çš„, æ˜¯æˆ‘ç”»è›‡æ·»è¶³äº†.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰æ®µæ—¶é—´ä¸€ä¸ªæœ‹å‹å‘æˆ‘å’¨è¯¢æ’­æ”¾ spine åŠ¨ç”»æ—¶é‡åˆ°çš„é—®é¢˜:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tNc79ly1flngumf7luj30ht04mq41.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜æˆ‘ä»¬åœ¨å¾ˆä¹…ä¹‹å‰ä¹Ÿé‡åˆ°è¿‡, å½“æ—¶æ˜¯å¦ä¸ªä¸€å°ä¼™ä¼´è´Ÿè´£çš„. å½“æ—¶çŒœæµ‹å¯èƒ½æ˜¯ &lt;code&gt;spine runtimes&lt;/code&gt; éœ€è¦å‡çº§, ä½†æ˜¯å‡çº§æ—¶é‡åˆ°äº†æŠ€æœ¯é—®é¢˜, æ°å¥½é¡¹ç›®æ¯”è¾ƒç´§, ä¾¿è®©ç¾æœ¯åŒå­¦é‡æ–°ç”¨è€ç‰ˆçš„ Spine ç¼–è¾‘å™¨é‡æ–°åšäº†ä¸€é.&lt;/p&gt;
    
    </summary>
    
    
      <category term="cocos2d-x" scheme="http://blog.justbilt.com/tags/cocos2d-x/"/>
    
      <category term="spine" scheme="http://blog.justbilt.com/tags/spine/"/>
    
  </entry>
  
  <entry>
    <title>Quick-cocos2d-x å°ç±³ Mix å…¨é¢å±é€‚é…</title>
    <link href="http://blog.justbilt.com/2017/11/17/quick-x-mi-mix-support/"/>
    <id>http://blog.justbilt.com/2017/11/17/quick-x-mi-mix-support/</id>
    <published>2017-11-17T03:58:46.000Z</published>
    <updated>2017-12-04T12:42:29.329Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰ç©å®¶åé¦ˆæˆ‘ä»¬çš„æ¸¸æˆåœ¨ Mix ä¸Šé¢æ— æ³•å…¨å±æ˜¾ç¤º, ä¸Šä¸‹ä¼šæœ‰é»‘è¾¹. æœç´¢äº†ä¸‹, ç½‘ä¸Šè¿˜æ²¡æœ‰ç»å¦‚ä½•é€‚é…çš„ç›¸å…³æ–‡ç« , è¿™é‡Œä»‹ç»ä¸‹æˆ‘ä»¬æ˜¯å¦‚ä½•åšçš„.</p><p>æˆ‘ä»¬å¯ä»¥åœ¨çœ‹çœ‹å°ç±³å®˜æ–¹<a href="https://dev.mi.com/doc/p=10083/index.html" target="_blank" rel="noopener">å¯¹å…¨é¢å±é€‚é…å·¥ä½œçš„ä»‹ç»</a>:</p><blockquote><p>è¿™äº›å˜åŒ–ä¹Ÿå½±å“äº†æ‰‹æœºè½¯ä»¶çš„è®¾è®¡ï¼Œæœ€å€¼å¾—å¼€å‘è€…å…³æ³¨çš„ï¼Œæ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>æ›´å¤§çš„å±å¹•é«˜å®½æ¯”</li><li>è™šæ‹Ÿå¯¼èˆªé”®</li></ol></blockquote><a id="more"></a><p>å¥½çš„, æˆ‘ä»¬å…ˆæŒ‰ç…§å®˜æ–¹çš„æ–¹æ³•ä¿®æ”¹ä¸‹ <code>max_aspect</code> çš„å€¼ä¸º <code>2</code> ä»¥ä¸Š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">"android.max_aspect"</span> <span class="attr">android:value</span>=<span class="string">"2.1"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸‹, å‘ç°é¡¶éƒ¨çš„é»‘æ¡ä¸è§äº†, ä½†æ˜¯åº•éƒ¨çš„è™šæ‹Ÿå¯¼èˆªé”®è¿˜åœ¨. æˆ‘ä»¬æ¥ç€çœ‹å®˜æ–¹çš„æ–‡æ¡£:</p><p><img src="https://dev.mi.com/doc/wp-content/uploads/2017/06/%E8%99%9A%E6%8B%9F%E9%94%AE%E7%9A%84%E6%A0%B7%E5%BC%8F.png" alt=""></p><p>ç„¶è€Œè¿™å‡ ç§æ•ˆæœéƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„, æˆ‘ä»¬æƒ³è¦æ˜¯éšè—<code>è™šæ‹Ÿå¯¼èˆªé”®</code>. Google ä¸€ä¸‹, å¾ˆå®¹æ˜“æœç´¢åˆ°è¿™æ®µä»£ç :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * éšè—è™šæ‹ŸæŒ‰é”®ï¼Œå¹¶ä¸”å…¨å±</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">hideBottomUIMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="comment">//éšè—è™šæ‹ŸæŒ‰é”®ï¼Œå¹¶ä¸”å…¨å±</span></span><br><span class="line">       <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt; <span class="number">11</span> &amp;&amp; Build.VERSION.SDK_INT &lt; <span class="number">19</span>) &#123; <span class="comment">// lower api</span></span><br><span class="line">           View v = <span class="keyword">this</span>.getWindow().getDecorView();</span><br><span class="line">           v.setSystemUiVisibility(View.GONE);</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= <span class="number">19</span>) &#123;</span><br><span class="line">           <span class="comment">//for new api versions.</span></span><br><span class="line">           View decorView = getWindow().getDecorView();</span><br><span class="line">           <span class="keyword">int</span> uiOptions = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</span><br><span class="line">                           | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY | View.SYSTEM_UI_FLAG_FULLSCREEN;</span><br><span class="line">           decorView.setSystemUiVisibility(uiOptions);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>åŠ ä¸Šä¹‹åå‘ç°å¯¼èˆªé”®çœŸçš„æ²¡æœ‰äº†, ä½†æ˜¯å½“ä½ ç‚¹å‡»å±å¹•æ—¶, å®ƒåˆå‡ºç°äº†. ç»§ç»­æœç´¢å‘ç°äº†<a href="https://segmentfault.com/a/1190000002936799" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>, æŒ‰ç…§æ–‡ç« ä¸­çš„æç¤ºè¿›è¡Œä¿®æ”¹ä½ çš„ AppActivity :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> Cocos2dxGLSurfaceView glSurfaceView;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState, SplashEnum splash, <span class="keyword">long</span> duration, <span class="keyword">boolean</span> debug)</span> </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">        View decorView = getWindow().getDecorView();</span><br><span class="line"><span class="comment">// Hide both the navigation bar and the status bar.</span></span><br><span class="line"><span class="comment">// SYSTEM_UI_FLAG_FULLSCREEN is only available on Android 4.1 and higher, but as</span></span><br><span class="line"><span class="comment">// a general rule, you should design your app to hide the status bar whenever you</span></span><br><span class="line"><span class="comment">// hide the navigation bar.</span></span><br><span class="line">        <span class="keyword">int</span> uiOptions = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION</span><br><span class="line">                | View.SYSTEM_UI_FLAG_FULLSCREEN;</span><br><span class="line">        decorView.setSystemUiVisibility(uiOptions);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cocos2dxGLSurfaceView <span class="title">onCreateView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        glSurfaceView = <span class="keyword">super</span>.onCreateView();</span><br><span class="line">        <span class="keyword">this</span>.hideSystemUI();</span><br><span class="line">        <span class="keyword">return</span> glSurfaceView;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWindowFocusChanged</span><span class="params">(<span class="keyword">boolean</span> hasFocus)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onWindowFocusChanged(hasFocus);</span><br><span class="line">        <span class="keyword">if</span> (hasFocus)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.hideSystemUI();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">hideSystemUI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Set the IMMERSIVE flag.</span></span><br><span class="line">        <span class="comment">// Set the content to appear under the system bars so that the content</span></span><br><span class="line">        <span class="comment">// doesn't resize when the system bars hide and show.</span></span><br><span class="line">        glSurfaceView.setSystemUiVisibility(</span><br><span class="line">                Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_LAYOUT_STABLE</span><br><span class="line">                        | Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION</span><br><span class="line">                        | Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN</span><br><span class="line">                        | Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_HIDE_NAVIGATION <span class="comment">// hide nav bar</span></span><br><span class="line">                        | Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_FULLSCREEN <span class="comment">// hide status bar</span></span><br><span class="line">                        | Cocos2dxGLSurfaceView.SYSTEM_UI_FLAG_IMMERSIVE_STICKY);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æå®š. çœ‹ä¸‹æœ€ç»ˆçš„æ•ˆæœ:</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1flncnl0u3tj30ku11278w.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ‰ç©å®¶åé¦ˆæˆ‘ä»¬çš„æ¸¸æˆåœ¨ Mix ä¸Šé¢æ— æ³•å…¨å±æ˜¾ç¤º, ä¸Šä¸‹ä¼šæœ‰é»‘è¾¹. æœç´¢äº†ä¸‹, ç½‘ä¸Šè¿˜æ²¡æœ‰ç»å¦‚ä½•é€‚é…çš„ç›¸å…³æ–‡ç« , è¿™é‡Œä»‹ç»ä¸‹æˆ‘ä»¬æ˜¯å¦‚ä½•åšçš„.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥åœ¨çœ‹çœ‹å°ç±³å®˜æ–¹&lt;a href=&quot;https://dev.mi.com/doc/p=10083/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¯¹å…¨é¢å±é€‚é…å·¥ä½œçš„ä»‹ç»&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™äº›å˜åŒ–ä¹Ÿå½±å“äº†æ‰‹æœºè½¯ä»¶çš„è®¾è®¡ï¼Œæœ€å€¼å¾—å¼€å‘è€…å…³æ³¨çš„ï¼Œæ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ›´å¤§çš„å±å¹•é«˜å®½æ¯”&lt;/li&gt;
&lt;li&gt;è™šæ‹Ÿå¯¼èˆªé”®&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
      <category term="Android" scheme="http://blog.justbilt.com/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>è®¢é˜… Hexo çš„ä¸»é¢˜é¡µ</title>
    <link href="http://blog.justbilt.com/2017/10/09/feed-hexo-themes-page/"/>
    <id>http://blog.justbilt.com/2017/10/09/feed-hexo-themes-page/</id>
    <published>2017-10-09T13:08:54.000Z</published>
    <updated>2017-10-10T13:17:09.000Z</updated>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€ä¸ªç»å¸¸æ¢åšå®¢ä¸»é¢˜çš„äºº, æ—¶ä¸æ—¶çš„å°±ä¼šå» <a href="https://hexo.io/themes/" target="_blank" rel="noopener">Hexo çš„ä¸»é¢˜é¡µ</a> é€›é€›, çœ‹çœ‹æœ‰ä»€ä¹ˆæ–°çš„ä¸»é¢˜, è†œæ‹œä¸‹å¤§è§¦ä»¬çš„ä½œå“.</p><p>æ¯”è¾ƒéº»çƒ¦çš„æ˜¯è¿™ä¸ªé¡µé¢å¹¶ä¸æ˜¯æŒ‰ç…§æ›´æ–°æ—¶é—´æ’åºçš„, ä¹Ÿæ²¡æœ‰æä¾›æŒ‰æ—¶é—´æ’åºçš„åŠŸèƒ½, æ‰€ä»¥åªèƒ½é è®°å¿†åŠ›äº†. è¿™æ ·å¾ˆå®¹æ˜“é”™è¿‡æ–°çš„ä¸»é¢˜, è€Œä¸”æ¯æ¬¡éƒ½æ˜¯ä»å¤´æ‰¾èµ·, æ•ˆç‡æä½.</p><p>æˆ‘è‡ªå·±æ˜¯ä¸€ä¸ª Feed çš„é‡åº¦ç”¨æˆ·, å‡ ä¹æ˜¯æˆ‘æ‰©å±•å­¦ä¹ çš„å”¯ä¸€é€”å¾„. é‚£ä¹ˆèƒ½ä¸èƒ½å°†è¿™ä¸ªç•Œé¢åšæˆä¸€ä¸ªè®¢é˜…æºå‘¢? </p><a id="more"></a><h1 id="1-Feed43"><a href="#1-Feed43" class="headerlink" title="1. Feed43"></a>1. Feed43</h1><p>åˆšå¥½çœ‹åˆ°æˆ‘è®¢é˜…çš„ <a href="https://aoxuis.me/" target="_blank" rel="noopener">@XAæŠ€æœ¯ä¸å®…</a> å…„æ›´æ–°äº†ä¸€ç¯‡æ–‡ç«  <a href="https://aoxuis.me/post/bo-ke/li-yong-feed43-zhi-zuo-shi-yao-zhi-de-mai-zhong-ce-chan-pin-de-rssding-yue-lian-jie" target="_blank" rel="noopener">åˆ©ç”¨ Feed43 åˆ¶ä½œä»€ä¹ˆå€¼å¾—ä¹°ä¼—æµ‹äº§å“çš„RSSè®¢é˜…é“¾æ¥</a>, æ„Ÿè§‰æŒºä¸é”™çš„, æˆ‘ä¹Ÿè¯•è¯•å§.</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fkcbou91p9j30j70izq89.jpg" alt=""></p><p>ç½‘ç«™çœ‹èµ·æ¥ååˆ†ç®€æ´, æˆ‘ä»¬ç‚¹å‡» <code>Create your own feed</code> å¼€å§‹åˆ¶ä½œè®¢é˜…æº, åŒæ„ä¸€å¤§å †çœ‹ä¸æ‡‚çš„æ¡æ¬¾å, æˆ‘ä»¬ä¼šæ¥åˆ°è¿™æ ·çš„ä¸€ä¸ªç•Œé¢:</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fkcbu7z8lbj30ix0ah75z.jpg" alt=""></p><p>æˆ‘ä»¬åœ¨ <code>Address</code> å¡«å…¥ Hexo ä¸»é¢˜é¡µçš„ç½‘å€, ç‚¹å‡» <code>Reload</code> å°±å¯ä»¥åŠ è½½ç½‘é¡µäº†, æˆåŠŸåæˆ‘ä»¬åœ¨ä¸‹é¢å¡«å…¥æå–è§„åˆ™, ä¸»è¦å°±æ˜¯ <code>Item (repeatable) Search Pattern</code> è¿™ä¸€æ , å…¶ä»–éƒ½å¯ä»¥ç©ºç€.</p><p>ç»è¿‡è§‚å¯ŸåŠä¸€ç•ªæ€è€ƒå, æˆ‘å¡«å†™çš„è§„åˆ™å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;li class=&quot;plugin on&quot;&gt;</span><br><span class="line">&#123;*&#125;&lt;div class=&quot;plugin-screenshot&quot;&gt;</span><br><span class="line">&#123;*&#125;&lt;noscript&gt;</span><br><span class="line">&#123;*&#125;&lt;img data-src=&quot;&#123;%&#125;&quot; &#123;*&#125;&gt;</span><br><span class="line">&#123;*&#125;&lt;a href=&quot;&#123;%&#125;&quot; class=&quot;plugin-preview-link&quot; target=&quot;_blank&quot;&gt;&lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">&#123;*&#125;&lt;a href=&quot;&#123;%&#125;&quot;&#123;*&#125; class=&quot;plugin-name&quot; target=&quot;_blank&quot;&gt;&#123;%&#125;&lt;/a&gt;</span><br><span class="line">&#123;*&#125;&lt;p class=&quot;plugin-desc&quot;&gt;&#123;%&#125;&lt;/p&gt;</span><br><span class="line">&#123;*&#125;</span><br><span class="line">&lt;/li&gt;</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;%1&#125; = https://hexo.io/build/screenshots/Ada-139a3754c7.jpg</span><br><span class="line">&#123;%2&#125; = https://shuirong.github.io/</span><br><span class="line">&#123;%3&#125; = https://github.com/shuiRong/hexo-theme-Ada</span><br><span class="line">&#123;%4&#125; = Ada</span><br><span class="line">&#123;%5&#125; = Ada is an concise theme for Hexo.</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æå–äº†æ¯ä¸€ä¸ªä¸»é¢˜çš„ <code>é¢„è§ˆå›¾ç‰‡</code>, <code>é¢„è§ˆåœ°å€</code>, <code>Github é¡¹ç›®åœ°å€</code>, <code>ä¸»é¢˜åç§°</code>, <code>ä¸»é¢˜ç®€ä»‹</code>. ä¸‹é¢å°±æ˜¯å¡«å†™æ¸²æŸ“è§„åˆ™äº†, ä¹Ÿå¾ˆç®€å•, è–›å¾®æœ‰ä¸€ç‚¹ html åŸºç¡€å°±å¯ä»¥æå®š. æœ€åçš„æˆæœå¦‚ä¸‹:</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fkcc1se8wrj30iw0rlq5q.jpg" alt=""></p><p>è¿˜ä¸é”™å“ˆ, æœ‰æ¨¡æœ‰æ ·çš„, å¤§å®¶æ„Ÿå…´è¶£çš„è¯ <a href="https://feed43.com/8308348441438115.xml" target="_blank" rel="noopener">ç‚¹å‡»è¿™é‡Œ</a> å¯ä»¥è·³è½¬æŸ¥çœ‹. ä»”ç»†æŸ¥çœ‹çš„è¯ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜:</p><blockquote><p>æ•°é‡æ¯”å®˜ç½‘å°‘äº†å¾ˆå¤š, è¿™é‡Œå¤§æ¦‚åªæœ‰ä¸åˆ° 20 ä¸ªä¸»é¢˜, è€Œå®˜ç½‘ä¸Šåˆ™æœ‰æ•° 154 ä¸ªä¸»é¢˜.</p></blockquote><p>åœ¨å­—ä½“åœ¨åå°çœ‹äº†ä¸‹, å‘ç°äº†è¿™å¥è¯:</p><blockquote><p>Page too big. First 102400 bytes loaded.</p></blockquote><p>Feed43 ä¸ºäº†åŠ å¿«é€Ÿåº¦, åªèŠ‚é€‰äº†åŸå§‹ç½‘é¡µçš„ä¸€éƒ¨åˆ†å†…å®¹, è¿™ä¸‹å®Œè›‹äº†, è¿™ä¸ªè®¢é˜…æºæ²¡æœ‰ä»»ä½•ä½œç”¨, æƒå½“ç»ƒæ‰‹äº†, åæ­£ä¹Ÿæ²¡æœ‰èŠ±è´¹å¤ªå¤šçš„æ—¶é—´.</p><h1 id="2-hexojs-site"><a href="#2-hexojs-site" class="headerlink" title="2. hexojs/site"></a>2. hexojs/site</h1><p><a href="https://github.com/hexojs/site" target="_blank" rel="noopener">hexojs/site</a> è¿™ä¸ª Github ä»“åº“æ˜¯ hexo.io è¿™ä¸ªç½‘ç«™çš„åŸå§‹ä»£ç , å…¶ä¸­ <a href="https://github.com/hexojs/site/blob/master/source/_data/themes.yml" target="_blank" rel="noopener">source/_data/themes.yml</a> è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸»é¢˜é¡µçš„åŸå§‹æ•°æ®æ–‡ä»¶.</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿè¿™ä¸ªæ–‡ä»¶çš„<a href="https://github.com/hexojs/site/commits/master/source/_data/themes.yml" target="_blank" rel="noopener">å†å²è®°å½•</a>æ¥å¾—çŸ¥ä¸»é¢˜çš„å˜åŒ–æƒ…å†µ:</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fkdgeh5qyrj30sw0w3n1j.jpg" alt=""></p><p>é‚£ä¹ˆå¦‚ä½•è®¢é˜…è¿™ä¸ªæ–‡ä»¶çš„å˜åŒ–å‘¢? stackoverflow ä¸Šçš„<a href="https://stackoverflow.com/a/7353586/3003184" target="_blank" rel="noopener">è¿™ä¸ªç­”æ¡ˆ</a>å¯ä»¥è§£å¾è¾ˆç–‘æƒ‘. </p><blockquote><p>åœ¨æ–‡ä»¶ url åé¢åŠ ä¸Š <code>.atom</code> å°±å¯ä»¥ç”Ÿæˆè¿™ä¸ª url çš„ feed æº</p></blockquote><p>å¤§å®¶å¯ä»¥ç‚¹<a href="https://github.com/hexojs/site/commits/master/source/_data/themes.yml.atom" target="_blank" rel="noopener">è¿™é‡ŒæŸ¥çœ‹</a>, å¤åˆ¶ url è®¢é˜…, æ•ˆæœå¾ˆç»™åŠ›:</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fkdgm3o20zj30v90rc431.jpg" alt=""></p><hr><p>ç»è¿‡è¿™æ¬¡æŠ˜è…¾, æ”¶è·é¢‡ä¸°å‘€:</p><ol><li>ä¼šä½¿ç”¨ Feed43 ç”Ÿæˆè‡ªå·±å–œæ¬¢ç½‘é¡µçš„è®¢é˜…æº</li><li>çŸ¥é“äº† Github åœ¨ä»»æ„ url åé¢åŠ  .atom å¯ä»¥ç”Ÿæˆè®¢é˜…æº</li></ol><p>ç”Ÿå‘½ä¸æ¯, æŠ˜è…¾ä¸æ­¢.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½œä¸ºä¸€ä¸ªç»å¸¸æ¢åšå®¢ä¸»é¢˜çš„äºº, æ—¶ä¸æ—¶çš„å°±ä¼šå» &lt;a href=&quot;https://hexo.io/themes/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo çš„ä¸»é¢˜é¡µ&lt;/a&gt; é€›é€›, çœ‹çœ‹æœ‰ä»€ä¹ˆæ–°çš„ä¸»é¢˜, è†œæ‹œä¸‹å¤§è§¦ä»¬çš„ä½œå“.&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒéº»çƒ¦çš„æ˜¯è¿™ä¸ªé¡µé¢å¹¶ä¸æ˜¯æŒ‰ç…§æ›´æ–°æ—¶é—´æ’åºçš„, ä¹Ÿæ²¡æœ‰æä¾›æŒ‰æ—¶é—´æ’åºçš„åŠŸèƒ½, æ‰€ä»¥åªèƒ½é è®°å¿†åŠ›äº†. è¿™æ ·å¾ˆå®¹æ˜“é”™è¿‡æ–°çš„ä¸»é¢˜, è€Œä¸”æ¯æ¬¡éƒ½æ˜¯ä»å¤´æ‰¾èµ·, æ•ˆç‡æä½.&lt;/p&gt;
&lt;p&gt;æˆ‘è‡ªå·±æ˜¯ä¸€ä¸ª Feed çš„é‡åº¦ç”¨æˆ·, å‡ ä¹æ˜¯æˆ‘æ‰©å±•å­¦ä¹ çš„å”¯ä¸€é€”å¾„. é‚£ä¹ˆèƒ½ä¸èƒ½å°†è¿™ä¸ªç•Œé¢åšæˆä¸€ä¸ªè®¢é˜…æºå‘¢? &lt;/p&gt;
    
    </summary>
    
    
      <category term="blog" scheme="http://blog.justbilt.com/tags/blog/"/>
    
      <category term="hexo" scheme="http://blog.justbilt.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³ electron-builder æ‰“åŒ…ä¾èµ–é—®é¢˜</title>
    <link href="http://blog.justbilt.com/2017/10/02/electron-builder-dependencies/"/>
    <id>http://blog.justbilt.com/2017/10/02/electron-builder-dependencies/</id>
    <published>2017-10-02T05:21:04.000Z</published>
    <updated>2017-10-02T08:16:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤§æ¦‚æ˜¯ä¸‰ä¸ªæœˆå‰, å†™äº† <a href="/2017/07/09/convert2fnt-electron-rewrite">ä½¿ç”¨ Electron é‡å†™ convert2fnt</a> è¿™ç¯‡æ–‡ç« , æ–‡ç« å¤§æ¦‚è®²äº†æˆ‘ç”¨ Electron é‡å†™ä¹‹å‰çš„ä¸€ä¸ª BMFont å­—ä½“ç”Ÿæˆå·¥å…·çš„äº‹æƒ….</p><p>å¼€å‘çš„è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒé¡ºåˆ©çš„, Node.js çš„ç”Ÿæ€éå¸¸ç»™åŠ›, åŠ ä¸Š Chrome, VSCode åŠ æŒ, å¼€å‘å’Œè°ƒè¯•éƒ½å¾ˆçˆ½. ä½†ç”±äºæˆ‘æ²¡æœ‰ WEB å¼€å‘çš„åŸºç¡€, æ•´è¿‡è¿‡ç¨‹åªèƒ½æ‘¸ç´¢åŠ ç½‘ä¸ŠæŸ¥èµ„æ–™, ä¸­é—´ä¹‹æ›²æŠ˜, è‡ªä¸è¶³ä¸ºå¤–äººé“ä¹Ÿ, ä½†æœ€ç»ˆç£•ç£•ç»Šç»Šçš„ä¹Ÿç®—æå‡ºæ¥äº†.</p><p>å‘ƒ, å…¶å®ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå®Œç¾. </p><blockquote><p>Windows ç‰ˆæ‰“åŒ…åå‘ç°è¿è¡Œä¸å¤ªæ­£å¸¸, ä½† Win å¼€å‘ç‰ˆä»¥åŠ Mac å¼€å‘/å‘å¸ƒç‰ˆéƒ½è¿è¡Œæ­£å¸¸.</p></blockquote><p>æœ‰äº›è¯¡å¼‚, ä¸è¿‡æˆ‘è‡ªå·±åªåœ¨ Mac ä¸Šä½¿ç”¨, åŠ ä¸Šå·¥ä½œæ¯”è¾ƒå¿™, ä¾¿æç½®äº†èµ·æ¥. ä½†è°æ„¿æ„åœ¨è‡ªå·±å¤´ä¸Šæ‚¬åœ¨ä¸€æŠŠåˆ©å‰‘å‘¢, ä¸‡ä¸€å“ªå¤©ç€æ€¥ç”¨ Win ç‰ˆçš„æ€ä¹ˆåŠ.</p><p>è¶ç€å›½åº†æ”¾å‡è¿˜æ²¡æœ‰ä»€ä¹ˆå®‰æ’çš„æ—¶å€™, èµ¶ç´§æä¸€ä¸‹.</p><a id="more"></a><hr><p>é¦–å…ˆè¦ææ˜ç™½æ— æ³•æ­£å¸¸è¿è¡Œçš„åŸå› æ˜¯ä»€ä¹ˆ, æ‰“å¼€ Chrom å¼€å‘è€…å·¥å…·åå‘ç°äº†é”™è¯¯å†…å®¹. é¡¹ç›®çš„ä¸€ä¸ªä¾èµ–é¡¹ <code>jimp</code> æ²¡æœ‰åŠ è½½æˆåŠŸ, åœ¨è°ƒç”¨è¿™ä¸ªæ¨¡å—çš„ä¸€ä¸ªå‡½æ•°åæŠ›å‡ºé”™è¯¯:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const Jimp = require(&quot;jimp&quot;);</span><br><span class="line">Jimp.read(imagePath, function (err, lenna) &#123;&#125;</span><br><span class="line">---</span><br><span class="line">Uncaught TypeError: Jimp.read is not a function</span><br></pre></td></tr></table></figure><p>è¯•ç€æ–­ç‚¹è·Ÿè¸ªäº†ä¸‹ <code>require(&quot;jimp&quot;)</code> çš„è¿‡ç¨‹, ç”±äºè‡ªå·±å¯¹ js çš„ç»†èŠ‚çŸ¥ä¹‹ç”šå°‘, ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆå¼‚å¸¸. å„ç§å…³é”®å­—ç»„åˆ Google ä¹Ÿæ²¡æœ‰ç»“æœ, ä¸€åº¦é™·å…¥äº†æ¯«æ— å¤´ç»ªçš„å›°å¢ƒ.</p><p>åœ¨æœç´¢çš„è¿‡ç¨‹ä¸­å‘ç° <code>electron</code> å’Œ <code>electron-builder</code> éƒ½æœ‰äº†æ–°çš„ç‰ˆæœ¬, äºæ˜¯æŠ±ç€ä¾¥å¹¸çš„å¿ƒæ€è¯•ç€å‡çº§äº†ä¸‹è¿™ä¸¤ä¸ªåº“.</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- "electron-builder": "^19.11.1",</span></span><br><span class="line"><span class="deletion">- "electron": "^1.6.11"</span></span><br><span class="line"><span class="addition">+ "electron-builder": "^19.33.0",</span></span><br><span class="line"><span class="addition">+ "electron": "^1.7.8",</span></span><br></pre></td></tr></table></figure><p>æ²¡æƒ³åˆ°, ç«Ÿç„¶ â€¦ â€¦ è¿˜æ˜¯æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜. å¥½å§, å…¶å®ä¹Ÿè¿˜åœ¨é¢„æ–™ä¹‹ä¸­. ä½†æ˜¯ä¹Ÿæœ‰ â€œå¥½æ¶ˆæ¯â€, å‡ºé”™çš„åœ°æ–¹å’Œä¹‹å‰ä¸ä¸€æ ·äº†.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module.js:472 Uncaught Error: Cannot find module &apos;bmp-js&apos;</span><br></pre></td></tr></table></figure><p>åˆæ˜¯ä¸€ç•ªæŠ˜è…¾, å°è¯•å„ç§è§£å†³æ–¹æ¡ˆ, å„ç§çŒœæƒ³, å„ç§ç»„åˆ. è¿™äº›å°è¯•å¤šæ²¡æœ‰ä»€ä¹ˆå˜åŒ–, æœ‰çš„å°è¯•åè€Œå°†æˆ‘å¸¦åˆ°æ²Ÿé‡Œ, ç¦»çœŸç›¸è¶Šæ¥è¶Šè¿œ. </p><p>æœ€åæˆ‘åšå®šäº†ä¸€ä¸ªæƒ³æ³•:</p><blockquote><p>æˆ‘çš„ä»£ç æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„, ä¸€å®šæ˜¯æ‰“åŒ…çš„é…ç½®æœ‰é—®é¢˜.</p></blockquote><p>æœç„¶, åœ¨ä»”ç»†é˜…è¯»å®˜æ–¹æ–‡æ¡£çš„æ—¶å€™å‘ç°äº†è¿™ä¸ª <a href="https://www.electron.build/tutorials/two-package-structure" target="_blank" rel="noopener">Two package.json Structure</a> , åŸæ¥å®˜æ–¹å·²ç»æ¨èä½¿ç”¨ä¸¤ä¸ªé…ç½®æ–‡ä»¶æ¥é…ç½®å„ç§å‚æ•°, ä¸€ä¸ªé…ç½®å¼€å‘æ—¶çš„å‚æ•°, ä¸€ä¸ªé…ç½®æ‰“åŒ…æ—¶çš„å‚æ•°. äºæ˜¯ä¾¿æœ‰äº†è¿™æ ·çš„ç›®å½•ç»“æ„:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ app</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.html</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ package-lock.json</span><br><span class="line">â”‚Â Â  â””â”€â”€ package.json</span><br><span class="line">â””â”€â”€ package.json</span><br></pre></td></tr></table></figure><p>åŒæ—¶, å®˜æ–¹è¿˜å»ºè®®åœ¨å¼€å‘çš„ <code>config.json</code> ä¸­å¢åŠ ä¸€ä¸ª <code>&quot;postinstall&quot;: &quot;electron-builder install-app-deps&quot;</code> æ¥è‡ªåŠ¨è§¦å‘å®‰è£… <code>app</code> ç›®å½•ä¸­çš„ä¾èµ–.</p><hr><p>å“ˆå“ˆ, é—®é¢˜å·²ç»è§£å†³, éƒ½æ˜¯æ²¡æœ‰ä»”ç»†çœ‹å®˜æ–¹æ–‡æ¡£æƒ¹çš„ç¥¸, ä½†ä»æ­¤ Win ä¸‹åŒå­¦ä¹Ÿå¯ä»¥ç”¨ä¸Šæ–°ç‰ˆçš„å·¥å…·å•¦.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤§æ¦‚æ˜¯ä¸‰ä¸ªæœˆå‰, å†™äº† &lt;a href=&quot;/2017/07/09/convert2fnt-electron-rewrite&quot;&gt;ä½¿ç”¨ Electron é‡å†™ convert2fnt&lt;/a&gt; è¿™ç¯‡æ–‡ç« , æ–‡ç« å¤§æ¦‚è®²äº†æˆ‘ç”¨ Electron é‡å†™ä¹‹å‰çš„ä¸€ä¸ª BMFont å­—ä½“ç”Ÿæˆå·¥å…·çš„äº‹æƒ….&lt;/p&gt;
&lt;p&gt;å¼€å‘çš„è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒé¡ºåˆ©çš„, Node.js çš„ç”Ÿæ€éå¸¸ç»™åŠ›, åŠ ä¸Š Chrome, VSCode åŠ æŒ, å¼€å‘å’Œè°ƒè¯•éƒ½å¾ˆçˆ½. ä½†ç”±äºæˆ‘æ²¡æœ‰ WEB å¼€å‘çš„åŸºç¡€, æ•´è¿‡è¿‡ç¨‹åªèƒ½æ‘¸ç´¢åŠ ç½‘ä¸ŠæŸ¥èµ„æ–™, ä¸­é—´ä¹‹æ›²æŠ˜, è‡ªä¸è¶³ä¸ºå¤–äººé“ä¹Ÿ, ä½†æœ€ç»ˆç£•ç£•ç»Šç»Šçš„ä¹Ÿç®—æå‡ºæ¥äº†.&lt;/p&gt;
&lt;p&gt;å‘ƒ, å…¶å®ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå®Œç¾. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Windows ç‰ˆæ‰“åŒ…åå‘ç°è¿è¡Œä¸å¤ªæ­£å¸¸, ä½† Win å¼€å‘ç‰ˆä»¥åŠ Mac å¼€å‘/å‘å¸ƒç‰ˆéƒ½è¿è¡Œæ­£å¸¸.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ‰äº›è¯¡å¼‚, ä¸è¿‡æˆ‘è‡ªå·±åªåœ¨ Mac ä¸Šä½¿ç”¨, åŠ ä¸Šå·¥ä½œæ¯”è¾ƒå¿™, ä¾¿æç½®äº†èµ·æ¥. ä½†è°æ„¿æ„åœ¨è‡ªå·±å¤´ä¸Šæ‚¬åœ¨ä¸€æŠŠåˆ©å‰‘å‘¢, ä¸‡ä¸€å“ªå¤©ç€æ€¥ç”¨ Win ç‰ˆçš„æ€ä¹ˆåŠ.&lt;/p&gt;
&lt;p&gt;è¶ç€å›½åº†æ”¾å‡è¿˜æ²¡æœ‰ä»€ä¹ˆå®‰æ’çš„æ—¶å€™, èµ¶ç´§æä¸€ä¸‹.&lt;/p&gt;
    
    </summary>
    
    
      <category term="convert2fnt" scheme="http://blog.justbilt.com/tags/convert2fnt/"/>
    
      <category term="Electron" scheme="http://blog.justbilt.com/tags/Electron/"/>
    
  </entry>
  
  <entry>
    <title>Quick-cocos2d-x ç¼–è¯‘ Lua ä»£ç åŠ é€Ÿ</title>
    <link href="http://blog.justbilt.com/2017/09/10/quick-x-make-package-speedup/"/>
    <id>http://blog.justbilt.com/2017/09/10/quick-x-make-package-speedup/</id>
    <published>2017-09-10T02:37:53.000Z</published>
    <updated>2017-09-10T11:48:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>quick-x åœ¨æ‰‹æœºä¸Šè¿è¡Œçš„æ—¶å€™å¹¶ä¸æ˜¯åŠ è½½é¡¹ç›®çš„ Lua çš„æºç , è€Œæ˜¯ä¸€ä¸ªåä¸º <code>game.zip</code> çš„å‹ç¼©åŒ…. å½“é¡¹ç›®ä¸­çš„ Lua æ–‡ä»¶è¶Šæ¥è¶Šå¤šçš„æ—¶å€™, ç”Ÿæˆè¿™ä¸ª game.zip çš„æ—¶é—´ä¼šè¶Šæ¥è¶Šä¹….</p><p>æˆ‘ä»¬ç›®å‰çš„é¡¹ç›®æœ‰ <code>1256</code> ä¸ª Lua æ–‡ä»¶, æ¯æ¬¡æ‰§è¡Œç¼–è¯‘æ“ä½œéœ€è¦è€—æ—¶å°†è¿‘ 40 ç§’çš„æ—¶é—´:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">time <span class="variable">$QUICK_V3_ROOT</span>/quick/bin/compile_scripts.sh -q -i ../src -o ../res/game.zip -e xxtea_zip -ek xxxx -es xxx</span><br><span class="line">---</span><br><span class="line">real    0m38.603s</span><br><span class="line">user    0m25.792s</span><br><span class="line">sys     0m3.369s</span><br></pre></td></tr></table></figure><p>å°¤å…¶æ˜¯å½“éœ€è¦åœ¨æ‰‹æœºä¸Šè°ƒè¯• Lua ä»£ç çš„æ—¶å€™, æ¯æ”¹ä¸€æ¬¡ä»£ç å°±éœ€è¦è¿è¡Œä¸€æ¬¡è¿™ä¸ªå‘½ä»¤, ç„¶å 40 ç§’å°±è¿‡å»äº†, ä½ ææ€•éƒ½å¿˜è®°è‡ªå·±è¯¥å…³æ³¨ä»€ä¹ˆæ”¹åŠ¨äº†å§!</p><a id="more"></a><h1 id="åˆ†æ-compile-scripts"><a href="#åˆ†æ-compile-scripts" class="headerlink" title="åˆ†æ compile_scripts"></a>åˆ†æ compile_scripts</h1><p>åœ¨ <code>$QUICK_V3_ROOT/quick/bin</code> ç›®å½•æˆ‘ä»¬å¯ä»¥æ‰¾åˆ° <code>compile_scripts.sh</code> :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">export</span> LUA_PATH=<span class="string">"<span class="variable">$QUICK_V3_ROOT</span>/quick/bin/mac/?.lua;;"</span></span><br><span class="line">DIR=<span class="string">"<span class="variable">$( cd "$( dirname "$&#123;BASH_SOURCE[0]&#125;" )</span>"</span> &amp;&amp; <span class="built_in">pwd</span> )<span class="string">"</span></span><br><span class="line"><span class="string">php "</span><span class="variable">$DIR</span>/lib/compile_scripts.php<span class="string">" $*</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè„šæœ¬å¾ˆç®€å•, åªæ˜¯ä¸€ä¸ªå…¥å£, çœŸæ­£çš„é€»è¾‘æ˜¯åœ¨ <code>compile_scripts.php</code> æ–‡ä»¶ä¸­, æ‰“å¼€è¿™ä¸ªæ–‡ä»¶åå‘ç°å®ƒä¸»è¦åŠŸèƒ½æ˜¯å¤„ç†è¾“å…¥çš„å‚æ•°, å‰©ä½™çš„å·¥ä½œæ˜¯é€šè¿‡ <code>ScriptsCompiler</code> è¿™ä¸ªç±»å®Œæˆçš„, å®ƒä½äº ScriptsCompiler.lua ä¸­.</p><p>å¿…é¡»æ‰¿è®¤, å»–å¤§ä»–ä»¬å†™çš„ä»£ç è¿˜æ˜¯å¾ˆæ£’çš„, æˆ‘ä»¬åªçœ‹ ScriptsCompiler çš„ <code>run</code> å‡½æ•°ä¾¿å¯ä»¥çŒœåˆ°è¿™ä¸ªç±»éƒ½å¹²äº†é‚£äº›äº‹æƒ…:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $files = <span class="keyword">$this</span>-&gt;searchSourceFiles();</span><br><span class="line">    $modules = <span class="keyword">$this</span>-&gt;prepareForCompile($files);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;config[<span class="string">'encrypt'</span>] == <span class="keyword">self</span>::ENCRYPT_XXTEA_CHUNK)</span><br><span class="line">    &#123;</span><br><span class="line">        $bytes = <span class="keyword">$this</span>-&gt;compileModules($modules, <span class="keyword">$this</span>-&gt;config[<span class="string">'key'</span>], <span class="keyword">$this</span>-&gt;config[<span class="string">'sign'</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        $bytes = <span class="keyword">$this</span>-&gt;compileModules($modules);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!is_array($bytes))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cleanupTempFiles($modules);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;createOutput($modules, $bytes))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cleanupTempFiles($modules);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;cleanupTempFiles($modules);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…åˆç€å…¶ä¸­è°ƒç”¨çš„å‡½æ•°çš„ç»†èŠ‚, æˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¯¥ç±»çš„ä¸»è¦å·¥ä½œæµç¨‹:</p><ol><li>æ‰¾åˆ°æ‰€æœ‰çš„ Lua æ–‡ä»¶.</li><li>è°ƒç”¨ <code>getScriptFileBytecodes</code> å‡½æ•°è·å–ä¸Šä¸€æ­¥é‚£äº› Lua æ–‡ä»¶çš„å­—èŠ‚ç .</li><li>åˆ›å»ºè¾“å‡ºæ–‡ä»¶ <code>game.zip</code>.</li><li>åŠ å¯†è¾“å‡ºæ–‡ä»¶ <code>game.zip</code>.</li></ol><p>å½“ç„¶è¿˜æœ‰ä¸€äº›åˆ†æ”¯çš„æƒ…å†µ, ä¸è¿‡æˆ‘ä»¬å…³æ³¨çš„å·¥ä½œæµç¨‹å°±æ˜¯è¿™ä¸ªæ ·å­çš„.</p><h1 id="å¿«é€Ÿä¼˜åŒ–"><a href="#å¿«é€Ÿä¼˜åŒ–" class="headerlink" title="å¿«é€Ÿä¼˜åŒ–"></a>å¿«é€Ÿä¼˜åŒ–</h1><p>ä»ä¸Šä¸€æ­¥çš„æºç é˜…è¯»è¿‡ç¨‹ä¸­å¾—çŸ¥, å¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨ <code>compile_scripts.sh</code> æ—¶, ä¸ä¼ å…¥åŠ å¯†ä¿¡æ¯çš„è¯, å°±ä¸ä¼šç¬¬å››æ­¥æ“ä½œ. åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­, åŠ å¯†è¿™ä¸€æ­¥å…¶å®æ˜¯å¯ä»¥çœç•¥, æœ€ç»ˆæ‰“åŒ…çš„æ—¶å€™åŠ å¯†ä¸€æ¬¡å°±å¯ä»¥äº†.</p><p>é‚£ä¹ˆå¹²æ‰ç¬¬ 4 æ­¥å¯¹äºæ‰“åŒ…èŠ±è´¹åˆ°åº•èƒ½å‡å°‘å¤šå°‘å‘¢ ? æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹, è¿˜æ˜¯æ–‡ç« æœ€å¼€å§‹çš„é‚£ç«¯è„šæœ¬, æˆ‘ä»¬è¿™æ¬¡åˆ é™¤æœ€åé¢çš„ä¸€äº›åŠ å¯†å‚æ•°è¯•ä¸€ä¸‹:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">time <span class="variable">$QUICK_V3_ROOT</span>/quick/bin/compile_scripts.sh -q -i ../src -o ../res/game.zip</span><br><span class="line">---</span><br><span class="line">real    0m16.362s</span><br><span class="line">user    0m8.333s</span><br><span class="line">sys     0m2.579s</span><br></pre></td></tr></table></figure><p>å¾ˆå¹¸è¿, åŠ å¯†ç¡®å®æ¶ˆè€—äº†å¾ˆå¤šçš„æ—¶é—´, å› æ­¤æˆ‘ä»¬æ²¡æœ‰èŠ±è´¹å¤šå°‘ç²¾åŠ›å°±æŠŠç¼–è¯‘æ—¶é—´å‡å°‘ä¸ºäº†å½“åˆçš„ <code>42%</code>. æˆ‘ä»¬å¯ä»¥åœ¨æ¸¸æˆå·¥ç¨‹ä¸­å»ºç«‹ä¸¤ä¸ªè„šæœ¬, <code>pack_lua.sh</code> å’Œ <code>pack_lua_dev.sh</code>, åˆ†åˆ«æ”¾å…¥ä¸Šè¿°çš„ä¸¤è¡Œå‘½ä»¤, è¿™æ ·æˆ‘ä»¬åœ¨å¼€å‘/è°ƒè¯•æœŸé—´åªç”¨è°ƒç”¨ <code>pack_lua_dev.sh</code> å°±å¯ä»¥äº†.</p><p>ç„¶è€Œè¿™ä¸€åˆ‡è¿˜ä¸å€¼å¾—æˆ‘ä»¬æ¬¢å‘¼, è¿™æ˜¯ä¸€ä¸ªå¾ˆå–å·§çš„æ–¹æ¡ˆ, æˆ–è®¸æ˜¯æˆ‘ä»¬å›¢é˜Ÿæœ¬èº«å°±å¯¹ <code>compile_scripts</code> è¿™ä¸ªæ“ä½œçš„ç†è§£ä¸å¤Ÿ, å¯¼è‡´æˆ‘ä»¬ä¸€ç›´ä»¥æ¥å°±æ¥ä½¿ç”¨çš„è¿™ä¸ªæ–¹æ¡ˆå°±æ˜¯é”™è¯¯çš„.</p><p>å†µä¸”, <code>16</code> ç§’è¿˜æ˜¯å¾ˆä¹….</p><h1 id="æ·±åº¦ä¼˜åŒ–"><a href="#æ·±åº¦ä¼˜åŒ–" class="headerlink" title="æ·±åº¦ä¼˜åŒ–"></a>æ·±åº¦ä¼˜åŒ–</h1><p>æ ¹æ®ä¸Šä¸€æ­¥å¾—å‡ºçš„ä¿¡æ¯, æœ‰ 16 ç§’çš„æ—¶é—´æ˜¯æ¶ˆè€—åœ¨äº†å‰ä¸‰æ­¥, (æ ¹æ®å¤šå¹´ç»éªŒ)è€Œå…¶ä¸­ç¬¬ä¸€æ­¥å’Œç¬¬ä¸‰æ­¥çš„æ¶ˆè€—ä¹Ÿéå¸¸å°, é‚£ä¹ˆä¸»è¦çš„æ¶ˆè€—æ˜¯åœ¨ç¬¬äºŒæ­¥ä¸Š.</p><p>ç»è¿‡è§‚å¯Ÿ, æ¯æ¬¡æˆ‘ä»¬è¿è¡Œ <code>compile_scripts</code> éƒ½ä¼šæŠŠæ‰€æœ‰çš„ Lua ä»£ç éƒ½ç¼–è¯‘ä¸€é, é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æŠŠå†å²çš„ç»“æœç¼“å­˜ä¸‹æ¥, åªç¼–è¯‘æ–°å¢å’Œå˜åŒ–çš„æ–‡ä»¶å‘¢ ?</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¼„æ‡‚, è¿™ä¸ªæ‰€è°“çš„ <code>ç¼–è¯‘</code> æ“ä½œ, åˆ°åº•åšäº†ä»€ä¹ˆ ? è®©æˆ‘ä»¬å†æ¬¡æŠŠç›®å…‰è½¬å‘ä¹‹å‰å¾—çŸ¥çš„ <code>getScriptFileBytecodes</code> å‡½æ•°.</p><p>è¯¥å‡½æ•°ä½äº <code>$QUICK_V3_ROOT/quick/bin/lib/quick/init.php</code> ä¸­, æˆ‘ä»¬åœ¨å‡½æ•°ä¸­æ‰§è¡Œå‘½ä»¤å‰åŠ ä¸Šè¾“å‡º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">printf(<span class="string">"command: %s\n"</span>, $command);</span><br><span class="line">passthru($command);</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰§è¡Œ <code>compile_scripts</code>, æ³¨æ„å»æ‰ <code>-q</code> å‚æ•°, æˆ‘ä»¬å¯ä»¥åœ¨è¾“å‡ºä¸­çœ‹åˆ°:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span>: /xxx/quick-cocos2d-x/quick/bin/mac/luac -o <span class="string">"xxx.bytes"</span> <span class="string">"xxx.lua"</span></span><br></pre></td></tr></table></figure><p>çœ‹æ¥å°±æ˜¯è°ƒç”¨äº†ä¸‹ <code>luac</code> å‘½ä»¤å˜›, æŒºç®€å•çš„å‘€!</p><blockquote><p>(æ³¨: å®é™…æƒ…å†µä¼šå¤æ‚ä¸€äº›, å› ä¸ºå¯èƒ½ä¼šç”¨åˆ° luajit å·¥ä½œæµç¨‹, è¿™é‡Œåªè®¨è®ºæˆ‘ä»¬ç›®å‰çš„å·¥ä½œæµ)</p></blockquote><p>ææ‡‚äº†åŸç†çš„è¯, å°±å¯ä»¥å¼€æ’¸äº†, æˆ‘å¹¶ä¸æ‰“ç®—ä¿®æ”¹ quick çš„ php ä»£ç , æˆ‘ä¼šç”¨æˆ‘æ›´ç†Ÿæ‚‰çš„ Python æ¥å†™ä¸€ä¸ªä¼˜åŒ–ç‰ˆçš„ Lua ç¼–è¯‘è„šæœ¬. ä¸‹é¢æ˜¯æ ¸å¿ƒçš„ä»£ç , æˆ‘åŠ äº†ä¸€äº›å¿…è¦çš„æ³¨é‡Š:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">package</span><span class="params">(_src, _dst)</span>:</span></span><br><span class="line">    cache_path = CACHE_ROOT</span><br><span class="line">    shutils.mkdir(cache_path)</span><br><span class="line">    hash_file = os.path.join(cache_path, <span class="string">"hash.json"</span>)</span><br><span class="line">    hash_data = shutils.read_json(hash_file, &#123;&#125;)</span><br><span class="line">    hash_data_new = &#123;&#125;</span><br><span class="line">    shutils.remove(_dst)</span><br><span class="line">    dst_zip = zipfile.ZipFile(_dst, <span class="string">"w"</span>, zipfile.ZIP_DEFLATED)</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> shutils.file_list(_src):</span><br><span class="line">        <span class="keyword">if</span> f.startswith(<span class="string">"."</span>) <span class="keyword">or</span> <span class="keyword">not</span> f.endswith(<span class="string">".lua"</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        src_filepath = os.path.abspath(os.path.join(_src, f))</span><br><span class="line">        dst_filename = f.replace(<span class="string">".lua"</span>, <span class="string">""</span>).replace(<span class="string">"/"</span>, <span class="string">"."</span>)</span><br><span class="line">        dst_filepath = os.path.abspath(os.path.join(cache_path, dst_filename))</span><br><span class="line">        src_hash = shutils.file_hash(src_filepath)</span><br><span class="line">        dst_hash = shutils.file_hash(dst_filepath)</span><br><span class="line">        record_hash = hash_data.get(dst_filename, &#123;&#125;)</span><br><span class="line">        exists_error = <span class="keyword">False</span></span><br><span class="line">        <span class="comment"># æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (dst_hash <span class="keyword">and</span> record_hash.get(<span class="string">"src"</span>, <span class="string">""</span>) == src_hash <span class="keyword">and</span> record_hash.get(<span class="string">"dst"</span>, <span class="string">""</span>) == dst_hash):</span><br><span class="line">            <span class="comment"># è¿™é‡Œä¸ºç§»é™¤æ—¶ä¸ºäº†æ„ŸçŸ¥ luac ç¼–è¯‘å¤±è´¥</span></span><br><span class="line">            shutils.remove(dst_filepath)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"ADD: "</span> + f</span><br><span class="line">            luac_compile(src_filepath, dst_filepath)</span><br><span class="line">            dst_hash = shutils.file_hash(dst_filepath)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> dst_hash:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"\n---"</span></span><br><span class="line">                <span class="keyword">print</span> <span class="string">"ERROR: "</span> + src_filepath</span><br><span class="line">                exists_error = <span class="keyword">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        dst_zip.write(dst_filepath, dst_filename)</span><br><span class="line">        hash_data_new[dst_filename] = &#123;<span class="string">"src"</span>: src_hash, <span class="string">"dst"</span>: dst_hash&#125;</span><br><span class="line">    shutils.save_json(hash_data_new, hash_file)</span><br><span class="line">    <span class="keyword">if</span> exists_error:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">    dst_zip.close()</span><br><span class="line">    <span class="comment"># åˆ é™¤åŸå§‹æ–‡ä»¶å·²ç»ä¸å­˜åœ¨çš„ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> shutils.file_list(cache_path):</span><br><span class="line">        <span class="keyword">if</span> f == <span class="string">"hash.json"</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hash_data_new.get(f):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"REMOVE: "</span> + f</span><br><span class="line">            os.remove(os.path.join(cache_path, f))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">True</span></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç é‡Œå¤šæ˜¯é€»è¾‘çš„æ’åˆ—, æ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„. å€¼å¾—ä¸€æçš„æ˜¯æ˜¯, luac ç¼–è¯‘å¤±è´¥çš„å¤„ç†, luac å¤±è´¥åä¼šè¾“å‡ºé”™è¯¯æ—¥å¿—, ä¸ä¼šç”Ÿæˆå¯¹åº”çš„å­—èŠ‚ç :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ python luapack.py src res/game.zip</span><br><span class="line">ADD: main.lua</span><br><span class="line">/xxx/quick-cocos2d-x/quick/bin/mac/luac: /xxx/src/main.lua:10: <span class="string">'='</span> expected near <span class="string">'package'</span></span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">ERROR: /Users/bilt/Documents/wanghaitao/easy_slg_client/src/main.lua</span><br></pre></td></tr></table></figure><p>å› æ­¤æˆ‘ä»¬å…ˆå°è¯•ç§»é™¤æ‰ç›®æ ‡æ–‡ä»¶, å¦‚æœç”Ÿæˆæ–‡ä»¶ä¸å­˜åœ¨åˆ™è¡¨ç¤ºæœ¬æ¬¡ luac å¤±è´¥äº†. </p><p>å®Œæ•´ç‰ˆçš„ä»£ç ä½äº<a href="https://gist.github.com/justbilt/7c881cbdbff74f3fdd97278355d22fed" target="_blank" rel="noopener">æˆ‘çš„ gist ä¸Š</a>, è¿™ä»½ä»£ç åªæ˜¯æœ€åŸºæœ¬çš„å®ç°, è¿˜æœ‰å¾ˆå¤šä¼˜åŒ–çš„ç©ºé—´. å¥½çš„, æˆ‘è¿«ä¸åŠå¾…çš„æƒ³çœ‹çœ‹æˆ‘ä»¬ä¼˜åŒ–çš„æˆæœäº†.</p><p>è®©æˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€æ¬¡è¿è¡Œçš„ç»“æœ:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ time python luapack.py src res/game.zip</span><br><span class="line">---</span><br><span class="line">real    0m15.590s</span><br><span class="line">user    0m6.664s</span><br><span class="line">sys     0m2.946s</span><br></pre></td></tr></table></figure><p><code>16</code> ç§’, æ¥è¿‘ä¹‹å‰æ— åŠ å¯†ç‰ˆçš„ <code>compile_scripts</code> æ¶ˆè€—, è®©æˆ‘ä»¬å˜æ›´ä¸€ä¸ªæ–‡ä»¶è¯•è¯•å‘¢?</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ time python luapack.py src res/game.zip</span><br><span class="line">ADD: main.lua</span><br><span class="line">---</span><br><span class="line">real    0m1.611s</span><br><span class="line">user    0m1.403s</span><br><span class="line">sys     0m0.175s</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸åˆ° 2 ç§’çš„è€—æ—¶, å¤ªç‰›é€¼äº†!</p><hr><p>åœ¨æœ¬æ¬¡çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­, æˆ‘ä»¬æˆåŠŸçš„å°†è€—ç”±æœ€åˆçš„ <code>38.603s</code> é™ä½ä¸ºæœ€ç»ˆçš„ <code>1.611s</code>, æ¥è¿‘ <code>24</code> å€çš„æ•ˆç‡æå‡, è¿™æ˜¯ä¸€ä¸ªè´¨çš„é£è·ƒ! æ„Ÿè§‰è‡ªå·±æ£’æ£’å“’,æ™šé¥­ç”³è¯·åŠ ä¸€ä¸ªé¸¡è…¿.</p><p>å½“ç„¶æˆ‘ä»¬è¿˜åšäº†ä¸€äº›å…¶ä»–çš„ä¸œè¥¿, æ¯”å¦‚æˆ‘ä»¬ç»™æ—¥å¿—åŠ ä¸Šäº†å½©è‰²çš„è¾“å‡º:</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fjep3wv9cjj30vz03uq3p.jpg" alt=""></p><p>æ˜¯ä¸æ˜¯å˜çš„å¾ˆæ¼‚äº® ?</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;quick-x åœ¨æ‰‹æœºä¸Šè¿è¡Œçš„æ—¶å€™å¹¶ä¸æ˜¯åŠ è½½é¡¹ç›®çš„ Lua çš„æºç , è€Œæ˜¯ä¸€ä¸ªåä¸º &lt;code&gt;game.zip&lt;/code&gt; çš„å‹ç¼©åŒ…. å½“é¡¹ç›®ä¸­çš„ Lua æ–‡ä»¶è¶Šæ¥è¶Šå¤šçš„æ—¶å€™, ç”Ÿæˆè¿™ä¸ª game.zip çš„æ—¶é—´ä¼šè¶Šæ¥è¶Šä¹….&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç›®å‰çš„é¡¹ç›®æœ‰ &lt;code&gt;1256&lt;/code&gt; ä¸ª Lua æ–‡ä»¶, æ¯æ¬¡æ‰§è¡Œç¼–è¯‘æ“ä½œéœ€è¦è€—æ—¶å°†è¿‘ 40 ç§’çš„æ—¶é—´:&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;time &lt;span class=&quot;variable&quot;&gt;$QUICK_V3_ROOT&lt;/span&gt;/quick/bin/compile_scripts.sh -q -i ../src -o ../res/game.zip -e xxtea_zip -ek xxxx -es xxx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;---&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;real    0m38.603s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user    0m25.792s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sys     0m3.369s&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å°¤å…¶æ˜¯å½“éœ€è¦åœ¨æ‰‹æœºä¸Šè°ƒè¯• Lua ä»£ç çš„æ—¶å€™, æ¯æ”¹ä¸€æ¬¡ä»£ç å°±éœ€è¦è¿è¡Œä¸€æ¬¡è¿™ä¸ªå‘½ä»¤, ç„¶å 40 ç§’å°±è¿‡å»äº†, ä½ ææ€•éƒ½å¿˜è®°è‡ªå·±è¯¥å…³æ³¨ä»€ä¹ˆæ”¹åŠ¨äº†å§!&lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
      <category term="Lua" scheme="http://blog.justbilt.com/tags/Lua/"/>
    
  </entry>
  
  <entry>
    <title>å°† python æ•°æ®è½¬åŒ–ä¸º lua æ ¼å¼</title>
    <link href="http://blog.justbilt.com/2017/09/03/serialize-lua-in-pyhton/"/>
    <id>http://blog.justbilt.com/2017/09/03/serialize-lua-in-pyhton/</id>
    <published>2017-09-03T07:45:53.000Z</published>
    <updated>2017-09-07T14:19:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬å›¢é˜Ÿçš„æŠ€æœ¯æ ˆæ˜¯: <code>Lua + Python</code>, å‰ç«¯é‡‡ç”¨ Lua å†™é¡¹ç›®, Python åšå·¥å…·æ”¯æŒ, è€Œåç«¯åˆ™é‡‡ç”¨çº¯ Python å¼€å‘, æ‰€ä»¥ä¼šç»å¸¸é‡åˆ° Python å’Œ Lua æ•°æ®çš„è½¬åŒ–.</p><a id="more"></a><p>ç›®å‰ä¸šå†…é‡‡ç”¨çš„æ–¹æ³•å¤§è‡´æœ‰ä¸¤ç§:</p><ol><li>ç”¨ Python å†™ä¸€ä¸ª Lua çš„è¯­æ³•è§£æ, ç”¨ Lua å†™ä¸€ä¸ª Pyhton çš„è¯­æ³•è§£æ, è¿™æ ·å°±å¯ä»¥äº’ç›¸è½¬åŒ–äº†.</li><li>ä½¿ç”¨ä¸€ä¸ªå¤§å®¶éƒ½æ”¯æŒçš„æ•°æ®ç»“æ„åšä¸­è½¬, å¦‚: Json æˆ– Yaml.</li></ol><p>ç¬¬ä¸€ç§æ–¹æ¡ˆæ¯”è¾ƒå¤æ‚, Python è§£æ Lua å€’æ˜¯æœ‰ <a href="https://github.com/SirAnthony/slpp" target="_blank" rel="noopener">slpp</a> è¿™æ ·çš„é¡¹ç›®, Lua è§£æ Python çš„åˆ™æ˜¯æ²¡æœ‰, å› æ­¤å¤§å®¶æ›´å¤šçš„æ˜¯é‡‡ç”¨ç¬¬äºŒç§æ–¹æ¡ˆ.</p><p>ç¬¬äºŒç§æ–¹æ¡ˆä¸­ json å…¶å®æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„è§£å†³æ–¹æ¡ˆ, æ€§èƒ½ä¹Ÿæ¯” Lua å¿«ä¸€äº›, ä½†æ˜¯ json æ²¡æœ‰åŠæ³•å­˜å‚¨ number ç±»å‹çš„ key, è¿™ä¸€ç‚¹åœ¨æ•°æ®ç»“æ„çš„è®¾è®¡ä¸Šå¾ˆè›‹ç–¼, å¯èƒ½ä¼šè®©ä½ çš„ä»£ç å……æ–¥ç€ <code>tostring</code>, <code>tonumber</code> è¿™æ ·çš„ä»£ç .</p><p>ç»è¿‡è§‚å¯Ÿ, json å’Œ Lua è¿™ä¸¤ç§æ–‡ä»¶æ ¼å¼å…¶å®æ˜¯ååˆ†åƒçš„, é‚£ä¹ˆæˆ‘æ˜¯å¦åªè¦é­”æ”¹ä¸‹ python çš„ json åº“, ä½¿ä¹‹æ”¯æŒ number åš key, ç„¶åä¿å­˜ä¸º Lua æ–‡ä»¶ ?</p><h1 id="å¼€æ’¸"><a href="#å¼€æ’¸" class="headerlink" title="å¼€æ’¸"></a>å¼€æ’¸</h1><h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1. å‡†å¤‡å·¥ä½œ"></a>1. å‡†å¤‡å·¥ä½œ</h2><p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ° json åº“çš„æºç  <a href="https://github.com/python/cpython/blob/master/Lib/json" target="_blank" rel="noopener">https://github.com/python/cpython/blob/master/Lib/json</a>, è¿™ä¸ªç›®å½•ä¸­æœ‰ 4 ä¸ªæ–‡ä»¶, æˆ‘ä»¬æŠŠ <code>encoder.py</code> ä¸‹è½½ä¸‹æ¥, ä¿å­˜ä¸º <code>lua.py</code>.</p><p>ä½†æ˜¯åªæœ‰è¿™ä¸€ä¸ªæ–‡ä»¶æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥è¿è¡Œçš„, æˆ‘ä»¬å†ä» <code>encoder.py</code> åŒçº§çš„ <code>__init__.py</code> ä¸­å¤åˆ¶ <code>dumps</code> å‡½æ•°åˆ° <code>lua.py</code> çš„æœ«å°¾.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dumps</span><span class="params">(obj, skipkeys=False, ensure_ascii=True, check_circular=True,</span></span></span><br><span class="line"><span class="function"><span class="params">              allow_nan=True, cls=None, indent=None, separators=None,</span></span></span><br><span class="line"><span class="function"><span class="params">              encoding=<span class="string">'utf-8'</span>, default=None, sort_keys=False, **kw)</span>:</span></span><br><span class="line">       <span class="keyword">if</span> cls <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">              cls = JSONEncoder</span><br><span class="line">       <span class="keyword">return</span> cls(</span><br><span class="line">              skipkeys=skipkeys, ensure_ascii=ensure_ascii,</span><br><span class="line">              check_circular=check_circular, allow_nan=allow_nan, indent=indent,</span><br><span class="line">              separators=separators, encoding=encoding, default=default,</span><br><span class="line">              sort_keys=sort_keys, **kw).encode(obj)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ <code>lua.py</code> åŒçº§ç›®å½•æ–°å»ºä¸€ä¸ª <code>test.py</code> åšæµ‹è¯•, è¿™é‡Œæˆ‘ä»¬æŠŠä¸€ä¸ªpythonçš„æ•°æ®ä¿å­˜ä¸º <code>test.lua</code> æ–‡ä»¶:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lua</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"a"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="number">2</span>,</span><br><span class="line">    <span class="string">"3a"</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">"4"</span>:[</span><br><span class="line">        <span class="number">1</span>,<span class="number">2</span>,<span class="string">"a"</span>,<span class="keyword">False</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"test.lua"</span>, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(lua.dumps(data, ensure_ascii=<span class="keyword">False</span>, indent=<span class="number">2</span>, sort_keys=<span class="keyword">True</span>))</span><br></pre></td></tr></table></figure><p>å®Œæˆåç›´æ¥ç»ˆç«¯è¿è¡Œ <code>python test.py</code> å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ–°ç”Ÿæˆäº†ä¸€ä¸ª lua æ–‡ä»¶, å†…å®¹å¦‚ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"2"</span>: <span class="number">2</span>, </span><br><span class="line">  <span class="string">"3a"</span>: <span class="number">3</span>, </span><br><span class="line">  <span class="string">"4"</span>: [</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  ], </span><br><span class="line">  <span class="string">"a"</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç¬¬ä¸€æ­¥çš„å·¥ä½œå°±æå®šäº†.</p><h2 id="2-é­”æ”¹-lua-py"><a href="#2-é­”æ”¹-lua-py" class="headerlink" title="2. é­”æ”¹ lua.py"></a>2. é­”æ”¹ lua.py</h2><p>å…¶å®ä¸Šä¸€æ­¥ç”Ÿæˆçš„æ–‡ä»¶å†…å®¹å¹¶ä¸æ˜¯ lua æ ¼å¼çš„, å…¶å®è¿˜æ˜¯ json æ ¼å¼, åªæ˜¯æˆ‘ä»¬å°†åç¼€æ”¹ä¸º lua äº†è€Œå·². è¿™ä¸ªæ ¼å¼å’ŒçœŸæ­£çš„ lua æƒ³æ¯”æœ‰ä¸¤å¤„ä¸å¯¹:</p><ol><li>Lua çš„æ•°ç»„ä½¿ç”¨ <code>{}</code> è¡¨ç¤º.</li><li>Lua ä½¿ç”¨ <code>=</code> åš key,value çš„åˆ†éš”.</li><li>Lua string ç±»å‹çš„ key, ä¸ç”¨åŠ å¼•å·, å¦‚æœè¦åŠ å¼•å·çš„è¯, éœ€è¦åŒæ—¶åŠ ä¸€å¯¹æ–¹æ‹¬å·.</li></ol><p>ç¬¬ä¸€ä¸ªé—®é¢˜å¾ˆå¥½è§£å†³, æˆ‘ä»¬æœç´¢ <code>&#39;[</code>, å¯ä»¥æ‰¾åˆ° <code>_iterencode_list</code> è¿™ä¸ªå‡½æ•°, å¤§æ¦‚çœ‹ä¸€çœ¼å°±çŸ¥é“æ€ä¹ˆæ”¹äº†:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_iterencode_list</span><span class="params">(lst, _current_indent_level)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> lst:</span><br><span class="line">        <span class="keyword">yield</span> <span class="string">'&#123;&#125;'</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    ...</span><br><span class="line">    buf = <span class="string">'&#123;'</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'&#125;'</span></span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¿®æ”¹å®Œ, è¿è¡Œ <code>python test.py</code> çœ‹ä¸‹æ•ˆæœ:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"2"</span>: <span class="number">2</span>, </span><br><span class="line">  <span class="string">"3a"</span>: <span class="number">3</span>, </span><br><span class="line">  <span class="string">"4"</span>: &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="string">"a"</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯å·²ç»æœ‰ç‚¹æ„æ€äº†? æˆ‘ä»¬å†æ¥å†å‰, æ‰¾æ‰¾ç¬¬äºŒä¸ªé—®é¢˜å¦‚ä½•è§£å†³. æˆ‘ä»¬æœç´¢ <code>&#39;:</code> å¯ä»¥æ‰¾åˆ°è¿™è¡Œä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key_separator = <span class="string">': '</span></span><br></pre></td></tr></table></figure><p>å°† <code>&#39;: &#39;</code> ä¿®æ”¹ä¸º <code>&#39; = &#39;</code> å°±å¯ä»¥å•¦, æˆ‘ä»¬çœ‹ä¸‹ç»“æœ:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"2"</span> = <span class="number">2</span>, </span><br><span class="line">  <span class="string">"3a"</span> = <span class="number">3</span>, </span><br><span class="line">  <span class="string">"4"</span> = &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="string">"a"</span> = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆç¬¬ä¸‰ä¸ªé—®é¢˜è¯¥å¦‚ä½•å…¥æ‰‹å‘¢? ç»™ç«¥é‹ä»¬ä¸‰ç§’é’Ÿçš„æ€è€ƒæ—¶é—´. </p><blockquote><p>3s</p><p>2s</p><p>1s</p></blockquote><p>æ­æ™“ç­”æ¡ˆ, æ—¢ç„¶ <code>key_separator</code> æ˜¯åˆ†éš” key, value çš„, æˆ‘ä»¬æ‰¾æ‰¾å“ªé‡Œç”¨åˆ° key_separator æ˜¯ä¸æ˜¯å‘ç°ç‚¹ä»€ä¹ˆå‘¢ ? å¾ˆå¿«æˆ‘ä»¬èƒ½å®šä½åˆ° <code>_iterencode_dict</code> å‡½æ•°çš„è¿™è¡Œä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">yield</span> _encoder(key)</span><br><span class="line"><span class="keyword">yield</span> _key_separator</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª <code>_encoder(key)</code> ä¼šä¸ä¼šå¯¹åº” key çš„ç”Ÿæˆå‘¢? æˆ‘ä»¬ä¿®æ”¹ä¸‹è¯•è¯•, å°†è¿™å¥è¯æ›¿æ¢ä¸º:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">yield</span> <span class="string">'['</span> + _encoder(key) + <span class="string">']'</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œ, ç»“æœå¦‚ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  [<span class="string">"2"</span>] = <span class="number">2</span>, </span><br><span class="line">  [<span class="string">"3a"</span>] = <span class="number">3</span>, </span><br><span class="line">  [<span class="string">"4"</span>] = &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  [<span class="string">"a"</span>] = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“å‘€, æˆ‘è¿™æ˜¯æå®šäº†å—? éªšå¹´, æ­å–œä½ , ä½ å·²ç»å®Œæˆäº† 99% çš„å·¥ä½œäº†, è¿™æ®µä»£ç çš„æœ€å‰æ–¹è¿˜å°‘ä¸€ä¸ª <code>return</code> , æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ˜“çš„åŠ ä¸Š. æˆ‘é€šè¿‡ä¿®æ”¹ <code>test.py</code> å®ç°äº†è¿™ä¸ªåŠŸèƒ½:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f.write(lua.dumps(data, ensure_ascii=False, indent=2, sort_keys=True))</span><br><span class="line"># ä¿®æ”¹ä¸º:</span><br><span class="line">f.write(&quot;return &quot; + lua.dumps(data, ensure_ascii=False, indent=2, sort_keys=True))</span><br></pre></td></tr></table></figure><p>ç»“æœ:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  [<span class="string">"2"</span>] = <span class="number">2</span>, </span><br><span class="line">  [<span class="string">"3a"</span>] = <span class="number">3</span>, </span><br><span class="line">  [<span class="string">"4"</span>] = &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  [<span class="string">"a"</span>] = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-æ›´åŠ -lua-åŒ–"><a href="#3-æ›´åŠ -lua-åŒ–" class="headerlink" title="3. æ›´åŠ  lua åŒ–"></a>3. æ›´åŠ  lua åŒ–</h2><p>ä¸Šé¢ç”Ÿæˆçš„ <code>test.lua</code> å…¶å®å¾ˆä¸ Lua, å¤§å®¶ä¸ä¼šå†™å‡º <code>[&quot;a&quot;] = 1</code> è¿™ç§ç±»å‹çš„è¯­å¥, è€Œæ˜¯ç›´æ¥ <code>a = 1</code>. </p><p>è¿™ä¸ªé—®é¢˜å‘ç”Ÿåœ¨äº†ä¸Šé¢çš„ç¬¬ä¸‰æ­¥ä¸Š, æˆ‘ä»¬å·æ‡’ç›´æ¥å†™å‡ºäº†è¿™æ ·çš„ä»£ç :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">yield</span> <span class="string">'['</span> + _encoder(key) + <span class="string">']'</span></span><br></pre></td></tr></table></figure><p>å¤§å®¶ä¸å¦¨çœ‹çœ‹ <code>_encoder</code> è¿™ä¸ªå‡½æ•°, å®ƒä¼šæŠŠä»»æ„ç±»å‹è½¬åŒ–ä¸ºå­—ç¬¦ä¸², ä¸¤ç«¯åŠ ä¸Š <code>&quot;</code>. é‚£ä¹ˆ Lua åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼š <code>[&quot;x&quot;]</code> è¿™ç§ç±»å‹çš„ key å‘¢?</p><ol><li>å…³é”®å­—, å¦‚: <code>require</code>, <code>false</code> ç­‰, æˆ‘ä»¬å¯ä»¥åœ¨<a href="https://www.lua.org/manual/5.1/manual.html#2.1" target="_blank" rel="noopener">è¿™é‡Œ</a>æ‰¾åˆ°æ‰€æœ‰çš„å…³é”®å­—.</li><li>ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸².</li><li>æ•°å­—, åŒ…æ‹¬ <code>int</code>, <code>lang</code>, <code>float</code>.</li><li>å«æœ‰å¥‡æ€ªå­—ç¬¦çš„å­—ç¬¦ä¸², å¦‚: <code>-</code>, <code>*</code> ç­‰, éå¥‡æ€ªå­—ç¬¦åªæœ‰: <code>[a-zA-Z_0-9]</code>.</li></ol><p>çŸ¥é“äº†è§„åˆ™, æˆ‘ä»¬å°±å¾ˆå¥½åŠäº†, å†™ä¸€ä¸ªè§£æå‡½æ•°å°±å¥½äº†å˜›:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">key_filter = re.compile(<span class="string">"[^a-zA-Z_0-9]"</span>)</span><br><span class="line">key_filter_equal = &#123;<span class="string">"require"</span>,<span class="string">"false"</span>,<span class="string">"for"</span>,<span class="string">"function"</span>,<span class="string">"if"</span>,<span class="string">"nil"</span>,<span class="string">"not"</span>,<span class="string">"or"</span>,<span class="string">"while"</span>,<span class="string">"then"</span>,<span class="string">"true"</span>,<span class="string">"until"</span>,<span class="string">"end"</span>,<span class="string">"in"</span>,<span class="string">"local"</span>,<span class="string">"repeat"</span>,<span class="string">"return"</span>,<span class="string">"break"</span>,<span class="string">"do"</span>,<span class="string">"else"</span>,<span class="string">"and"</span>,<span class="string">"elseif"</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_key</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(s, (int, long, float)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'['</span>+str(s)+<span class="string">']'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        int(s)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'["'</span>+s+<span class="string">'"]'</span></span><br><span class="line">    <span class="keyword">except</span> Exception, e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> key_filter_equal:</span><br><span class="line">        <span class="keyword">if</span> s == f:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'["'</span>+s+<span class="string">'"]'</span></span><br><span class="line">    <span class="keyword">if</span> (ord(s[<span class="number">0</span>]) &gt;= ord(<span class="string">"0"</span>) <span class="keyword">and</span> ord(s[<span class="number">0</span>]) &lt;= ord(<span class="string">"9"</span>)) <span class="keyword">or</span> key_filter.search(s):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'["'</span>+s+<span class="string">'"]'</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠ <code>yield &#39;[&#39; + _encoder(key) + &#39;]&#39;</code> æ›¿æ¢ä¸º <code>yield format_key(key)</code> å°±æå®šäº†. æˆ‘ä»¬çœ‹ä¸‹ç”Ÿæˆçš„ç»“æœ:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  [<span class="string">"2"</span>] = <span class="number">2</span>, </span><br><span class="line">  [<span class="string">"3a"</span>] = <span class="number">3</span>, </span><br><span class="line">  [<span class="string">"4"</span>] = &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  a = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½åƒä¸å¤ªå¯¹å˜›, éª—çº¸, æ•°å­—çš„ key è¿˜æ˜¯æœ‰é—®é¢˜çš„. ä¸è¦æ…Œ, æˆ‘ä»¬é¡ºç€ <code>format_key</code> è°ƒç”¨çš„åœ°æ–¹å‘ä¸Šæ‰¾æ‰¾, å‘ç°é—®é¢˜äº†å§:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> isinstance(key, float):</span><br><span class="line">    key = _floatstr(key)</span><br><span class="line"><span class="keyword">elif</span> key <span class="keyword">is</span> <span class="keyword">True</span>:</span><br><span class="line">    key = <span class="string">'true'</span></span><br><span class="line"><span class="keyword">elif</span> key <span class="keyword">is</span> <span class="keyword">False</span>:</span><br><span class="line">    key = <span class="string">'false'</span></span><br><span class="line"><span class="keyword">elif</span> key <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">    key = <span class="string">'null'</span></span><br><span class="line"><span class="keyword">elif</span> isinstance(key, (int, long)):</span><br><span class="line">    key = str(key)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå·²ç»å¯¹ <code>float</code>, <code>int</code>, <code>lang</code> ç±»å‹åšè¿‡è½¬åŒ–äº†, æˆ‘ä»¬æŠŠ elif ä¸­çš„å†…å®¹æ¢æˆ <code>pass</code> å†è¯•ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  [<span class="number">2</span>] = <span class="number">2</span>, </span><br><span class="line">  [<span class="string">"3a"</span>] = <span class="number">3</span>, </span><br><span class="line">  [<span class="string">"4"</span>] = &#123;</span><br><span class="line">    <span class="number">1</span>, </span><br><span class="line">    <span class="number">2</span>, </span><br><span class="line">    <span class="string">"a"</span>, </span><br><span class="line">    <span class="literal">false</span></span><br><span class="line">  &#125;, </span><br><span class="line">  a = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“ˆå“ˆ, æå®šäº†! æˆ‘å¤ªæ£’äº†! å’¦, çº³å°¼, Are you kidding me ? ä¸ºä»€ä¹ˆåªæœ‰ <code>2</code> æ˜¯ ok çš„, <code>&quot;4&quot;</code> æ˜¯æ€ä¹ˆå›äº‹å˜› ? ä»”ç»†æ£€æŸ¥äº†ä¸€ç•ªä»£ç , æœ‰åšäº†ä¸€ä¸ªé¢å¤–çš„ä¿®æ”¹, è¿˜æ˜¯æ²¡æœ‰å‘ç°åŸå› .</p><p>å½“æˆ‘æŠŠç›®å…‰è½¬å‘æˆ‘ä»¬çš„æµ‹è¯•ä»£ç çš„æ—¶å€™, æˆ‘çœ‹åˆ°çš„ç­”æ¡ˆ:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"a"</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="number">2</span>,</span><br><span class="line">    <span class="string">"3a"</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">"4"</span>:[</span><br><span class="line">        <span class="number">1</span>,<span class="number">2</span>,<span class="string">"a"</span>,<span class="keyword">False</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„ <code>&quot;4&quot;</code> æœ¬èº«å°±æ˜¯ string ç±»å‹çš„, è¿™æ ·æ›´åŠ è¯´æ˜äº†æˆ‘ä»¬ä»£ç çš„æ­£ç¡®æ€§.</p><hr><p>åˆ°æ­¤ä¸ºæ­¢, æˆ‘ä»¬çš„é­”æ”¹ä¹‹æ—…å°±ç»“æŸäº†, æˆ‘æŠŠæœ€ç»ˆç‰ˆçš„ä»£ç æ”¾åˆ°äº† <a href="https://gist.github.com/justbilt/a5cfafe761b8571e7b5a9e7c22cc7c57" target="_blank" rel="noopener">Gist ä¸Š</a>, å¤§å®¶å¦‚æœæœ‰å…´è¶£çš„è¯å¯ä»¥çœ‹ä¸€ä¸‹.</p><h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•:"></a>é™„å½•:</h1><p>ä¸€ä¸ª 24W è¡Œçš„ json å’Œ Lua è¯»å–æ—¶é—´:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">time1 = <span class="built_in">os</span>.<span class="built_in">clock</span>()</span><br><span class="line">data = <span class="built_in">require</span>(<span class="string">"filters"</span>)</span><br><span class="line">time2 = <span class="built_in">os</span>.<span class="built_in">clock</span>()</span><br><span class="line">data2 = json.decode(<span class="built_in">io</span>.readfile(cc.FileUtils:getInstance():fullPathForFilename((<span class="string">"res/filters.json"</span>))))</span><br><span class="line">time3 = <span class="built_in">os</span>.<span class="built_in">clock</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"time lua:"</span>, time2 - time1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"time json:"</span>, time3 - time2)</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">time lua:   0.278526</span><br><span class="line">time json:  0.182085</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ä»¬å›¢é˜Ÿçš„æŠ€æœ¯æ ˆæ˜¯: &lt;code&gt;Lua + Python&lt;/code&gt;, å‰ç«¯é‡‡ç”¨ Lua å†™é¡¹ç›®, Python åšå·¥å…·æ”¯æŒ, è€Œåç«¯åˆ™é‡‡ç”¨çº¯ Python å¼€å‘, æ‰€ä»¥ä¼šç»å¸¸é‡åˆ° Python å’Œ Lua æ•°æ®çš„è½¬åŒ–.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Lua" scheme="http://blog.justbilt.com/tags/Lua/"/>
    
      <category term="Python" scheme="http://blog.justbilt.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>æ‰‹æ’¸ä¸€ä¸ªåƒã€Šä¹±ä¸–ç‹è€…ã€‹é‚£æ ·çš„ WebView</title>
    <link href="http://blog.justbilt.com/2017/08/25/webview-like-lswz/"/>
    <id>http://blog.justbilt.com/2017/08/25/webview-like-lswz/</id>
    <published>2017-08-24T16:45:08.000Z</published>
    <updated>2017-08-31T23:55:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤©ç¾æ–°æ¸¸æˆã€Šä¹±ä¸–ç‹è€…ã€‹å‡ºäº†ä¹‹å, æˆ‘ç©äº†ä¸€é˜µå­, è¿™ä¸ªæ¸¸æˆçš„ç²¾ç¾ç¨‹åº¦åˆ·æ–°äº†æˆ‘å¯¹ slg æ¸¸æˆçš„è®¤è¯†, æ¯”å®ƒçš„æ¨¡å‹äº§å“ã€Šåˆ—ç‹çš„çº·äº‰ã€‹ç»™æˆ‘å¸¦æ¥çš„éœ‡æ’¼è¿˜è¦å¤§. ä¸ä»…ä»…æ˜¯åœ¨ç¾æœ¯æ–¹é¢, æ›´å¤šçš„æ˜¯åœ¨äº§å“å’Œå¯¹ç»†èŠ‚çš„å¤„ç†ä¸Š. </p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fj3pcpg3k8j31kw0xw4qp.jpg" alt=""></p><a id="more"></a><p>åœ¨æ¸¸æˆä¸­æ›´å¤šç•Œé¢ä¸­æœ‰å‡ ä¸ªæŒ‰é’®, ç‚¹å‡»åä¼šè·³è½¬åˆ° WebView, å¦‚ä¸‹å›¾:</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fj3pou45vcj30af0ijn2s.jpg" alt=""></p><p>è¿™ä¸ª WebView åšå¾—å¾ˆä¸é”™å‘€, æ¯” Cocos è‡ªå¸¦çš„å…‰ç§ƒç§ƒçš„ WebView å¥½æ•°å€, æœ¬ç€ä»(hou)å–„(yan)å¦‚(wu)æµ(chi)çš„äººç”Ÿå“²ç†, ä¾¿å¼€å§‹æ€ç´¢ç€æ˜¯ä¸æ˜¯æåˆ°æˆ‘ä»¬çš„æ¸¸æˆä¸­å»? </p><p>é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•å®ç°çš„å‘¢? æ ¹æ®å¤šå¹´ç»éªŒ, ä»èµ„æºå…¥æ‰‹æ˜¯æœ€ç®€å•çš„åŠæ³•äº†, æ‹†å¼€ä¹±ä¸–ç‹è€…çš„ Android åŒ…, åœ¨ res æ–‡ä»¶å¤¹ä¸­æœç´¢ png, æˆ‘ä»¬å¾ˆå®¹æ˜“çš„å‘ç°ä¸‹é¢è¿™äº›èµ„æº:</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fixluudqm1j30yo0jcn3g.jpg" alt=""></p><p>å‘½åéƒ½æ˜¯ç±»ä¼¼: <code>com_tencent_msdk_webview_left_unclickable.png</code>, çœ‹æ¥æ˜¯ <code>msdk</code> é‡Œé¢çš„ä¸€ä¸ªç»„ä»¶, æˆ‘ä»¬æ²¡æœ‰æ¥å…¥ msdk çš„è®¡åˆ’, æ‰€ä»¥æ²¡æœ‰åŠæ³•ç›´æ¥è°ƒç”¨äº†. è®©æˆ‘ä»¬æ¥åˆ†æä¸‹è¿™ä¸ªç•Œé¢:</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fiy0x704zhj309h0dzmxd.jpg" alt=""></p><p>Cocos é»˜è®¤æä¾›çš„ WebView åªæœ‰ä¸­é—´éƒ¨åˆ†, ä¸Šä¸‹æ˜¯æ²¡æœ‰çš„. è¿™ä¸¤éƒ¨åˆ†åº”è¯¥æ˜¯ç”¨ Android å†™çš„åŸç”Ÿç•Œé¢, ä½†æ˜¯æˆ‘å¯¹ Android ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£, å†™å‡ºæ¥ä¼°è®¡éƒ½æ˜¯ bug, è¿˜æ²¡æœ‰åŠæ³•çƒ­æ›´æ–°. </p><p>çœ‹ç€æ»¡åœ°çš„èµ„æº, æˆ‘ä¸ç¦é™·å…¥äº†æ·±æ€. æœ‰äº†, æ˜¯ä¸æ˜¯åªåˆ›å»ºå‡ºä¸­é—´å°ºå¯¸å¤§å°çš„ Webview, ç„¶åç”¨è¿™äº›å›¾ç‰‡åœ¨ Cocos ä¸­ç»˜åˆ¶å‡ºæ ‡é¢˜æ å’Œå·¥å…·æ , èœå•å’Œ WebView çš„äº¤äº’å¯ä»¥ç”¨ WebView æä¾›çš„ api æ¥æ. </p><p>ç²—ç•¥çœ‹äº†ä¸‹ WebView æä¾›çš„ api:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">canGoBack</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">goBack</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">canGoForward</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">goForward</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reload</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>åœ¨åŠ ä¸Š <code>removeFromParent</code>, ä¸‹æ–¹çš„å·¥å…·æ æ˜¯æ²¡æœ‰é—®é¢˜äº†. æˆ‘ä»¬ ui ç¼–è¾‘å™¨ä½¿ç”¨çš„æ˜¯ Cocos Builder, æˆ‘å¾ˆå¿«æ‹¼å‡ºäº†æ•ˆæœ:</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fj110v95r4j31kw1f9127.jpg" alt=""></p><p>ä¸‹é¢ä¾¿æ˜¯åœ¨ä»£ç ä¸­æ’¸è¿™å‡ ä¸ªèœå•çš„é€»è¾‘äº†, è¿™éƒ¨åˆ†è¿˜æ˜¯æŒºéº»çƒ¦çš„, åªè¦ç»†å¿ƒä¸€äº›, å¾ˆå¿«ä¹Ÿèƒ½æå®š:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">-- Author: wangbilt@gmail.com</span></span><br><span class="line"><span class="comment">-- Date: 2017-08-21 11:26:18</span></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">local</span> PageFullscreenWebview = class(<span class="string">"PageFullscreenWebview"</span>, <span class="built_in">require</span>(<span class="string">"app.layout.package.page_fullscreen_webview_layout"</span>))</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:ctor</span><span class="params">()</span></span></span><br><span class="line">    PageFullscreenWebview.super.ctor(self)</span><br><span class="line">    self:_disableToolBar()</span><br><span class="line">    self.webview = ccexp.WebView:<span class="built_in">create</span>()</span><br><span class="line">    self.webview:setAnchorPoint(cc.p(<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    self.webview:setScalesPageToFit(<span class="literal">false</span>)</span><br><span class="line">    self.webview:setContentSize(cc.size(display.width, display.height - self._nodeToolBar:getContentSize().height))</span><br><span class="line">    self.webview:setPosition(<span class="number">0</span>, self._nodeToolBar:getContentSize().height)</span><br><span class="line">    self.webview:setOnDidFinishLoading(<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        self:performWithDelay(handler(self,self._loadFinishCallBack), <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">end</span>)    </span><br><span class="line">    self:addChild(self.webview)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:loadURL</span><span class="params">(_url, _callback)</span></span></span><br><span class="line">    self.webview:loadURL(_url)</span><br><span class="line">    self.on_finish_callback = _callback</span><br><span class="line">    self._btnRefresh:setVisible(<span class="literal">false</span>)</span><br><span class="line">    self._btnLeft:setButtonEnabled(<span class="literal">false</span>)</span><br><span class="line">    self._btnRight:setButtonEnabled(<span class="literal">false</span>)    </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:_disableToolBar</span><span class="params">()</span></span></span><br><span class="line">    self._btnLeft:setButtonEnabled(<span class="literal">false</span>)</span><br><span class="line">    self._btnRight:setButtonEnabled(<span class="literal">false</span>)</span><br><span class="line">    self._btnRefresh:setVisible(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:_loadFinishCallBack</span><span class="params">(...)</span></span></span><br><span class="line">    self._btnRefresh:setVisible(<span class="literal">true</span>)</span><br><span class="line">    self._btnLeft:setButtonEnabled(self.webview:canGoBack())</span><br><span class="line">    self._btnRight:setButtonEnabled(self.webview:canGoForward())</span><br><span class="line">    <span class="keyword">if</span> self.on_finish_callback <span class="keyword">then</span></span><br><span class="line">        self.on_finish_callback()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:onClose</span><span class="params">(_callback)</span></span></span><br><span class="line">    self.on_close_callback = _callback</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:onClickClose</span><span class="params">(_params)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"onClickClose"</span>,_params.tag, _params.target)</span><br><span class="line">    self.on_close_callback()</span><br><span class="line">    self:removeFromParent()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:onClickLeft</span><span class="params">(_params)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"onClickLeft:"</span>,_params.tag, _params.target)</span><br><span class="line">    self:_disableToolBar()</span><br><span class="line">    self.webview:goBack()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:onClickRefresh</span><span class="params">(_params)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"onClickRefresh:"</span>,_params.tag, _params.target)</span><br><span class="line">    self:_disableToolBar()</span><br><span class="line">    self.webview:reload()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:onClickRight</span><span class="params">(_params)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"onClickRight:"</span>,_params.tag, _params.target)</span><br><span class="line">    self:_disableToolBar()</span><br><span class="line">    self.webview:goForward()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PageFullscreenWebview:show</span><span class="params">()</span></span></span><br><span class="line">    display.getRunningScene():addChild(self, <span class="number">10000</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">return</span> PageFullscreenWebview</span><br></pre></td></tr></table></figure><p>çœ‹çœ‹å®é™…çš„æ•ˆæœ:</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fj11145fcrj30f00qoab6.jpg" alt=""></p><blockquote><p>Ps. åœ¨è¿™ä¹‹é—´è¿˜é‡åˆ°äº†ä¸€ä¸ªbug, å°±æ˜¯åœ¨ WebView å‡ºç°çš„æ—¶å€™æŒ‰ back é”®ä¼šå´©æºƒ, æœ€ç»ˆé‡å†™ Avtivity ä¸€ä¸ªç©ºçš„ <code>onBackPressed</code> å®ç°è§£å†³é—®é¢˜.</p></blockquote><p>æ˜¯ä¸æ˜¯è¶³ä»¥ä»¥å‡ä¹±çœŸäº†å‘¢ ? ä¸è¦é«˜å…´å¤ªæ—©, è¿˜æœ‰æ ‡é¢˜,è¿›åº¦æ¡åŠŸèƒ½æ²¡æœ‰å®ç°å‘¢. è®©æˆ‘ä»¬æ¥åˆ†æä¸‹è¿™å‡ ä¸ªåŠŸèƒ½:</p><h2 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h2><p>çœ‹äº†ä¸‹ Cocos æä¾›çš„ API, æ˜¯æ²¡æœ‰ä¸æ ‡é¢˜ç›¸å…³çš„, åªèƒ½æˆ‘ä»¬è‡ªå·±å»ç»‘å®š. é‚£ä¹ˆè¯¥å¦‚ä½•è·å–æ ‡é¢˜å‘¢?</p><h3 id="Android"><a href="#Android" class="headerlink" title="Android:"></a>Android:</h3><p>åœ¨ <a href="https://ws4.sinaimg.cn/large/006tNc79ly1fj11145fcrj30f00qoab6.jpg" target="_blank" rel="noopener">stackoverflow çš„è¿™ä¸ªç­”æ¡ˆ</a> ä¸­æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WebView mWebView = (WebView) findViewById(R.id.mwebview);</span><br><span class="line">mWebView.setWebViewClient(<span class="keyword">new</span> WebViewClient() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageFinished</span><span class="params">(WebView view, String url)</span> </span>&#123;</span><br><span class="line">        ExperimentingActivity.<span class="keyword">this</span>.setTitle(view.getTitle());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">webview.setWebChromeClient(<span class="keyword">new</span> WebChromeClient() &#123;</span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceivedTitle</span><span class="params">(WebView view, String title)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">super</span>.onReceivedTitle(view, title);  </span><br><span class="line">    &#125; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="iOS"><a href="#iOS" class="headerlink" title="iOS:"></a>iOS:</h3><p>åŒæ ·, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„æ‰¾åˆ° iOS çš„<a href="https://stackoverflow.com/a/20059707" target="_blank" rel="noopener">è§£å†³æ–¹æ¡ˆ</a>:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webViewDidFinishLoad:(<span class="built_in">UIWebView</span> *)webView&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *theTitle=[webView stringByEvaluatingJavaScriptFromString:<span class="string">@"document.title"</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰äº†ä¸Šé¢ä»£ç å, æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°è·å–æ ‡é¢˜çš„ä»£ç , æ¯”è¾ƒéº»çƒ¦çš„æ˜¯è¿˜éœ€è¦ä¿®æ”¹ WebView çš„ c++ éƒ¨åˆ†, å¦‚æœæœ€ç»ˆè¦åœ¨ Lua ä¸­ä½¿ç”¨çš„è¯è¿˜éœ€è¦å¯¼å‡ºæ¥å£.</p><h2 id="è¿›åº¦æ¡"><a href="#è¿›åº¦æ¡" class="headerlink" title="è¿›åº¦æ¡"></a>è¿›åº¦æ¡</h2><h3 id="Android-1"><a href="#Android-1" class="headerlink" title="Android:"></a>Android:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">webview.setWebChromeClient(<span class="keyword">new</span> WebChromeClient() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgressChanged</span><span class="params">(WebView view, <span class="keyword">int</span> progress)</span>   </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="iOS-1"><a href="#iOS-1" class="headerlink" title="iOS"></a>iOS</h3><p>iOS æˆ‘æ‰¾äº†å¾ˆä¹…, è²Œä¼¼æ˜¯æ²¡æœ‰åŠæ³•è·å–è¿›åº¦çš„, åªèƒ½åšä¸€ä¸ªå‡çš„æ•ˆæœ:</p><blockquote><p>åœ¨å¼€å§‹åŠ è½½ç½‘é¡µçš„æ—¶å€™å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨, è®©è¿›åº¦æ¡ä»¥ä¸€ä¸ªç¼“æ…¢çš„é€Ÿåº¦å‰è¿›, æ”¶åˆ°åŠ è½½å®Œæˆçš„æ¶ˆæ¯æ—¶è®©è¿›åº¦æ¡ç¬é—´ç§»åŠ¨åˆ°ç»ˆç‚¹.</p></blockquote><p>æ‰€ä»¥, æˆ‘ä»¬å¯ä»¥åˆ†å¹³å°å®ç°, ä¹Ÿå¯ä»¥ç»Ÿä¸€ä»£ç , éƒ½ä½¿ç”¨å‡çš„è¿›åº¦æ¡.</p><hr><p>ç»è¿‡ä¸ PM çš„ä¸€ç•ªäº¤æµå, ä¸€è‡´åŒæ„æ”¾å¼ƒè¿™ä¸¤ä¸ªåŠŸèƒ½. å› ä¸ºè§‰å¾—ç›®å‰çš„æ•ˆæœè¿˜å¯ä»¥, åŠ ä¸Šä¸æ”¹åŠ¨ c++ å°±å¯ä»¥çƒ­æ›´æ–°ä¸Šå».</p><p>æ‰€ä»¥å¾ˆå¯æƒœ, è¿™æ¬¡æ²¡æœ‰åŠæ³•æå½»åº•äº†, ä¸‹æ¬¡æœ‰æœºä¼šæˆ‘ä»¬æ¥ç€æ.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤©ç¾æ–°æ¸¸æˆã€Šä¹±ä¸–ç‹è€…ã€‹å‡ºäº†ä¹‹å, æˆ‘ç©äº†ä¸€é˜µå­, è¿™ä¸ªæ¸¸æˆçš„ç²¾ç¾ç¨‹åº¦åˆ·æ–°äº†æˆ‘å¯¹ slg æ¸¸æˆçš„è®¤è¯†, æ¯”å®ƒçš„æ¨¡å‹äº§å“ã€Šåˆ—ç‹çš„çº·äº‰ã€‹ç»™æˆ‘å¸¦æ¥çš„éœ‡æ’¼è¿˜è¦å¤§. ä¸ä»…ä»…æ˜¯åœ¨ç¾æœ¯æ–¹é¢, æ›´å¤šçš„æ˜¯åœ¨äº§å“å’Œå¯¹ç»†èŠ‚çš„å¤„ç†ä¸Š. &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/006tNc79ly1fj3pcpg3k8j31kw0xw4qp.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
      <category term="WebView" scheme="http://blog.justbilt.com/tags/WebView/"/>
    
  </entry>
  
  <entry>
    <title>èŠèŠ Google æ”¯ä»˜çš„é‚£äº›äº‹</title>
    <link href="http://blog.justbilt.com/2017/07/23/integrate-google-iab/"/>
    <id>http://blog.justbilt.com/2017/07/23/integrate-google-iab/</id>
    <published>2017-07-23T02:20:07.000Z</published>
    <updated>2017-08-24T16:39:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­, æœ‰å¾ˆå¤šç¯‡éƒ½æ˜¯å¾ˆ Apple IAP ç›¸å…³çš„, è€Œ Google IAB çš„å´ä¸€ç¯‡éƒ½æ²¡æœ‰, è¿™å¯¹äºå äº†åŠå£æ±Ÿå±±çš„ Android å¾ˆä¸å…¬å¹³.</p><p>å°±ä½œä¸ºä¸€ä¸ªå¼€å‘è€…è€Œè¨€, IAB çš„ä½“éªŒæ˜¯æ¯” IAP è¦å¥½çš„. å®ƒä½“ç°åœ¨è¿™ä¹ˆå‡ ä¸ªæ–¹é¢:</p><ol><li>æµ‹è¯•è´¦å·å°±æ˜¯ Goolge è´¦å·, ä¸åƒè‹¹æœé‚£æ ·æ˜¯æ²™ç›’è´¦å·. è¿™æ ·ä¸åŒè´¦å·ä¸‹çš„åº”ç”¨å¯ä»¥è®¾ç½®åŒä¸€ä¸ªæµ‹è¯•è´¦å·, é¿å…æ¥å›åˆ‡æ¢è´¦å·.</li><li>æ”¯æŒé€€æ¬¾æŸ¥è¯¢. åœ¨è‹¹æœä¸Š, åªèƒ½åƒäº†è¿™ä¸ªå“‘å·´äº.</li></ol><p>ä½†æ˜¯ IAB ä¹Ÿæœ‰ä¸€äº›ä¸å¤ªä¾¿åˆ©çš„åœ°æ–¹, åé¢æˆ‘ä»¬ä¼šè®¨è®ºå®ƒ.</p><a id="more"></a><h1 id="ä¸€-é›†æˆ"><a href="#ä¸€-é›†æˆ" class="headerlink" title="ä¸€. é›†æˆ"></a>ä¸€. é›†æˆ</h1><p>IAB æœ¬èº«æä¾›äº†ä¸€äº›åˆ—çš„ <a href="https://developer.android.com/google/play/billing/billing_reference.html" target="_blank" rel="noopener">API</a> å»å®ç°è´­ä¹°, ä¸€æ¬¡å…¸å‹çš„è´­ä¹°æµç¨‹æ˜¯è¿™ä¸ªæ ·å­çš„:</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fhtste5cqlj30fn0fkta9.jpg" alt=""></p><p>è¿™é‡Œé¢æœ‰ä¸€äº›ç»†èŠ‚æˆ‘ä»¬å…¶å®æ˜¯å¯ä»¥ä¸ç”¨çŸ¥é“çš„, æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªäºŒæ¬¡å°è£…çš„åº“<a href="https://github.com/anjlab/android-inapp-billing-v3" target="_blank" rel="noopener">android-inapp-billing-v3</a>å»å®ç°. ä½¿ç”¨äº†è¿™ä¸ªåº“å, å®ç°å†…è´­å˜å¾—å¾ˆç®€å•:</p><h2 id="1-æ·»åŠ ç›‘å¬"><a href="#1-æ·»åŠ ç›‘å¬" class="headerlink" title="1. æ·»åŠ ç›‘å¬"></a>1. æ·»åŠ ç›‘å¬</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">    bp = <span class="keyword">new</span> BillingProcessor(context, <span class="string">"IAB_LICENSE_KEY"</span>, <span class="keyword">new</span> BillingProcessor.IBillingHandler() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProductPurchased</span><span class="params">(String productId, TransactionDetails details)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// è´­ä¹°æˆåŠŸ</span></span><br><span class="line">            Log.d(<span class="string">"message:"</span>, details.purchaseInfo.responseData);</span><br><span class="line">            Log.d(<span class="string">"signature:"</span>, details.purchaseInfo.signature);</span><br><span class="line">            Log.d(<span class="string">"productid:"</span>, productId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBillingError</span><span class="params">(<span class="keyword">int</span> errorCode, Throwable error)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (errorCode == Constants.BILLING_RESPONSE_RESULT_USER_CANCELED)&#123;</span><br><span class="line">                <span class="comment">// è´­ä¹°å–æ¶ˆ</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String reason = <span class="string">"UNKNOWN_ERROR"</span>;</span><br><span class="line">            <span class="keyword">if</span> (mErrorCodeReason.containsKey(errorCode)) &#123;</span><br><span class="line">                reason = mErrorCodeReason.get(errorCode);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è´­ä¹°å¤±è´¥</span></span><br><span class="line">            Log.d(<span class="string">"buy failure: "</span>, reason);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBillingInitialized</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">// åˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPurchaseHistoryRestored</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="comment">// æ¢å¤å†…è´­</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-å¤„ç†è´­ä¹°ç»“æœ"><a href="#2-å¤„ç†è´­ä¹°ç»“æœ" class="headerlink" title="2. å¤„ç†è´­ä¹°ç»“æœ"></a>2. å¤„ç†è´­ä¹°ç»“æœ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, data);</span><br><span class="line">    <span class="keyword">return</span> bp.handleActivityResult(requestCode, resultCode, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-è´­ä¹°å•†å“"><a href="#3-è´­ä¹°å•†å“" class="headerlink" title="3. è´­ä¹°å•†å“"></a>3. è´­ä¹°å•†å“</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bp.purchase(<span class="keyword">this</span>, <span class="string">"android.test.purchased"</span>);</span><br></pre></td></tr></table></figure><h2 id="4-æ¶ˆè€—å•†å“"><a href="#4-æ¶ˆè€—å•†å“" class="headerlink" title="4. æ¶ˆè€—å•†å“"></a>4. æ¶ˆè€—å•†å“</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bp.consumePurchase(productId);</span><br></pre></td></tr></table></figure><h1 id="äºŒ-æµ‹è¯•"><a href="#äºŒ-æµ‹è¯•" class="headerlink" title="äºŒ. æµ‹è¯•"></a>äºŒ. æµ‹è¯•</h1><h2 id="1-ä½¿ç”¨é™æ€å“åº”è¿›è¡Œæµ‹è¯•"><a href="#1-ä½¿ç”¨é™æ€å“åº”è¿›è¡Œæµ‹è¯•" class="headerlink" title="1. ä½¿ç”¨é™æ€å“åº”è¿›è¡Œæµ‹è¯•"></a>1. ä½¿ç”¨é™æ€å“åº”è¿›è¡Œæµ‹è¯•</h2><p>IAB é»˜è®¤æä¾›äº†ä¸€ç³»åˆ—çš„å•†å“ä½œä¸ºæµ‹è¯•å•†å“, è¿™äº›å•†å“å’Œåº”ç”¨åŠå•†å“æ— å…³, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›å•†å“æ¥æµ‹è¯•å……å€¼åŠŸèƒ½æ˜¯å¦é›†æˆæˆåŠŸå’ŒæœåŠ¡å™¨ç­¾åéªŒè¯æ˜¯å¦æ­£ç¡®.</p><p>è¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://developer.android.com/google/play/billing/billing_testing.html#billing-testing-static" target="_blank" rel="noopener">è¿™ç¯‡ Google å®˜æ–¹æ–‡æ¡£</a>.</p><h2 id="2-ä½¿ç”¨çœŸå®äº¤æ˜“è¿›è¡Œæµ‹è¯•"><a href="#2-ä½¿ç”¨çœŸå®äº¤æ˜“è¿›è¡Œæµ‹è¯•" class="headerlink" title="2. ä½¿ç”¨çœŸå®äº¤æ˜“è¿›è¡Œæµ‹è¯•"></a>2. ä½¿ç”¨çœŸå®äº¤æ˜“è¿›è¡Œæµ‹è¯•</h2><p>åœ¨é¡¹ç›®ä¸Šçº¿å‰, æˆ‘ä»¬éœ€è¦æµ‹è¯•ä¸‹åº”ç”¨å†…çš„å•†å“å¤„ç†æ˜¯å¦æ­£å¸¸, æ‰€ä»¥è¦ä½¿ç”¨çœŸå®çš„ç¯å¢ƒæ¥æµ‹è¯•. è¦è¾¾åˆ°è¿™ä¸ªç›®çš„, æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›åˆ—çš„æ“ä½œæ‰å¯ä»¥è¾¾åˆ°.</p><ul><li>æ­£ç¡®åˆ›å»ºå•†å“å¹¶ä¸é¡¹ç›®å…³è”.</li><li>Google Play åå°å·²ç»ä¸Šä¼ å¹¶å‘å¸ƒäº†ä¸€ä¸ª Bata/Alpha ç‰ˆæœ¬.</li><li>ä½¿ç”¨å’Œ Google Play åå°å·²ç»å‘å¸ƒçš„åº”ç”¨ç›¸åŒçš„ç­¾åå’Œç‰ˆæœ¬æ‰“åŒ…å‡ºæ¥çš„åº”ç”¨.</li><li>åœ¨ Google Play åå°æ·»åŠ <a href="https://developer.android.com/google/play/billing/billing_admin.html#billing-testing-setup" target="_blank" rel="noopener">æµ‹è¯•è´¦å·</a>.</li><li>ç¡®è®¤åº”ç”¨çš„å‘å¸ƒåœ°åŒºæœ‰è¿™ä¸ªæµ‹è¯•è´¦å·çš„æ‰€åœ¨åœ°åŒº.</li><li>ç¡®ä¿æµ‹è¯•ç”¨æ‰‹æœºå®‰è£…äº†è°·æ­ŒæœåŠ¡æ¡†æ¶, å¼€å¯ç¿»å¢™å¹¶ç™»é™†äº†ä¸Šé¢æ·»åŠ çš„æµ‹è¯•è´¦å·.</li></ul><p>è¿™åªæ˜¯å…¶ä¸­ä¸€éƒ¨åˆ†éœ€æ±‚, è¿˜æœ‰ä¸€äº›åŸå› ä¼šå¯¼è‡´ä½ æ— æ³•æ­£ç¡®æµ‹è¯•å……å€¼.</p><h1 id="ä¸‰-å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰-å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰. å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ"></a>ä¸‰. å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ</h1><h2 id="1-éœ€è¦éªŒè¯èº«ä»½-æ‚¨éœ€è¦ç™»å½•è‡ªå·±-Google-è´¦å·"><a href="#1-éœ€è¦éªŒè¯èº«ä»½-æ‚¨éœ€è¦ç™»å½•è‡ªå·±-Google-è´¦å·" class="headerlink" title="1. éœ€è¦éªŒè¯èº«ä»½. æ‚¨éœ€è¦ç™»å½•è‡ªå·± Google è´¦å·"></a>1. éœ€è¦éªŒè¯èº«ä»½. æ‚¨éœ€è¦ç™»å½•è‡ªå·± Google è´¦å·</h2><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fhzbhgvtu7j30dw079gmc.jpg" alt=""></p><p>è§£å†³æ–¹æ¡ˆ:</p><blockquote><p>å•†å“idä¸æ­£ç¡®, è¯·æ£€æŸ¥ä¸‹è´­ä¹°æ—¶ä¼ å…¥çš„å•†å“ id å’Œ Google Play åå°æ˜¯å¦ä¸€è‡´</p></blockquote><h2 id="2-æ­¤ç‰ˆæœ¬çš„åº”ç”¨æœªé…ç½®ä¸ºé€šè¿‡-Google-Play-ç»“ç®—"><a href="#2-æ­¤ç‰ˆæœ¬çš„åº”ç”¨æœªé…ç½®ä¸ºé€šè¿‡-Google-Play-ç»“ç®—" class="headerlink" title="2. æ­¤ç‰ˆæœ¬çš„åº”ç”¨æœªé…ç½®ä¸ºé€šè¿‡ Google Play ç»“ç®—."></a>2. æ­¤ç‰ˆæœ¬çš„åº”ç”¨æœªé…ç½®ä¸ºé€šè¿‡ Google Play ç»“ç®—.</h2><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fhzbtvd43jj30dw079gmd.jpg" alt=""></p><p>è§£å†³æ–¹æ¡ˆ:</p><blockquote><p>å¯èƒ½åœ¨æµ‹è¯•è´¦å·æ‰€åœ¨çš„åŒºæ²¡æœ‰åŒ…å«åœ¨åº”ç”¨çš„å‘å”®åœ°åŒºä¸­, è¯·æ£€æŸ¥é…ç½®, ä¿®æ”¹åéœ€è¦è€å¿ƒç­‰å¾…ç”Ÿæ•ˆ.</p></blockquote><h2 id="3-æ— æ³•è´­ä¹°æ‚¨è¦ä¹°çš„å•†å“"><a href="#3-æ— æ³•è´­ä¹°æ‚¨è¦ä¹°çš„å•†å“" class="headerlink" title="3. æ— æ³•è´­ä¹°æ‚¨è¦ä¹°çš„å•†å“."></a>3. æ— æ³•è´­ä¹°æ‚¨è¦ä¹°çš„å•†å“.</h2><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fhyskeq0czj30du08caae.jpg" alt=""></p><p>è§£å†³æ–¹æ¡ˆ:</p><blockquote><ol><li>æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦ä¸å‘å¸ƒåº”ç”¨çš„ç‰ˆæœ¬å·ä¸€è‡´</li></ol></blockquote><p>Updata: </p><blockquote><p>è¿™ä¸ªæ˜¯å¾ˆæ—©ä¹‹å‰çš„ä¸€ä¸ªé”™è¯¯, è²Œä¼¼ Google ç›®å‰å·²ç»ä¸å†æ£€æŸ¥ç‰ˆæœ¬å·è¿™ä¸ªå±æ€§äº†.</p><ol><li>ç¡®è®¤æœ‰æ²¡æœ‰å‘å¸ƒ Beta/Alpha</li><li>å¦‚æœæ˜¯å°é—­æµ‹è¯•éœ€è¦ç‚¹å‡»é“¾æ¥æˆä¸ºæµ‹è¯•äººå‘˜, è¿æ¥å½¢å¼: <code>https://play.google.com/apps/testing/xxx</code></li></ol></blockquote><p>Update 2017å¹´08æœˆ15æ—¥:</p><blockquote><p>ä»Šå¤©åˆé‡åˆ°äº†è¿™ä¸ªé—®é¢˜, ä»€ä¹ˆéƒ½æ²¡æœ‰æ”¹, è¿‡äº†ä¸€ä¼šçªç„¶åˆå¥½äº†, çŒœæƒ³æ˜¯ä¸æ˜¯å‘å¸ƒä¹‹åè¿˜éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ç”Ÿæ•ˆ.</p></blockquote><h2 id="4-ä»æœåŠ¡å™¨æ£€ç´¢ä¿¡æ¯å‡ºé”™-DF-DIC-02"><a href="#4-ä»æœåŠ¡å™¨æ£€ç´¢ä¿¡æ¯å‡ºé”™-DF-DIC-02" class="headerlink" title="4. ä»æœåŠ¡å™¨æ£€ç´¢ä¿¡æ¯å‡ºé”™.[DF-DIC-02]"></a>4. ä»æœåŠ¡å™¨æ£€ç´¢ä¿¡æ¯å‡ºé”™.[DF-DIC-02]</h2><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fhtuo2rcywj30ds08fq3a.jpg" alt=""></p><blockquote><p>å¯èƒ½æ˜¯å•†å“ id ä¸æ­£ç¡®æˆ–è€…æ”¯ä»˜é€»è¾‘é”™è¯¯å¯¼è‡´ä¼ å…¥äº†é”™è¯¯çš„å•†å“ id, è¯¦ç»†åŸå› å¯ä»¥ç§»æ­¥æˆ‘çŸ¥ä¹ä¸Šçš„<a href="https://www.zhihu.com/question/26935519/answer/182780390" target="_blank" rel="noopener">è¿™ä¸ªå›ç­”</a></p></blockquote><h2 id="5-æ·»åŠ æµ‹è¯•è´¦å·"><a href="#5-æ·»åŠ æµ‹è¯•è´¦å·" class="headerlink" title="5. æ·»åŠ æµ‹è¯•è´¦å·"></a>5. æ·»åŠ æµ‹è¯•è´¦å·</h2><p>æµ‹è¯•è´¦å·åˆ†ä¸ºä¸¤ç§:</p><ol><li>ä¸‹è½½æµ‹è¯•è´¦å·åˆ—è¡¨<ol><li>å¦‚æœåº”ç”¨å¤„äºæœªå‘å¸ƒçš„çŠ¶æ€, åªæœ‰è¿™ä¸ªåˆ—è¡¨ä¸­çš„ç”¨æˆ·å¯ä»¥å……å€¼</li></ol></li><li>å……å€¼æµ‹è¯•è´¦å·åˆ—è¡¨<ol><li>è¿™ä¸ªåˆ—è¡¨ä¸­çš„ç”¨æˆ·å¯ä»¥å…è´¹å……å€¼</li></ol></li></ol><p>æµ‹è¯•å……å€¼è¿™ä¸¤ä¸ªç¼ºä¸€ä¸å¯.</p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>IAB æœ€éº»çƒ¦çš„åœ°æ–¹å°±æ˜¯å®ƒçš„æµ‹è¯•å……å€¼, åŸå› åœ¨äºå®ƒçš„é”™è¯¯æç¤ºä¸æ˜¯ â€œäººè¯â€, è¿™ä¸ªåªèƒ½é æˆ‘ä»¬çš„ä¸°å¯Œç»éªŒæ¥è§£å†³äº†.</p><p>å‚è€ƒèµ„æ–™:</p><ol><li><a href="http://blog.csdn.net/n5/article/details/50705745" target="_blank" rel="noopener">http://blog.csdn.net/n5/article/details/50705745</a></li><li><a href="https://developer.android.com/google/play/billing/index.html" target="_blank" rel="noopener">https://developer.android.com/google/play/billing/index.html</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­, æœ‰å¾ˆå¤šç¯‡éƒ½æ˜¯å¾ˆ Apple IAP ç›¸å…³çš„, è€Œ Google IAB çš„å´ä¸€ç¯‡éƒ½æ²¡æœ‰, è¿™å¯¹äºå äº†åŠå£æ±Ÿå±±çš„ Android å¾ˆä¸å…¬å¹³.&lt;/p&gt;
&lt;p&gt;å°±ä½œä¸ºä¸€ä¸ªå¼€å‘è€…è€Œè¨€, IAB çš„ä½“éªŒæ˜¯æ¯” IAP è¦å¥½çš„. å®ƒä½“ç°åœ¨è¿™ä¹ˆå‡ ä¸ªæ–¹é¢:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æµ‹è¯•è´¦å·å°±æ˜¯ Goolge è´¦å·, ä¸åƒè‹¹æœé‚£æ ·æ˜¯æ²™ç›’è´¦å·. è¿™æ ·ä¸åŒè´¦å·ä¸‹çš„åº”ç”¨å¯ä»¥è®¾ç½®åŒä¸€ä¸ªæµ‹è¯•è´¦å·, é¿å…æ¥å›åˆ‡æ¢è´¦å·.&lt;/li&gt;
&lt;li&gt;æ”¯æŒé€€æ¬¾æŸ¥è¯¢. åœ¨è‹¹æœä¸Š, åªèƒ½åƒäº†è¿™ä¸ªå“‘å·´äº.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†æ˜¯ IAB ä¹Ÿæœ‰ä¸€äº›ä¸å¤ªä¾¿åˆ©çš„åœ°æ–¹, åé¢æˆ‘ä»¬ä¼šè®¨è®ºå®ƒ.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Android" scheme="http://blog.justbilt.com/tags/Android/"/>
    
      <category term="IAB" scheme="http://blog.justbilt.com/tags/IAB/"/>
    
  </entry>
  
  <entry>
    <title>æœ€è¿‘æ iOS ç‰ˆé‡åˆ°çš„ä¸€äº›é—®é¢˜å’ŒæŠ€å·§ (äº”)</title>
    <link href="http://blog.justbilt.com/2017/07/16/ios-dev-tips-5/"/>
    <id>http://blog.justbilt.com/2017/07/16/ios-dev-tips-5/</id>
    <published>2017-07-16T03:36:20.000Z</published>
    <updated>2017-07-16T09:30:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ®µæ—¶é—´åˆç§¯æ”’ä¸‹äº†ä¸å°‘çš„æŠ€å·§å’Œè§£å†³æ–¹æ¡ˆ, æ„Ÿè§‰ XCode è¶Šæ¥è¶Šç‰›é€¼äº†, å°¤å…¶æ˜¯åœ¨åº”ç”¨çš„è´¦å·è®¾ç½®æ–¹é¢, ä¹‹å‰é‡åˆ°çš„ä¸€äº›ä½çº§é—®é¢˜å¯èƒ½å·²ç»ä¸å¤å­˜åœ¨äº†.</p><a id="more"></a><h1 id="æ­¤åº”ç”¨åœ¨æœªæ¥çš„-iOS-ç‰ˆæœ¬ä¸‹å°†æ— æ³•ä½¿ç”¨"><a href="#æ­¤åº”ç”¨åœ¨æœªæ¥çš„-iOS-ç‰ˆæœ¬ä¸‹å°†æ— æ³•ä½¿ç”¨" class="headerlink" title="æ­¤åº”ç”¨åœ¨æœªæ¥çš„ iOS ç‰ˆæœ¬ä¸‹å°†æ— æ³•ä½¿ç”¨"></a>æ­¤åº”ç”¨åœ¨æœªæ¥çš„ iOS ç‰ˆæœ¬ä¸‹å°†æ— æ³•ä½¿ç”¨</h1><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fhlkn3of4wj316y0p4aku.jpg" alt=""></p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>å‘ç”Ÿè¿™ä¸ªé—®é¢˜çš„åŸå› å°±æ˜¯åº”ç”¨æ²¡æœ‰æ”¯æŒ arm64 CPU æ¶æ„, ä¸åŒçš„CPUæ¶æ„å¯¹åº”çš„è®¾å¤‡å¦‚ä¸‹:</p><blockquote><p>arm64ï¼šiPhone6s | iphone6s plusï½œiPhone6ï½œ iPhone6 plusï½œiPhone5S | iPad Airï½œ iPad mini2(iPad mini with Retina Display)<br>armv7sï¼šiPhone5ï½œiPhone5Cï½œiPad4(iPad with Retina Display)<br>armv7ï¼šiPhone4ï½œiPhone4Sï½œiPadï½œiPad2ï½œiPad3(The New iPad)ï½œiPad miniï½œiPod Touch 3Gï½œiPod Touch4</p></blockquote><p>ä¸€èˆ¬å‡ºç°è¿™ä¸ªé—®é¢˜, å¾ˆæœ‰å¯èƒ½æ˜¯ <strong>XCode Architectures è®¾ç½®æˆ–å¯¼å‡ºåŒ…çš„æ–¹å¼æœ‰é—®é¢˜</strong>:</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fhlkyqgvv0j30jy02odg2.jpg" alt=""></p><p>è¿™é‡Œé¢æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦å…³æ³¨ä¸€ä¸‹: <code>Build Avtive Architecture Only</code> å’Œ <code>Vaild Architectures</code>, å‰è€…æ˜¯ä¸ºäº†åŠ é€ŸçœŸæœºè¿è¡Œçš„é€Ÿåº¦, ä¸€èˆ¬ debug ä¼šè®¾ç½®ä¸º YES, release ç‰ˆä¼šè®¾ç½®ä¸º NO; åè€…æ˜¯åº”ç”¨æ‰€æ”¯æŒçš„ CPU æ¶æ„.</p><p>æ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¾—ä¿è¯ Vaild Architectures ä¸­æœ‰ arm64, å¹¶ä¸”æ‰“åŒ…å‡º release ç‰ˆæ‰å¯ä»¥, æˆ‘ä»¬é‡åˆ°è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯æ‰“åŒ…åŒå­¦ä½¿ç”¨äº† debug ç‰ˆçš„ app åšæˆ ipa å®‰è£…åŒ…çš„åŸå› .</p><hr><h1 id="clang-error-no-such-file-or-directory-â€˜XXXâ€™"><a href="#clang-error-no-such-file-or-directory-â€˜XXXâ€™" class="headerlink" title="clang: error: no such file or directory: â€˜XXXâ€™"></a>clang: error: no such file or directory: â€˜XXXâ€™</h1><p>é€ æˆè¿™ä¸ªé”™è¯¯çš„åŸå› æœ‰å¥½å¤š, è¿™æ¬¡çš„æŠ¥é”™æå…¶è¯¡å¼‚, è¿ç³»ç»Ÿåº“éƒ½ä¼šæŠ¥æ‰¾ä¸åˆ°.</p><h2 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>ç»è¿‡æ’æŸ¥, å‘ç°æ˜¯ <code>Other Link Flag</code> ä¸­æœ‰ä¸€ä¸ªå•è¡Œçš„ <code>-force_laod</code>, ä¼°è®¡æ˜¯åˆ é™¤çš„æ—¶å€™å°‘åˆ äº†ä¸€è¡Œ.</p><hr><h1 id="XCode-çœŸæœºè°ƒè¯•å®‰è£…å¤±è´¥-æç¤ºè¯ä¹¦è¿‡æœŸ"><a href="#XCode-çœŸæœºè°ƒè¯•å®‰è£…å¤±è´¥-æç¤ºè¯ä¹¦è¿‡æœŸ" class="headerlink" title="XCode çœŸæœºè°ƒè¯•å®‰è£…å¤±è´¥, æç¤ºè¯ä¹¦è¿‡æœŸ"></a>XCode çœŸæœºè°ƒè¯•å®‰è£…å¤±è´¥, æç¤ºè¯ä¹¦è¿‡æœŸ</h1><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fhllu9g2m4j30ad03r3yo.jpg" alt=""></p><h2 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>çœŸæœºè°ƒè¯•çš„æ—¶å€™ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯å¼€å‘è¯ä¹¦, å¼€å‘è¯ä¹¦å¯ä»¥æœ‰å¾ˆå¤šä¸ª, åœ¨é’¥åŒ™ä¸²ä¸­æ‰¾åˆ°è¿‡æœŸçš„è¯ä¹¦åˆ æ‰å°±å¯ä»¥å•¦, XCode ä¼šè‡ªåŠ¨åŒ¹é…ä¸€ä¸ªæ²¡æœ‰è¿‡æœŸçš„è¯ä¹¦.</p><hr><h1 id="å¯¼å‡º-dis-åŒ…å‡ºé”™-IDEDistributionErrorDomain-error-3"><a href="#å¯¼å‡º-dis-åŒ…å‡ºé”™-IDEDistributionErrorDomain-error-3" class="headerlink" title="å¯¼å‡º dis åŒ…å‡ºé”™, IDEDistributionErrorDomain error 3"></a>å¯¼å‡º dis åŒ…å‡ºé”™, IDEDistributionErrorDomain error 3</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error: exportArchive: The operation couldnâ€™t be completed. (IDEDistributionErrorDomain error 3.)</span><br><span class="line">Error Domain=IDEDistributionErrorDomain Code=3 <span class="string">"(null)"</span> UserInfo=&#123;IDEDistributionErrorSigningIdentityToItemToUnderlyingErrorKey=&#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="è§£å†³æ–¹æ¡ˆ-3"><a href="#è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>å…¶å®å°±æ˜¯è¯ä¹¦å’Œ Provisioning Profiles æ²¡æœ‰åŒ¹é…ä¸Š, å¾ˆæœ‰å¯èƒ½æ˜¯å…¶ä»–å°ä¼™ä¼´ revoke äº†ä½ çš„ dis è¯ä¹¦.</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fhlmmvhb27j30ud0jajth.jpg" alt=""></p><p>å» <a href="https://developer.apple.com/account/ios/profile/" target="_blank" rel="noopener">è‹¹æœå¼€å‘è€…ä¸­å¿ƒ</a> æŸ¥çœ‹å¯¹åº”çš„ Profiles çš„ status æ˜¯å¦æ­£å¸¸, ä¿®æ”¹å®Œåä¸‹è½½è¿è¡Œä¸€ä¸‹, ç„¶åé‡æ–°å¯¼å‡ºå°±å¥½äº†.</p><hr><h1 id="æ²™ç›’æµ‹è¯•-æ­¤æ—¶æ²¡æœ‰æƒé™åœ¨Sandboxè´­ä¹°æ­¤InApp"><a href="#æ²™ç›’æµ‹è¯•-æ­¤æ—¶æ²¡æœ‰æƒé™åœ¨Sandboxè´­ä¹°æ­¤InApp" class="headerlink" title="æ²™ç›’æµ‹è¯•: æ­¤æ—¶æ²¡æœ‰æƒé™åœ¨Sandboxè´­ä¹°æ­¤InApp"></a>æ²™ç›’æµ‹è¯•: æ­¤æ—¶æ²¡æœ‰æƒé™åœ¨Sandboxè´­ä¹°æ­¤InApp</h1><p>å…¶å®æè¿°çš„å¾ˆæ¸…æ™°, è¿™ä¸ªæ²™ç›’è´¦å·ä¸æ˜¯ä½ è¿™ä¸ªåº”ç”¨çš„, è¯·ä»”ç»†æ£€æŸ¥ä¸€ä¸‹.</p><h2 id="è§£å†³æ–¹æ¡ˆ-4"><a href="#è§£å†³æ–¹æ¡ˆ-4" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>æ›´æ¢æ­£ç¡®çš„æ²™ç›’æµ‹è¯•è´¦å·.</p><hr><h1 id="QQ-ä¸€é”®åŠ ç¾¤è·³è½¬è¿‡å»åç¾¤ä¸æ­£ç¡®"><a href="#QQ-ä¸€é”®åŠ ç¾¤è·³è½¬è¿‡å»åç¾¤ä¸æ­£ç¡®" class="headerlink" title="QQ: ä¸€é”®åŠ ç¾¤è·³è½¬è¿‡å»åç¾¤ä¸æ­£ç¡®"></a>QQ: ä¸€é”®åŠ ç¾¤è·³è½¬è¿‡å»åç¾¤ä¸æ­£ç¡®</h1><p>æ£€æŸ¥ LSApplicationQueriesSchemes ä¸­æ˜¯å¦æœ‰ <code>mqqapi</code>:</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fhlmr1lvfkj30y00bcgno.jpg" alt=""></p><h2 id="è§£å†³æ–¹æ¡ˆ-5"><a href="#è§£å†³æ–¹æ¡ˆ-5" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>å¦‚æœæ²¡æœ‰çš„è¯æ·»åŠ ä¸€ä¸ªå°±å¥½å•¦.</p><hr><h1 id="å¯¼å‡º-dev-åŒ…å‡ºé”™-IDEDistributionErrorDomain-Code-14"><a href="#å¯¼å‡º-dev-åŒ…å‡ºé”™-IDEDistributionErrorDomain-Code-14" class="headerlink" title="å¯¼å‡º dev åŒ…å‡ºé”™, IDEDistributionErrorDomain Code=14"></a>å¯¼å‡º dev åŒ…å‡ºé”™, IDEDistributionErrorDomain Code=14</h1><p>æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/Users/justbilt/.rvm/bin/rvm: line 66: shell_session_update: command not found</span><br><span class="line">+ xcodebuild -exportArchive -exportOptionsPlist /Users/justbilt/Documents/work/easy_slg_client/frameworks/runtime-src/proj.ios_mac/ios_export_dev.plist -archivePath /Users/justbilt/Documents/work/easy_slg_client/.build/yile.guopan-1.4.0.f592c19533-0607170734.xcarchive -exportPath /Users/justbilt/Documents/work/easy_slg_client/.build/0607192643399129</span><br><span class="line">2017-06-07 19:26:43.906 xcodebuild[4724:25032817] [MT] PluginLoading: Required plug-in compatibility UUID E0A62D1F-3C18-4D74-BFE5-A4167D643966 for plug-in at path &apos;~/Library/Application Support/Developer/Shared/Xcode/Plug-ins/XAlign.xcplugin&apos; not present in DVTPlugInCompatibilityUUIDs</span><br><span class="line">2017-06-07 19:26:44.068 xcodebuild[4724:25032817] [MT] IDEDistribution: -[IDEDistributionLogging _createLoggingBundleAtPath:]: Created bundle at path &apos;/var/folders/ff/wpytbgmd3rl1pn9dd02nbjc80000gn/T/guopan_2017-06-07_19-26-44.068.xcdistributionlogs&apos;.</span><br><span class="line">2017-06-07 19:26:58.844 xcodebuild[4724:25032817] [MT] IDEDistribution: Step failed: &lt;IDEDistributionThinningStep: 0x7fb80e6cb860&gt;: Error Domain=IDEDistributionErrorDomain Code=14 &quot;No applicable devices found.&quot; UserInfo=&#123;NSLocalizedDescription=No applicable devices found.&#125;</span><br><span class="line">error: exportArchive: No applicable devices found.</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°å…¶ä¸­çš„ xcdistributionlogs æ—¥å¿—æ–‡ä»¶è·¯å¾„:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/folders/ff/wpytbgmd3rl1pn9dd02nbjc80000gn/T/guopan_2017-06-07_19-26-44.068.xcdistributionlogs</span><br></pre></td></tr></table></figure><p>åœ¨ IDEDistribution.standard.log æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°çœŸæ­£çš„é”™è¯¯åŸå› :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">guopan.app/guopan arm64 -&gt;</span><br><span class="line">error: Info.plist of â€œguopan.app/heepayImage.bundleâ€ specifies a non-existent file for the CFBundleExecutable key</span><br><span class="line">error: Info.plist of â€œguopan.app/walletResources.bundle/Contentsâ€ specifies a non-existent file for the CFBundleExecutable key</span><br><span class="line">2017-06-07 11:08:24 +0000  Validating IPA structure...</span><br><span class="line">2017-06-07 11:08:24 +0000 [MT] /Applications/Xcode.app/Contents/Developer/usr/bin/ipatool exited with 1</span><br><span class="line">2017-06-07 11:08:24 +0000 [MT] ipatool JSON: &#123;</span><br><span class="line">    alerts =     (</span><br><span class="line">                &#123;</span><br><span class="line">            code = 0;</span><br><span class="line">            description = &quot;Info.plist of \U201cguopan.app/heepayImage.bundle\U201d specifies a non-existent file for the CFBundleExecutable key&quot;;</span><br><span class="line">            info =             &#123;</span><br><span class="line">            &#125;;</span><br><span class="line">            level = ERROR;</span><br><span class="line">            type = &quot;malformed-payload&quot;;</span><br><span class="line">        &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">            code = 0;</span><br><span class="line">            description = &quot;Info.plist of \U201cguopan.app/walletResources.bundle/Contents\U201d specifies a non-existent file for the CFBundleExecutable key&quot;;</span><br><span class="line">            info =             &#123;</span><br><span class="line">            &#125;;</span><br><span class="line">            level = ERROR;</span><br><span class="line">            type = &quot;malformed-payload&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è§£å†³æ–¹æ¡ˆ-6"><a href="#è§£å†³æ–¹æ¡ˆ-6" class="headerlink" title="è§£å†³æ–¹æ¡ˆ:"></a>è§£å†³æ–¹æ¡ˆ:</h2><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸¤ä¸ª Error, æ„æ€å°±æ˜¯è¿™ä¸¤ä¸ª .bundle ä¸­çš„ <code>Info.plist</code> ä¸­çš„ key <code>CFBundleExecutable</code> å­—æ®µæŒ‡å®šäº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶, è¿™ä¸ªæŒ‡å®šå…¶å®æ²¡æœ‰å•¥ç”¨, æˆ‘ä»¬åˆ æ‰å®ƒå°±å¯ä»¥äº†. </p><p>ç”¨ Sublime æ‰“å¼€è¿™ä¸ª plist, åˆ é™¤ä¸‹é¢è¿™ä¸¤è¡Œ:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;key&gt;CFBundleExecutable&lt;/key&gt;</span><br><span class="line">&lt;string&gt;xxx&lt;/string&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ‰“å¼€çš„æ–‡ä»¶æ˜¯ä¸€å›¢ä¹±ç , é‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶åº” 2è¿›åˆ¶ å½¢å¼çš„ plist, æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·æŠŠå®ƒè½¬åŒ–ä¸º xml å½¢å¼çš„:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plutil -convert xml1 xxx/heepayImage.bundle/Info.plist</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ é™¤æ‰.</p>]]></content>
    
    <summary type="html">
    
      ä¸‡ä¸€é‡ä¸Šäº†å‘¢?
    
    </summary>
    
    
      <category term="iOS" scheme="http://blog.justbilt.com/tags/iOS/"/>
    
      <category term="iOS-Dev-Tips" scheme="http://blog.justbilt.com/tags/iOS-Dev-Tips/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Electron é‡å†™ convert2fnt</title>
    <link href="http://blog.justbilt.com/2017/07/09/convert2fnt-electron-rewrite/"/>
    <id>http://blog.justbilt.com/2017/07/09/convert2fnt-electron-rewrite/</id>
    <published>2017-07-09T04:54:42.000Z</published>
    <updated>2017-07-16T01:14:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤§æ¦‚æ˜¯ 14 å¹´ 2 æœˆä»½çš„æ—¶å€™, æˆ‘ä½¿ç”¨åˆšå­¦ä¼š Python å†™äº†ä¸€ä¸ªå°å·¥å…·: <a href="https://github.com/justbilt/convert2fnt" target="_blank" rel="noopener">convert2fnt</a>, ä¸ºæ­¤è¿˜å†™äº†ä¸€ç¯‡æ–‡ç«  <a href="/2014/02/01/images_to_bmfont/">å°†ä¸€å †å›¾ç‰‡è½¬åŒ–ä¸ºBMFontå·¥å…·</a> ä»‹ç»è¿™ä¸ªå·¥å…·. å®ƒçš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯è¿™ä¸ªæ ·å­çš„:</p><blockquote><p>ç¾æœ¯å¦¹å­å‡ºäº†ä¸€å †å›¾ç‰‡å­—, ä½†æ˜¯åœ¨ç¨‹åºä¸­ä½¿ç”¨ BMFont æ˜¯æ›´åŠ æ–¹ä¾¿çš„, è¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å¼ºç¡¬çš„è¦æ±‚ç¾æœ¯å¦¹å­é‡æ–°ç”¨ Glyphdesigner åˆ¶ä½œä¸€ä»½å­—ä½“. ä½†æ˜¯ä¹Ÿå¯ä»¥å¾ˆæ¸©æŸ”çš„å‘Šè¯‰å¥¹: â€œä½ å…ˆå»å¿™å§, å‰©ä¸‹çš„äº¤ç»™æˆ‘äº†.â€, ç„¶ååœ¨å¦¹å­å´‡æ‹œçš„ç›®å…‰ä¸‹, è½¬èº«ç¦»å», æ·±è—åŠŸä¸å. </p></blockquote><a id="more"></a><p>æ©, æœ€åˆç‰ˆçš„å·¥å…·ç¡®å®èƒ½å¤Ÿè¾¾åˆ°è¿™ä¸ªç›®çš„, åªæ˜¯è¿‡ç¨‹å¯èƒ½ç•¥å¾®éº»çƒ¦ä¸€ä¸‹. </p><p>åœ¨ç¬¬ä¸€ç‰ˆçš„å·¥å…·ä¸­, å› ä¸ºç”¨åˆ°äº† ImageMagick æ¥æ‹¼æ¥å›¾ç‰‡, æ‰€ä»¥ä½ éœ€è¦å…ˆå®‰è£…è¿™ä¸ªå·¥å…·, ç„¶åä¸‹è½½è„šæœ¬, å®‰è£…ä¾èµ–åº“, å¼€å§‹ä½¿ç”¨. å½“å¦¹å­æ»¡å¿ƒæœŸå¾…çœ‹ç€ä½ æ”¾å¤§æ‹›çš„æ—¶å€™, ä½ TMè¿˜åœ¨é…ç¯å¢ƒ? </p><p><img src="/face/yilianmengbi3.jpg" alt=""></p><p>ç¬¬äºŒç‰ˆä¸­é‡ç‚¹ä¼˜åŒ–äº†é…ç½®ç¯å¢ƒå¤æ‚çš„é—®é¢˜. ä½¿ç”¨ Pillow æ›¿æ¢äº† ImageMagick, è¿˜ä½¿ç”¨ PyInstaller æ‰“åŒ…äº†å¯æ‰§è¡Œç¨‹åº. å¦‚æœé¡ºåˆ©çš„è¯, ä¸‹è½½ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº, æŠŠå›¾ç‰‡æŒ‰ç…§è§„åˆ™å‘½åå¥½, æ‰§è¡Œä¸‹å°±å¥½äº†, å¾ˆå¤§çš„è¿›æ­¥æœ‰æœ¨æœ‰?</p><p>ä½†æ˜¯è¿™ä¸ªå·¥å…·çš„ä½¿ç”¨èŒƒå›´è¿˜æ˜¯å±€é™åœ¨äº†æŠ€æœ¯äººå‘˜æ‰‹, ä½ ä¸ä¼šæŒ‡æœ›ç¾æœ¯ç­–åˆ’åŒå­¦æ¥æ­å»ºä¸€ä¸ª <code>Python + pip</code> çš„ç¯å¢ƒå§? æˆ‘ä»¬ç¡®å®å¾ˆæ„¿æ„å¸®åŠ©å¦¹å­, ä½†æ˜¯ç­–åˆ’åŒå­¦æ¥æ‰¾ä½ æ€ä¹ˆåŠ? </p><p><img src="/face/ruhua.jpg" alt=""></p><p>ä¸€ä¸ªå¸¦ç•Œé¢çš„å·¥å…·åœ¨è¿™æ—¶å€™çœ‹èµ·æ¥ç¡®å®ä¼šæ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©, è¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ‰€åŠªåŠ›çš„æ–¹å‘. æˆ‘å°è¯•è¿‡ Python çš„å„ç§ GUI æ–¹æ¡ˆ: Tkinter, PyWx, PyQt ç­‰ç­‰, è¿™äº›æ–¹æ¡ˆè‰¯è ä¸æµ, æœ‰çš„çœ‹èµ·æ¥åªæ˜¯ä¸€ä¸ª Demo, æœ‰çš„å…‰æ­å»ºç¯å¢ƒå°±ä¼šè®©ä½ å.</p><p>ä¸ºæ­¤æˆ‘å„ç§å°è¯•,å¾˜å¾Šåœ¨å„ç§æ–¹æ¡ˆé—´æŒ£æ‰äº†å¥½å‡ å¹´, ç›´åˆ° <code>Electron</code> æ¨ªç©ºå‡ºä¸–. å®ƒä¼¼ä¹æ˜¯ä¸€ä¸ªå«ç€é‡‘é’¥åŒ™å‡ºç”Ÿçš„é¡¹ç›®, æœ‰ç€ Github è¿™ä¸ªå…¨çƒæœ€å¤§åŒæ€§äº¤å‹ç½‘ç«™çš„åŠ æˆ, ä¸€å‡ºç”Ÿä¾¿å¤‡å—ç©ç›®. å½“ç„¶å®ƒä¹Ÿä¸è´Ÿä¼—æœ›, å¹²ç¿»å®ƒçš„å‰èº« Node-Webkit, ä½¿å¾—è¶Šæ¥è¶Šå¤šçš„ App é€‰æ‹©ä½¿ç”¨å®ƒæ¥åˆ¶ä½œ:</p><p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1fhdnp3klegj30ln0vcjza.jpg" alt=""></p><p>è¿™é‡Œå«é‡‘é‡æœ€é«˜çš„ä¾¿æ˜¯: Atom, VSCode ä»¥åŠ Cocos çš„æœ€æ–°äº§å“: Cocos Creater. å…¶ä¸­ Creater æ˜¯çœŸæ­£è®©æˆ‘ä¸‹å®šå†³å®šä½¿ç”¨ Electron çš„é¡¹ç›®, å‰ä¸¤ä¸ªéƒ½åªæ˜¯ä¸ªç¼–è¾‘å™¨, è€Œ Creater åˆ™æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ, ä¸€ä¸ª 2D æ¸¸æˆçš„åˆ¶ä½œå·¥å…·, è€Œä¸”ä»ç›®å‰çš„å‘å±•æ¥çœ‹, ååˆ†çš„å¥åº·. </p><p>ä»¥ç›®å‰ Electron çš„ç«çˆ†, ç½‘ä¸Šå¯ä»¥æ‰¾åˆ°ä¸€å¤§å †çš„æ•™ç¨‹, ç›¸ä¿¡å¤§å®¶å¯ä»¥å¾ˆè½»æ˜“çš„å…¥é—¨è¿™ä¸ªæ¡†æ¶. è¿™é‡Œæˆ‘å’Œå¤§å®¶åˆ†äº«ä¸‹è‡ªå·±çš„å¿ƒå¾—å’Œè¸©è¿‡çš„ä¸€äº›å‘.</p><h2 id="1-Electron-å¤šä¸ªç»„ä»¶çš„ä½œç”¨"><a href="#1-Electron-å¤šä¸ªç»„ä»¶çš„ä½œç”¨" class="headerlink" title="1. Electron å¤šä¸ªç»„ä»¶çš„ä½œç”¨"></a>1. Electron å¤šä¸ªç»„ä»¶çš„ä½œç”¨</h2><h3 id="electron-electron-prebuilt"><a href="#electron-electron-prebuilt" class="headerlink" title="electron/electron-prebuilt"></a>electron/electron-prebuilt</h3><p>æ ¹æ®å®˜æ–¹çš„è§£é‡Š:</p><blockquote><p>Note As of version 1.3.1, this package is published to npm under two names: electron and electron-prebuilt. You can currently use either name, but electron is recommended, as the electron-prebuilt name is deprecated, and will only be published until the end of 2016.</p></blockquote><p>æ„æ€å°±æ˜¯ <code>electron-prebuilt</code> å·²ç»è¢«åºŸå¼ƒäº†, å»ºè®®ç›´æ¥ä½¿ç”¨:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install electron --save-dev</span><br></pre></td></tr></table></figure><h3 id="electron-package-electron-builder"><a href="#electron-package-electron-builder" class="headerlink" title="electron-package/electron-builder"></a>electron-package/electron-builder</h3><p>è¿™ä¸¤ä¸ªéƒ½æ˜¯ Electron çš„æ‰“åŒ…å·¥å…·, </p><p><a href="https://github.com/electron-userland/electron-packager" target="_blank" rel="noopener">electron-package</a> åªèƒ½æ‰“å‡ºå¯æ‰§è¡Œæ–‡ä»¶(Win:exe, Mac:app):</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "package": "electron-packager . --platform=win32 --arch=ia32 --electron-version=1.4.15 --overwrite --ignore=node_modules --ignore=.gitignore"</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p><a href="https://github.com/electron-userland/electron-builder" target="_blank" rel="noopener">electron-builder</a> æ˜¯ä¸€ä¸ªæ›´ä¸ºå…ˆè¿›, ç®€å•çš„æ‰“åŒ…å·¥å…·, å¦‚æœä¸æƒ³æŠ˜è…¾çš„è¯å¯ä»¥ç›´æ¥é€‰æ‹©å®ƒäº†.</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    "pack": "electron-builder --dir",</span><br><span class="line">    "dist": "electron-builder"</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="2-ä¸€å®šè¦å‡†å¤‡ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ¢¯å­â€¦æˆ–è€…è„‘å­"><a href="#2-ä¸€å®šè¦å‡†å¤‡ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ¢¯å­â€¦æˆ–è€…è„‘å­" class="headerlink" title="2. ä¸€å®šè¦å‡†å¤‡ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ¢¯å­â€¦æˆ–è€…è„‘å­"></a>2. ä¸€å®šè¦å‡†å¤‡ä¸€ä¸ªå¼ºæœ‰åŠ›çš„æ¢¯å­â€¦æˆ–è€…è„‘å­</h2><h3 id="npm-install"><a href="#npm-install" class="headerlink" title="npm install"></a>npm install</h3><p>å®‰è£… <code>Electron</code> çš„é€”å¾„ä¹‹ä¸€å°±æ˜¯é€šè¿‡ <code>npm</code>, ä»¥å›½å†…çš„è¿™ä¸ªç½‘ç»œç¯å¢ƒ, é€šè¿‡ npm å®‰è£…ä¸€äº›å°çš„åº“è¿˜å‹‰å¼ºå¯ä»¥, å¯¹äº Electron è¿™ç§å‡ åå…†çš„åº“å°±æ˜¾å¾—æ‰è¥Ÿè§è‚˜äº†, æ—¶é—´é•¿ä¸è¯´è¿˜å¾ˆå®¹æ˜“ä¸­æ–­. è¿™æ—¶å€™å°±å¯ä»¥é€‰æ‹©ä½¿ç”¨ <a href="https://npm.taobao.org/" target="_blank" rel="noopener">cnpm</a> æ¥åšè¿™äº›äº‹æƒ…, </p><p><img src="https://zos.alipayobjects.com/rmsportal/UQvFKvLLWPPmxTM.png" alt=""></p><h3 id="npm-run-dist"><a href="#npm-run-dist" class="headerlink" title="npm run dist"></a>npm run dist</h3><p>electron-builder ç¬¬ä¸€æ¬¡æ‰“åŒ…æ—¶ä¼šå»ä¸‹è½½ electron çš„é¢„ç¼–è¯‘æ–‡ä»¶, è¿™ä¸ªæ–‡ä»¶å¾ˆå¤§, å®ƒä¼šé»˜è®¤å» github ä¸Šä¸‹è½½, è¿™æ—¶å€™å¦‚æœæ²¡æœ‰ç¿»å¢™å·¥å…·å°±ä¼šå¾ˆæƒ¨äº†.</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ æ·˜å® æä¾›çš„<a href="https://npm.taobao.org/mirrors/electron/" target="_blank" rel="noopener">é•œåƒ</a>æ¥ä¸‹è½½, ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•, åœ¨æ‰“åŒ…å‰å…ˆè¿è¡Œè¿™ä¸ªå‘½ä»¤:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ELECTRON_MIRROR=<span class="string">"https://npm.taobao.org/mirrors/electron/"</span></span><br></pre></td></tr></table></figure><p>åŸç†å¯ä»¥çœ‹æ–‡ç« æœ«å°¾çš„é“¾æ¥, ä½¿ç”¨åçœŸçš„æ˜¯ç«‹ç«¿è§å½±, å¤§å®¶å¯ä»¥å¯¹æ¯”ä¸‹ä¸‹è½½é€Ÿåº¦:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MacBook-Air:convert2fnt bilt$ npm run dist</span><br><span class="line">Downloading tmp-6511-0-electron-v1.6.11-darwin-x64.zip</span><br><span class="line">[==&gt;                                          ] 8.8% of 46.08 MB (65.41 kB/s)</span><br><span class="line">MacBook-Air:convert2fnt bilt$ <span class="built_in">export</span> ELECTRON_MIRROR=<span class="string">"https://npm.taobao.org/mirrors/electron/"</span></span><br><span class="line">MacBook-Air:convert2fnt bilt$ npm run dist</span><br><span class="line">Downloading tmp-6579-0-electron-v1.6.11-darwin-x64.zip</span><br><span class="line">[============================&gt;                ] 66.1% of 46.08 MB (951.77 kB/s)</span><br></pre></td></tr></table></figure><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æœ€åä¸Šä¸€ä¸‹æ–°ç‰ˆ convert2fnt æˆªå›¾, ç°åœ¨è¿˜æœ‰ä¸€äº›æ”¶å°¾çš„å·¥ä½œå†åš, å¾ˆå¿«ä½ å°±ä¼šè§åˆ°å®ƒ:</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fhkaqhm6dnj30n80ixq5f.jpg" alt=""></p><p>å½“ç­–åˆ’å†æœ‰ç±»ä¼¼çš„éœ€æ±‚æ—¶, å¯ä»¥ç›´æ¥æ‰”ç»™å¯¹æ–¹ä¸€ä¸ªä¸‹è½½åœ°å€. è‡³äºå¦¹å­, å½“ç„¶æ˜¯é€‰æ‹©å¸®åŠ©å¥¹å•¦.</p><hr><p>å‚è€ƒèµ„æ–™:</p><ul><li><a href="http://www.jianshu.com/p/1c2ad78df208" target="_blank" rel="noopener">å¸¸ç”¨Electron Appæ‰“åŒ…å·¥å…·</a></li><li><a href="http://blog.tomyail.com/install-electron-slow-in-china/" target="_blank" rel="noopener">åŠ é€Ÿelectronåœ¨å›½å†…çš„ä¸‹è½½é€Ÿåº¦</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤§æ¦‚æ˜¯ 14 å¹´ 2 æœˆä»½çš„æ—¶å€™, æˆ‘ä½¿ç”¨åˆšå­¦ä¼š Python å†™äº†ä¸€ä¸ªå°å·¥å…·: &lt;a href=&quot;https://github.com/justbilt/convert2fnt&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;convert2fnt&lt;/a&gt;, ä¸ºæ­¤è¿˜å†™äº†ä¸€ç¯‡æ–‡ç«  &lt;a href=&quot;/2014/02/01/images_to_bmfont/&quot;&gt;å°†ä¸€å †å›¾ç‰‡è½¬åŒ–ä¸ºBMFontå·¥å…·&lt;/a&gt; ä»‹ç»è¿™ä¸ªå·¥å…·. å®ƒçš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯è¿™ä¸ªæ ·å­çš„:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¾æœ¯å¦¹å­å‡ºäº†ä¸€å †å›¾ç‰‡å­—, ä½†æ˜¯åœ¨ç¨‹åºä¸­ä½¿ç”¨ BMFont æ˜¯æ›´åŠ æ–¹ä¾¿çš„, è¿™ä¸ªæ—¶å€™ä½ å¯ä»¥å¼ºç¡¬çš„è¦æ±‚ç¾æœ¯å¦¹å­é‡æ–°ç”¨ Glyphdesigner åˆ¶ä½œä¸€ä»½å­—ä½“. ä½†æ˜¯ä¹Ÿå¯ä»¥å¾ˆæ¸©æŸ”çš„å‘Šè¯‰å¥¹: â€œä½ å…ˆå»å¿™å§, å‰©ä¸‹çš„äº¤ç»™æˆ‘äº†.â€, ç„¶ååœ¨å¦¹å­å´‡æ‹œçš„ç›®å…‰ä¸‹, è½¬èº«ç¦»å», æ·±è—åŠŸä¸å. &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="convert2fnt" scheme="http://blog.justbilt.com/tags/convert2fnt/"/>
    
      <category term="Electron" scheme="http://blog.justbilt.com/tags/Electron/"/>
    
  </entry>
  
  <entry>
    <title>ä¼˜åŒ–æ¸¸æˆåœ¨ iOS ä¸Šçš„å†…è´­</title>
    <link href="http://blog.justbilt.com/2017/06/18/refine-game-ios-iap/"/>
    <id>http://blog.justbilt.com/2017/06/18/refine-game-ios-iap/</id>
    <published>2017-06-18T10:58:03.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹ iOS å†…è´­çš„æµç¨‹, è®©æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹çš„çš„æµç¨‹å›¾:</p><p><img src="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Art/remote_store_fetch_2x.png" alt=""></p><a id="more"></a><p>å¾ˆç®€å•, æ˜¯ä¸æ˜¯ ? ä½œä¸ºä¸€æ¬¾æ¸¸æˆæ¥è¯´, å®é™…æƒ…å†µè¦å¤æ‚çš„å¤š.é¦–å…ˆè¦æ€è€ƒè¿™ä¹ˆå‡ ä¸ªé—®é¢˜:</p><ol><li>è¿”å› Game å±‚æ—¶å› ä¸ºå†…å­˜ä¸è¶³æ¸¸æˆé‡å¯äº†æ€ä¹ˆåŠ ?</li><li>æœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦æ€ä¹ˆåŠ ?</li><li>å¦‚ä½•é˜² IAP ç ´è§£ ?</li></ol><p>ä½œä¸ºä¸€æ¬¾å¯èƒ½åœ¨ â€œå›½å†…â€ å‘å”®çš„æ¸¸æˆ, å¦‚æœä½ ä»¬æ²¡æœ‰è€ƒè™‘è¿‡è¿™äº›é—®é¢˜, é‚£å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šçš„ â€œæƒŠå–œâ€. æœ‰ä¸€ç‚¹éœ€è¦è®°ä½, åƒä¸‡ä¸è¦ä½ä¼°ç©å®¶çš„ â€œåˆ›é€ åŠ›â€. </p><p>é¦–å…ˆ, è¯·å…è®¸ç”¨ååˆ†ç®€å•çš„å‡ è¡Œä»£ç å¸¦å¤§å®¶å›é¡¾ä¸‹ IAP çš„å®ç°, å› ä¸ºåé¢æˆ‘ä»¬è¦è®¨è®ºçš„å†…å®¹å…¨éƒ¨æ˜¯åŸºäºè¿™ä¸ªå‰æçš„. </p><h1 id="IAP-çš„ä»£ç å®ç°"><a href="#IAP-çš„ä»£ç å®ç°" class="headerlink" title="IAP çš„ä»£ç å®ç°"></a>IAP çš„ä»£ç å®ç°</h1><p>è¦å¼€å¯å†…è´­å¾ˆç®€å•, ä¸¤ä¸ªå¯¹è±¡ä¸‰ä¸ªæ­¥éª¤å°±æå®šäº†. </p><p>æˆ‘ä»¬å…ˆæ¥è¯´è¯´è¿™ä¸¤ä¸ªå¯¹è±¡, åˆ†åˆ«æ˜¯ <code>SKPaymentQueue</code> å’Œ <code>SKPaymentTransaction</code> , å‰è€…æ˜¯å……å€¼è®¢å•, åè€…æ˜¯å……å€¼é˜Ÿåˆ—.</p><h2 id="SKPaymentQueue"><a href="#SKPaymentQueue" class="headerlink" title="SKPaymentQueue"></a>SKPaymentQueue</h2><p>å®ƒæ˜¯æ•´ä¸ªå……å€¼çš„æ ¸å¿ƒ, è´Ÿè´£ä¸²è”å……å€¼çš„å„ä¸ªæµç¨‹. å¯ä»¥ç”¨è¿™ä¸ªå¯¹è±¡å®ç°å‘èµ·è´­ä¹°, æ¢å¤å·²ç»è´­ä¹°çš„ç‰©å“, ç»“æŸè´­ä¹°, ç›‘å¬å……å€¼äº‹ä»¶ç­‰åŠŸèƒ½.</p><h2 id="SKPaymentTransaction"><a href="#SKPaymentTransaction" class="headerlink" title="SKPaymentTransaction"></a>SKPaymentTransaction</h2><p>å‰é¢è¯´è¿‡å®ƒæ˜¯å……å€¼çš„è®¢å•å¯¹è±¡, æ¯ä¸€æ¬¡å……å€¼çš„å‘èµ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå”¯ä¸€çš„è®¢å•å¯¹è±¡, å®ƒè®°å½•æœ‰è¿™ä¸ªè®¢å•çš„çŠ¶æ€, id, æ—¶é—´, æ”¶æ®çš„ä¿¡æ¯.</p><p>å…¶ä¸­æ”¶æ®(<code>transactionReceipt</code>)æ˜¯æœ€é‡è¦çš„æ•°æ®, å®ƒæ˜¯è¿™æ¬¡å……å€¼æ˜¯å¦çœŸæ­£æ‰£æ¬¾æˆåŠŸçš„å”¯ä¸€æ¡ä»¶. æˆ‘ä»¬è¦æŠŠå®ƒå‘é€ç»™æˆ‘ä»¬çš„æ¸¸æˆæœåŠ¡å™¨, å†å‘è‹¹æœçš„æœåŠ¡å™¨è¿›è¡ŒéªŒè¯.</p><p>ä¸‹é¢æ¥è¯´è¯´ä¸‰ä¸ªæ­¥éª¤:</p><h2 id="1-æ·»åŠ å……å€¼ç›‘å¬"><a href="#1-æ·»åŠ å……å€¼ç›‘å¬" class="headerlink" title="1. æ·»åŠ å……å€¼ç›‘å¬"></a>1. æ·»åŠ å……å€¼ç›‘å¬</h2><p>æ·»åŠ ç›‘å¬çš„é€»è¾‘å¾ˆç®€å•, å°±ä¸‹é¢è¿™ä¸‰è¡Œ:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([<span class="built_in">SKPaymentQueue</span> defaultQueue]) &#123;</span><br><span class="line">    [[<span class="built_in">SKPaymentQueue</span> defaultQueue] addTransactionObserver:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ä¸ª <code>self</code> å¿…é¡»æ˜¯ä¸€ä¸ªå®ç°äº† <code>SKPaymentTransactionObserver</code> çš„ç±»çš„å®ä¾‹, å½“æœ‰å……å€¼çš„äº‹ä»¶æ—¶, ç±»çš„ <code>updatedTransactions</code> å‡½æ•°ä¼šè¢«è°ƒç”¨:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">IAPHelper</span> : <span class="title">NSObject</span> &lt;<span class="title">SKPaymentTransactionObserver</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//.m</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">IAPHelper</span></span></span><br><span class="line">- (<span class="keyword">void</span>)paymentQueue:(<span class="built_in">SKPaymentQueue</span> *)queue updatedTransactions:(<span class="built_in">NSArray</span> *)transactions</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">SKPaymentTransaction</span> *transaction <span class="keyword">in</span> transactions)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (transaction.transactionState)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStatePurchased</span>: </span><br><span class="line">                <span class="comment">// å¤„ç†æ”¯ä»˜æˆåŠŸ</span></span><br><span class="line">                [[<span class="built_in">SKPaymentQueue</span> defaultQueue] finishTransaction: transaction];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStateFailed</span>: <span class="comment">// æ”¯ä»˜å¤±è´¥</span></span><br><span class="line">                <span class="comment">// å¤„ç†æ”¯ä»˜å¤±è´¥</span></span><br><span class="line">                [[<span class="built_in">SKPaymentQueue</span> defaultQueue] finishTransaction: transaction];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">SKPaymentTransactionStateRestored</span>: <span class="comment">// æ¢å¤å†…è´­</span></span><br><span class="line">                <span class="comment">// å¤„ç†æ¢å¤å†…è´­</span></span><br><span class="line">                [[<span class="built_in">SKPaymentQueue</span> defaultQueue] finishTransaction: transaction];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h2 id="2-è¯·æ±‚å•†å“æ•°æ®"><a href="#2-è¯·æ±‚å•†å“æ•°æ®" class="headerlink" title="2. è¯·æ±‚å•†å“æ•°æ®"></a>2. è¯·æ±‚å•†å“æ•°æ®</h2><p>åœ¨å¼€å§‹è´­ä¹°ä¹‹å‰, æˆ‘ä»¬éœ€è¦çŸ¥é“å•†å“çš„æ•°æ®, æ¯”å¦‚ä»·æ ¼, æè¿°ä¹‹ç±»çš„, è¿™å°±éœ€è¦æˆ‘ä»¬å…ˆè¯·è¯·æ±‚å•†å“çš„æ•°æ®:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SKProductsRequest</span>* request = [[<span class="built_in">SKProductsRequest</span> alloc] initWithProductIdentifiers:@[<span class="string">@"com.xxx.xxx.01"</span>, <span class="string">@"com.xxx.xxx.02"</span>]];</span><br><span class="line">request.delegate = <span class="keyword">self</span>;</span><br><span class="line">[request start];</span><br></pre></td></tr></table></figure><p>ä¸Šé¢å°±æ˜¯è¯·æ±‚å•†å“çš„ä»£ç , å•†å“çš„ id åˆ—è¡¨æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±å‡†å¤‡çš„. è¯·æ±‚çš„ç»“æœä¼šé€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥é€šçŸ¥æˆ‘ä»¬, åŒæ ·æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªä»£ç† <code>SKProductsRequestDelegate</code>:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.h</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">IAPHelper</span> : <span class="title">NSObject</span> &lt;<span class="title">SKProductsRequestDelegate</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//.mm</span></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">IAPHelper</span></span></span><br><span class="line">- (<span class="keyword">void</span>)productsRequest:(<span class="built_in">SKProductsRequest</span> *)request didReceiveResponse:(<span class="built_in">SKProductsResponse</span> *)response &#123;</span><br><span class="line">    <span class="built_in">NSArray</span>* products = response.products;</span><br><span class="line">    <span class="comment">// products å°±æ˜¯å•†å“çš„åˆ—è¡¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h2 id="3-è´­ä¹°"><a href="#3-è´­ä¹°" class="headerlink" title="3. è´­ä¹°"></a>3. è´­ä¹°</h2><p>å‘èµ·ä¸€æ¬¡è´­ä¹°çš„é€»è¾‘:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SKPayment</span> *payment = [<span class="built_in">SKPayment</span> paymentWithProduct:<span class="string">@"com.xxx.xxx.01"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ([<span class="built_in">SKPaymentQueue</span> defaultQueue]) &#123;</span><br><span class="line">    [[<span class="built_in">SKPaymentQueue</span> defaultQueue] addPayment:payment];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±ä¼šè¿›å…¥åˆ°æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„é‚£ä¸ªå……å€¼çŠ¶æ€çš„ç›‘å¬é€»è¾‘ä¸­å».</p><h1 id="å……å€¼æµç¨‹çš„ä¼˜åŒ–"><a href="#å……å€¼æµç¨‹çš„ä¼˜åŒ–" class="headerlink" title="å……å€¼æµç¨‹çš„ä¼˜åŒ–"></a>å……å€¼æµç¨‹çš„ä¼˜åŒ–</h1><p>æµç¨‹æ–¹é¢, æˆ‘ä»¬å¤§æ¦‚ç»è¿‡äº†è¿™ä¹ˆä¸‹é¢å‡ ä¸ªé˜¶æ®µ.</p><h2 id="é‡ç”Ÿè›®é•¿çš„ç¬¬ä¸€é˜¶æ®µ"><a href="#é‡ç”Ÿè›®é•¿çš„ç¬¬ä¸€é˜¶æ®µ" class="headerlink" title="é‡ç”Ÿè›®é•¿çš„ç¬¬ä¸€é˜¶æ®µ"></a>é‡ç”Ÿè›®é•¿çš„ç¬¬ä¸€é˜¶æ®µ</h2><p>è¿™ä¸€é˜¶æ®µçš„ç‰¹å¾æ˜¯: <code>å…ˆå®Œæˆäº¤æ˜“, åå¤„ç†è®¢å•</code>, å¦‚æœä»”ç»†è§‚å¯Ÿä¸Šé¢ <code>updatedTransactions</code> çš„é€»è¾‘çš„è¯, å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ä¸€è¡Œä»£ç :</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">SKPaymentQueue</span> defaultQueue] finishTransaction: transaction];</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç çš„æ„ä¹‰å°±æ˜¯æ ‡è®°è¿™ä¸ªè®¢å•å·²ç»å®Œæˆäº†, è‹¹æœä»æ­¤ä»¥åä¸ä¼šå†å»é€šçŸ¥ä½ è¿™ä¸ªè®¢å•çš„ä»»ä½•æ¶ˆæ¯äº†. åœ¨è°ƒç”¨è¿™è¡Œä»£ç ä¹‹å‰, æˆ‘ä»¬ä¼šå»å¤„ç†ä¸€äº›å……å€¼ç»“æœçš„é€»è¾‘, å…¶ä¸­å……å€¼æˆåŠŸæˆ‘ä»¬æ˜¯è¦å»è‹¹æœéªŒè¯æ”¶æ®çš„.</p><p>ä½†æ˜¯éªŒè¯çš„è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„, æ‰€ä»¥å¯èƒ½å‘ç”Ÿçš„é—®é¢˜å°±æ˜¯:</p><blockquote><p>åœ¨éªŒè¯ç»“æœå›æ¥ä¹‹å‰å°±å…³é—­äº†è®¢å•.</p></blockquote><p>å› æ­¤è‹¥æ˜¯éªŒè¯çš„è¿‡ç¨‹ä¸å¤Ÿé¡ºåˆ©, æ¯”å¦‚ç½‘ç»œçŠ¶å†µä¸ä½³, åº”ç”¨æ„å¤–é€€å‡º, å°±ä¼šå¯¼è‡´ç©å®¶çš„è¿™æ¬¡å……å€¼æ²¡æœ‰åˆ°è´¦.</p><h2 id="å§‹æ–™ä¸åŠçš„ç¬¬äºŒé˜¶æ®µ"><a href="#å§‹æ–™ä¸åŠçš„ç¬¬äºŒé˜¶æ®µ" class="headerlink" title="å§‹æ–™ä¸åŠçš„ç¬¬äºŒé˜¶æ®µ"></a>å§‹æ–™ä¸åŠçš„ç¬¬äºŒé˜¶æ®µ</h2><p>æœ‰äº†ä¸Šé¢é‚£ä¸ªé—®é¢˜, æˆ‘ä»¬ä¸ç¦ä¼šæƒ³ ? æ˜¯ä¸æ˜¯å¯ä»¥ç­‰æ”¶åˆ°éªŒè¯ç»“æœå†å»å®Œæˆè®¢å•. ç­”æ¡ˆæ˜¯è‚¯å®šçš„, æˆ‘ä»¬ç¡®å®å¯ä»¥è¿™æ ·åš, è‹¹æœä¹Ÿå¾ˆä»ä¹‰, æ²¡æœ‰å®Œæˆçš„è®¢å•ä¼šåœ¨ä¸‹æ¬¡è¯·æ±‚å•†å“æ—¶å†æ¬¡é€šçŸ¥æˆ‘ä»¬å……å€¼æˆåŠŸ.</p><p>ç®€å•éªŒè¯ä¹‹å, æˆ‘ä»¬ä¿®æ”¹äº†å……å€¼çš„é€»è¾‘, ä¿¡å¿ƒæ»¡æ»¡çš„ä¸Šçº¿äº†. ä¸Šçº¿ä¹‹åˆç¡®å®å¾ˆé¡ºåˆ©, åé¦ˆå……å€¼ä¸åˆ°è´¦çš„ç©å®¶æ•°é‡é™ä½äº†å¾ˆå¤š, æˆ‘ä»¬éƒ½é™·å…¥äº†å·¨å¤§çš„å–œæ‚¦ä¹‹ä¸­, å†ä¹Ÿä¸ä¼šæœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦äº†, oh yeah ! </p><p>ç„¶å, åé¢å‘ç”Ÿçš„äº‹æƒ…å´æ˜¯æˆ‘ä»¬å§‹æ–™ä¸åŠçš„. æˆ‘ä»¬é™†ç»­æ”¶åˆ°äº†ç”¨æˆ·å£°æ³ªä¿±ä¸‹çš„æ§è¯‰, è‡ªå·±æ˜¯å¤šä¹ˆå¤šä¹ˆçš„çƒ­çˆ±è¿™æ¬¾æ¸¸æˆ, ä½†æ˜¯å´æ— æ³•äº«å—å……å€¼å¸¦æ¥çš„ä¹è¶£. èµ·åˆè¿˜åªæ˜¯å¯èƒ½ä¸åˆ°è´¦, ç°åœ¨åˆ™æ˜¯æŸä¸€ä¸ªå……å€¼é¡¹å®Œå…¨æ— æ³•è´­ä¹°.</p><p>åœ¨è¯¸å¤šç©å®¶çš„æ§è¯‰ä¸­, æˆ‘ä»¬é€æ¸è¿˜åŸäº†é—®é¢˜çš„æˆå› . æŸä¸€æ¬¡å……å€¼æˆåŠŸåæ¸¸æˆé‡å¯, æ²¡æœ‰æ”¶åˆ°é’»çŸ³, å†æ¬¡è´­ä¹°è¯¥å•†å“åˆ™ä¼šæç¤º:</p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1fgw9pxzo6ej206q04jt96.jpg" alt=""></p><blockquote><p>æ‚¨å·²è´­ä¹°æ­¤ App å†…è´­ä¹°é¡¹ç›®ã€‚æ­¤é¡¹ç›®å°†å…è´¹æ¢å¤ã€‚</p></blockquote><p>æ ¹æ®è¿™ä¸ªåé¦ˆå¯ä»¥å¾ˆè½»æ˜“çš„æ¨æ–­å‡ºæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ <code>finishTransaction</code> æŸä¸€ç¬”è®¢å•çš„åŸå› , ä½†æ˜¯å´å¾ˆéš¾é‡ç°ç©å®¶æ‰€é‡åˆ°çš„é—®é¢˜. æˆ‘ä»¬ä¹Ÿå¤ç°è¿‡è¿™ä¸ªé—®é¢˜, ä½†æ˜¯éƒ½èƒ½å¤Ÿåœ¨é‡å¯åè‡ªåŠ¨è§£å†³. æˆ‘ä»¬ä¹ŸåŠ äº†å¾ˆå¤šåŸ‹ç‚¹å»ç»Ÿè®¡ç©å®¶çš„æ—¥å¿—, å‘ç°ç©å®¶ä¼¼ä¹è¿›å…¥äº†ä¸€ä¸ªå¡å•çš„çŠ¶æ€, ç¨‹åºæ— æ³•è·å–åˆ°æŸäº›æœªå®Œæˆçš„è®¢å•.</p><p>è¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘ä»¬å¥½ä¹…, è€Œä¸”åé¦ˆçš„ç©å®¶è¶Šæ¥è¶Šå¤š, æœ‰çš„ç©å®¶ç”šè‡³å·²ç»æ²¡æœ‰å¯ä»¥èƒ½å¤Ÿè´­ä¹°çš„å•†å“äº†.</p><h2 id="é”®å…¥ä½³å¢ƒçš„ç¬¬ä¸‰é˜¶æ®µ"><a href="#é”®å…¥ä½³å¢ƒçš„ç¬¬ä¸‰é˜¶æ®µ" class="headerlink" title="é”®å…¥ä½³å¢ƒçš„ç¬¬ä¸‰é˜¶æ®µ"></a>é”®å…¥ä½³å¢ƒçš„ç¬¬ä¸‰é˜¶æ®µ</h2><p>è™½ç„¶ä¸Šé¢çš„é—®é¢˜æˆ‘ä»¬å¯ä»¥å°†é”…ç”©ç»™è‹¹æœ, ä½†æ˜¯å®åœ¨å—åˆ°æŸå¤±çš„æ˜¯æˆ‘ä»¬, å› æ­¤è¿˜æ˜¯éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜. ç»è¿‡è®¨è®ºä¹‹å, æˆ‘ä»¬å°†ç›®å…‰åˆè½¬å›äº†ç¬¬ä¸€é˜¶æ®µçš„æ–¹æ¡ˆ, çœ‹èƒ½å¦æ”¹è¿›å“ªä¸ªæ–¹æ¡ˆ. </p><blockquote><p>æˆ‘ä»¬å¯ä»¥å…ˆå°†è®¢å•æ•°æ®ä¿å­˜åœ¨æœ¬åœ°, ç„¶åå‘èµ·éªŒè¯è¯·æ±‚, å…³é—­è®¢å•, ç­‰éªŒè¯æˆåŠŸååˆ é™¤æœ¬åœ°ä¿å­˜çš„è®¢å•.</p></blockquote><p>ä¸‹æ¬¡å¯åŠ¨æ¸¸æˆæˆ–è€…å……å€¼æ—¶, æˆ‘ä»¬å¯ä»¥å…ˆæ£€æŸ¥ä¸‹æœ¬åœ°æ˜¯å¦æœ‰ç¼“å­˜çš„è®¢å•, æœ‰çš„è¯å°±å…ˆå°è¯•éªŒè¯è¿™ä¸ªè®¢å•. è™½ç„¶è¿˜æœ‰ä¸€äº›ç‘•ç–µ, æ¯”å¦‚ç©å®¶åˆ é™¤æ‰åº”ç”¨åå°±å†ä¹Ÿæ‰¾ä¸å›ä¹‹å‰çš„è®¢å•äº†, ä½†æ˜¯å·²ç»æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹æ¡ˆäº†.</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSString</span>*)getRecordTransaction</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#if USE_ICLOUD_STORAGE</span></span><br><span class="line">    <span class="built_in">NSUbiquitousKeyValueStore</span> *storage = [<span class="built_in">NSUbiquitousKeyValueStore</span> defaultStore];</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *storage = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSArray</span> *saved_transactions = [storage arrayForKey:<span class="string">@"transactions"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!saved_transactions or [saved_transactions count] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> nullptr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [saved_transactions objectAtIndex:<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)recordTransaction:(<span class="built_in">NSString</span> *)transaction</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#if USE_ICLOUD_STORAGE</span></span><br><span class="line">    <span class="built_in">NSUbiquitousKeyValueStore</span> *storage = [<span class="built_in">NSUbiquitousKeyValueStore</span> defaultStore];</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *storage = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSArray</span> *saved_transactions = [storage arrayForKey:<span class="string">@"transactions"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!saved_transactions) &#123;</span><br><span class="line">        <span class="comment">// Storing the first receipt</span></span><br><span class="line">        [storage setObject:@[transaction] forKey:<span class="string">@"transactions"</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Adding another receipt</span></span><br><span class="line">        <span class="built_in">NSArray</span> *updated_transactions = [saved_transactions arrayByAddingObject:transaction];</span><br><span class="line">        [storage setObject:updated_transactions forKey:<span class="string">@"transactions"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [storage synchronize];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeRecordTransaction:(<span class="built_in">NSString</span> *)purchase_id transactionId:(<span class="built_in">NSString</span>*) transaction_id</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#if USE_ICLOUD_STORAGE</span></span><br><span class="line">    <span class="built_in">NSUbiquitousKeyValueStore</span> *storage = [<span class="built_in">NSUbiquitousKeyValueStore</span> defaultStore];</span><br><span class="line"><span class="meta">#else</span></span><br><span class="line">    <span class="built_in">NSUserDefaults</span> *storage = [<span class="built_in">NSUserDefaults</span> standardUserDefaults];</span><br><span class="line"><span class="meta">#endif</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSMutableArray</span> *saved_transactions = [<span class="built_in">NSMutableArray</span> arrayWithArray:[storage arrayForKey:<span class="string">@"transactions"</span>]];</span><br><span class="line">    <span class="keyword">if</span> (!saved_transactions or [saved_transactions count] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span>* transaction <span class="keyword">in</span> saved_transactions) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([transaction rangeOfString:purchase_id].location != <span class="built_in">NSNotFound</span> and (not transaction_id or ([transaction rangeOfString:transaction_id].location != <span class="built_in">NSNotFound</span>))) &#123;</span><br><span class="line">            [saved_transactions removeObjectAtIndex:index];</span><br><span class="line">            [storage setObject:saved_transactions forKey:<span class="string">@"transactions"</span>];</span><br><span class="line">            [storage synchronize];</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        index = index + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å®ç°äº†å­˜å‚¨, è·å–, åˆ é™¤çš„é€»è¾‘, åªæ˜¯å‚æ•°æ˜¯ <code>NSString</code> ç±»å‹è€Œä¸æ˜¯ <code>SKPaymentTransaction</code>. å®ƒå…¶å®æ˜¯ Transaction çš„ä¸€äº›æœ‰ç”¨çš„æ•°æ®å’Œæˆ‘ä»¬è‡ªå·±çš„ä¸€äº›ä¿¡æ¯æ”¾çš„ä¸€ä¸ªåˆ°äº†ä¸€ä¸ª <code>NSDictionary</code> ä¸­, ç„¶åå°†è¿™ä¸ª dict è½¬åŒ–ä¸º json çš„å­—ç¬¦ä¸², è¿™æ ·åšæ˜¯ä¸ºäº†æ–¹ä¾¿å­˜å‚¨.</p><h2 id="é”¦ä¸Šæ·»èŠ±çš„ç¬¬å››é˜¶æ®µ"><a href="#é”¦ä¸Šæ·»èŠ±çš„ç¬¬å››é˜¶æ®µ" class="headerlink" title="é”¦ä¸Šæ·»èŠ±çš„ç¬¬å››é˜¶æ®µ"></a>é”¦ä¸Šæ·»èŠ±çš„ç¬¬å››é˜¶æ®µ</h2><p>å…¶å®ç¬¬ä¸‰é˜¶æ®µçš„é€»è¾‘å·²ç»å¾ˆä¸¥è°¨äº†, æˆ‘ä»¬ä¸ºäº†æ›´å¥½çš„äº†è§£ç©å®¶çš„å……å€¼è¡Œä¸º, åŠ äº†å¾ˆå¤šçš„æ—¥å¿—åœ¨è¿™é‡Œ:</p><ol><li>æˆ‘ä»¬å­˜ä¸‹äº†ç©å®¶çš„æ‰€æœ‰å……å€¼ç»“æœ, æˆåŠŸçš„, å¤±è´¥çš„, å–æ¶ˆçš„, å¼‚å¸¸çš„.</li><li>æˆ‘ä»¬å­˜ä¸‹äº†ç©å®¶åœ¨å……å€¼ç•Œé¢çš„å„ç§æ“ä½œ, æ¯”å¦‚ç‚¹å‡»æŒ‰é’®, ç•Œé¢è·³è½¬ç­‰.</li></ol><p>åœ¨åˆé€‚çš„æ—¶å€™, å°†è¿™äº›æ—¥å¿—å‘é€åˆ°æœåŠ¡å™¨. è¿™äº›æ—¥å¿—å°†ä¼šæˆä¸ºåé¢åˆ†æç©å®¶è¡Œä¸º, è§£å†³çº çº·çš„é‡è¦ä¾æ®.</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘ç”¨ ProcessOn åˆ¶ä½œäº†ä¸€ä¸ªå…¨æ–°çš„æµç¨‹å›¾, åœ°å€åœ¨<a href="https://www.processon.com/view/link/594e7af4e4b0ad619ac50bd4" target="_blank" rel="noopener">è¿™é‡Œ</a>:</p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1fgwqn64m5sj20ng09laai.jpg" alt=""></p><p>ç°åœ¨åœ¨å›ç­”ä¸‹ä¸Šé¢æå‡ºçš„å‡ ä¸ªé—®é¢˜:</p><h2 id="1-è¿”å›-Game-å±‚æ—¶å› ä¸ºå†…å­˜ä¸è¶³æ¸¸æˆé‡å¯äº†æ€ä¹ˆåŠ"><a href="#1-è¿”å›-Game-å±‚æ—¶å› ä¸ºå†…å­˜ä¸è¶³æ¸¸æˆé‡å¯äº†æ€ä¹ˆåŠ" class="headerlink" title="1. è¿”å› Game å±‚æ—¶å› ä¸ºå†…å­˜ä¸è¶³æ¸¸æˆé‡å¯äº†æ€ä¹ˆåŠ ?"></a>1. è¿”å› Game å±‚æ—¶å› ä¸ºå†…å­˜ä¸è¶³æ¸¸æˆé‡å¯äº†æ€ä¹ˆåŠ ?</h2><p>ç­”: æˆ‘ä»¬åœ¨æœ¬åœ°å­˜å‚¨äº†å……å€¼è®¢å•, æ¸¸æˆä¼šé‡å¯, ä½†è¿™ä¸ªæœ¬åœ°å­˜å‚¨ä¸ä¼šè‡ªåŠ¨åˆ é™¤.</p><h2 id="2-æœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦æ€ä¹ˆåŠ"><a href="#2-æœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦æ€ä¹ˆåŠ" class="headerlink" title="2. æœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦æ€ä¹ˆåŠ ?"></a>2. æœ‰ç©å®¶ååº”å……å€¼ä¸åˆ°è´¦æ€ä¹ˆåŠ ?</h2><p>ç­”: è¿™é‡Œæˆ‘ä»¬è¦è§£å†³ä¸¤ä¸ªé—®é¢˜:</p><ol><li>æ˜¯å¦çœŸçš„æ²¡æœ‰åˆ°è´¦ ?</li></ol><p>å¯èƒ½æ˜¯å®é™…å·²ç»åˆ°è´¦äº†, åªæ˜¯ç©å®¶æ²¡æœ‰å‘ç°, è¿™ä¸ªéœ€è¦åç«¯æŸ¥è¯¢ç©å®¶çš„é’»çŸ³å˜åŒ–åå‘ç©å®¶è§£é‡Šæ¸…æ¥š.</p><ol><li>æ˜¯å¦çœŸçš„å……å€¼æˆåŠŸ ?</li></ol><p>è¿™ä¸ªé¦–å…ˆè¦ç©å®¶æä¾›è‹¹æœå……å€¼æ”¶æ®é‚®ä»¶æˆªå›¾, ä½†æ˜¯è¿™ä¸ªæ˜¯å¯ä»¥ä¼ªé€ çš„, ä½†æ˜¯å¯ä»¥é˜»æŒ¡ä¸€éƒ¨åˆ†å¿ƒæ€€ä¸è½¨çš„ç©å®¶. å†æ ¹æ®æˆ‘ä»¬å‰é¢æ”¶é›†çš„æ—¥å¿—, åŠ ä¸Šè¿™ä¸ªè´¦å·å†å²è¡Œä¸ºä½œå‡ºä¸€ä¸ªåˆ¤æ–­, æ˜¯å¦è¦ç»™è¿™ä¸ªç©å®¶è¡¥å•.</p><h2 id="3-å¦‚ä½•é˜²-IAP-ç ´è§£"><a href="#3-å¦‚ä½•é˜²-IAP-ç ´è§£" class="headerlink" title="3. å¦‚ä½•é˜² IAP ç ´è§£ ?"></a>3. å¦‚ä½•é˜² IAP ç ´è§£ ?</h2><p>è¿™ä¸ªå¯¹äºç½‘æ¸¸æ¥è¯´, å¾ˆç®€å•, å°±åƒåœ¨æœåŠ¡å™¨ç«¯å‘è‹¹æœå……å€¼æœåŠ¡å™¨å‘èµ·éªŒè¯. éœ€è¦æ³¨æ„çš„æ˜¯: æœåŠ¡å™¨ç«¯åœ¨å‘è‹¹æœéªŒè¯æ”¶æ®æ—¶, ä¸€å®šè¦å…ˆæ£€æŸ¥<code>è®¢å•çš„å”¯ä¸€æ€§</code>, <code>å……å€¼æ—¶é—´</code>, <code>å•†å“id</code> æ˜¯å¦æ­£å¸¸.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹ iOS å†…è´­çš„æµç¨‹, è®©æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹çš„çš„æµç¨‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Art/remote_store_fetch_2x.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
      <category term="iOS" scheme="http://blog.justbilt.com/tags/iOS/"/>
    
      <category term="IAP" scheme="http://blog.justbilt.com/tags/IAP/"/>
    
  </entry>
  
  <entry>
    <title>Quick-cocos2d-x ä¸­çš„å¤šè¯­è¨€</title>
    <link href="http://blog.justbilt.com/2017/06/03/quick-x-i18n/"/>
    <id>http://blog.justbilt.com/2017/06/03/quick-x-i18n/</id>
    <published>2017-06-03T12:30:35.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®æœ¬æ¥æˆ‘çš„æ ‡é¢˜æ˜¯ â€œQuick-cocos2d-x ä¸­çš„å›½é™…åŒ–ä¸æœ¬åœ°åŒ–â€, å¤šè¯­è¨€è™½ç„¶æ˜¯å…¶ä¸­çš„ä¸»è¦å†…å®¹, ä½†è¿˜æœ‰å¾ˆå¤šé¢å¤–çš„å·¥ä½œ.</p><p>æ¯”å¦‚: åœ¨éŸ©å›½ä¸Šçº¿çš„æ¸¸æˆå¿…é¡»åœ¨æ¸¸æˆç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å¼¹å‡ºä¸€ä¸ªå†…å®¹ååˆ†é•¿çš„ç”¨æˆ·åè®®, ç”¨æˆ·åŒæ„åæ–¹å¯ç»§ç»­æ¸¸æˆ; æ¯”å¦‚å¾ˆå¤šèµŒåšæ€§è´¨çš„æ´»åŠ¨(æŠ½å¥–, æ‹‰éœ¸, è½¬ç›˜)éƒ½éœ€è¦ä¿®æ”¹ä¸ºå…¶ä»–è¡¨ç°å½¢å¼. è¿˜æœ‰ä¸€äº›æŠ€æœ¯æ–¹é¢çš„è¦æ±‚æ¯”å¦‚æ¸¸æˆç”¨æˆ·çš„æ•°æ®ä¸èƒ½å­˜åœ¨ cache ç›®å½•ä¸‹ç­‰ç­‰.</p><p>æ¯ä¸ªå›½å®¶å’Œåœ°åŒºçš„è¦æ±‚éƒ½ä¸å°½ç›¸åŒ, æœ‰çš„æ˜¯ç¡¬æ€§çš„æ³•å¾‹æ³•è§„è¦æ±‚, æœ‰çš„åˆ™æ˜¯ç…§é¡¾åˆ°å½“åœ°é£ä¿—ä¹ æƒ¯ä»¥æé«˜ç”¨æˆ·ä½“éªŒ. å½“ç„¶, è¿™äº›å¹¶ä¸åœ¨æˆ‘ä»¬è¿™æ¬¡è®¨è®ºèŒƒç•´ä¹‹å†…, ç­‰æˆ‘ä»¬çš„ç»å†è¶³å¤Ÿä¸°å¯Œä¹‹åå¯ä»¥å†æ¬¡å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹.</p><a id="more"></a><p>ä»Šå¤©, ä¸»è¦å’Œå¤§å®¶è¯´è¯´å¤šè¯­è¨€.</p><h1 id="ä¸€-ç­–ç•¥"><a href="#ä¸€-ç­–ç•¥" class="headerlink" title="ä¸€. ç­–ç•¥"></a>ä¸€. ç­–ç•¥</h1><h2 id="1-è¯­è¨€ä»£ç "><a href="#1-è¯­è¨€ä»£ç " class="headerlink" title="1. è¯­è¨€ä»£ç "></a>1. è¯­è¨€ä»£ç </h2><p>å°±æ˜¯ä¸åŒè¯­è¨€æˆ‘ä»¬éœ€è¦ä¸€ä¸ª id ä¸ä¹‹å¯¹åº”, è¿™ä¸ªæœ‰å¾ˆå¤šç§é€‰æ‹©, æˆ‘ä»¬é€‰æ‹©äº†<a href="https://msdn.microsoft.com/en-us/library/hh456380.aspx" target="_blank" rel="noopener">å¾®è½¯ç¿»è¯‘çš„ä»£ç </a>:</p><table><thead><tr><th>Language Code</th><th>English Name</th></tr></thead><tbody><tr><td>zh-CHS</td><td>Chinese Simplified</td></tr><tr><td>zh-CHT</td><td>Chinese Traditional</td></tr><tr><td>en</td><td>English</td></tr></tbody></table><h2 id="2-å¤šè¯­è¨€æ–‡æœ¬-id"><a href="#2-å¤šè¯­è¨€æ–‡æœ¬-id" class="headerlink" title="2. å¤šè¯­è¨€æ–‡æœ¬ id"></a>2. å¤šè¯­è¨€æ–‡æœ¬ id</h2><p>æˆ‘ä»¬çš„ç­–ç•¥å¾ˆç®€å•, æ¯ä¸€ä¸ªå¤šè¯­è¨€æ–‡æœ¬éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ id, æ¯ä¸€ä¸ªè¯­è¨€éƒ½æ˜¯ç”±å¤šä¸ª <code>id: text</code> ç»„æˆçš„ json æ–‡ä»¶, å¦‚ä¸‹æ‰€ç¤º:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"1493084502"</span>: <span class="string">"ç§¯åˆ†å…‘æ¢è¶…çº§å¤§å¥–"</span>,</span><br><span class="line">  <span class="attr">"1493084508"</span>: <span class="string">"[day]å¤©[hour]å°æ—¶åç»“æŸ"</span>,</span><br><span class="line">  <span class="attr">"1493172258"</span>: <span class="string">"æ´»åŠ¨ç§¯åˆ†"</span>,</span><br><span class="line">  <span class="attr">"1493723018"</span>: <span class="string">"7æ—¥æ´»åŠ¨ç§¯åˆ†"</span>,</span><br><span class="line">  <span class="attr">"1493731515"</span>: <span class="string">"è¯¥åŠŸèƒ½æš‚æœªå¼€å¯, è¯·è€å¿ƒç­‰å¾…."</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ¸¸æˆåˆå§‹åŒ–çš„æ—¶å€™é€‰æ‹©ä¸åŒè¯­è¨€çš„ json åŠ è½½, ç„¶åæœ‰ä¸€ä¸ªå‡½æ•° <code>tr</code> æ¥å— id è¿”å› text, è¿™å°±æ˜¯æˆ‘ä»¬å…¨éƒ¨çš„ç­–ç•¥. å°±æ˜¯è¿™ä¹ˆç®€å•çš„ç­–ç•¥, æˆ‘ä»¬ä¹Ÿè¸©äº†ä¸å°‘å‘.</p><p>æœ€å¼€å§‹, æˆ‘ä»¬æ˜¯æ‰“ç®—å¼„ä¸€ä¸ªè‡ªå¢çš„ id, æˆ‘ä»¬è§„å®šäº†ä¸€ä¸ªä» <code>100000</code> å¼€å§‹, æ¯æ¬¡è‡ªå¢ 10 è¿™æ ·çš„ä¸€ä¸ª id ç”Ÿæˆç­–ç•¥, ä¹‹æ‰€ä»¥è‡ªå¢ 10 æ˜¯è€ƒè™‘åˆ°æ’å…¥ id çš„éœ€æ±‚. æˆ‘ä»¬è‡ªä»¥ä¸ºè¿™ä¸ªç­–ç•¥å¾ˆé²æ£’, å´è¿˜æ˜¯æ ½äº†è·Ÿå¤´:</p><blockquote><p>åˆå¹¶æ—¶ä¼šå†²çª</p></blockquote><p>æˆ‘ä»¬ä¸åŒçš„åŠŸèƒ½æ˜¯åœ¨ä¸åŒçš„åˆ†æ”¯ä¸Šåšçš„, å®Œæˆä¹‹åä¼šåˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¸Š. å¤§å®¶åœ¨ä¸åŒçš„åˆ†æ”¯ä¸Šå¼€å‘ä¸åŒçš„åŠŸèƒ½æ—¶, æ²¡æœ‰è€ƒè™‘åˆ°å¤šè¯­è¨€åæœŸåˆå¹¶å†²çªçš„é—®é¢˜, è€Œä¸”è¿™ä¸ªå†²çªè§£å†³èµ·æ¥å¾ˆéº»çƒ¦, å¾—ä¸ºå†²çªä¸­çš„ä¸€æ–¹åˆ†é…æ–°çš„ id, è¿˜å¾—å°†ä»£ç ä¸­çš„ id éƒ½æ›¿æ¢æ‰, è¿™ä¸ªè¿‡ç¨‹æ˜¯ååˆ†å®¹æ˜“å‡ºé”™çš„. æ€ä¹ˆåŠ ?</p><p>æˆ‘ä»¬ä¹Ÿæƒ³è¿‡è§„å®šä¸åŒçš„ id åŒºé—´, ä¸åŒçš„æ¨¡å—æœ‰ç€ä¸åŒçš„ id èµ·å§‹å€¼, è¿™æ ·è™½ç„¶ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†æ¨¡å—é—´å†²çªçš„é—®é¢˜, å°±ç®—å¿½ç•¥è§„å®šè¿™ä¸ª id èµ·å§‹å€¼æ‰€å¸¦æ¥çš„é¢å¤–å·¥ä½œ, å¤šäººåä½œçš„åŒä¸€æ¨¡å—æ€ä¹ˆåŠ ? å°ä¼™ä¼´ä»¬æ˜¯ä¸æ˜¯è¿˜å¾—æå¿ƒåŠèƒ†, å°å¿ƒç¿¼ç¿¼çš„å·¥ä½œ ? è¿™å¯ä¸æ˜¯æˆ‘ä»¬çš„é£æ ¼.</p><p>å°±åœ¨æˆ‘ä¸€ç­¹è«å±•çš„æ—¶å€™, æˆ‘å¶ç„¶é—´å‘ç°äº†ä¸€ä¸ªä¸œè¥¿: <code>æ—¶é—´æˆ³</code>, æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªåš id å‘€ ! è™½ç„¶ç†è®ºä¸Šè¿˜æ˜¯æœ‰å¯èƒ½å†²çª, ä½†æ˜¯ä¸¤ä¸ªå¤šè¯­è¨€ id åœ¨åŒä¸€ç§’å†…ç”Ÿæˆçš„æ¦‚ç‡åˆèƒ½æœ‰å¤šé«˜å‘¢ ?    </p><p>è¿™é‡Œè¿˜è¦è¯´è¯´ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡ç”¨ä½¿ç”¨ <strong>è‹±æ–‡æ„ä¹‰</strong> ä½œä¸º id å‘¢ ? è¯šç„¶è‹±æ–‡ id æœ‰æ›´é«˜çš„å¯è¯»æ€§, æœ‰ä¸¤ä¸ªåŸå› å¯¼è‡´æˆ‘æ²¡æœ‰é€‰æ‹©å®ƒ:</p><ol><li>å°ä¼™ä¼´ä»¬çš„è‹±æ–‡æ°´å¹³å‚å·®ä¸é½, å¦‚æœä½¿ç”¨è‹±æ–‡ id çš„è¯, å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°è¯ä¸è¾¾æ„çš„æƒ…å†µ, åè€Œé™ä½å¯è¯»æ€§.</li><li>ä¸€ä¸ª id æ‰€ä»£è¡¨æ„æ€å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–, å¦‚æœå˜äº†, æ˜¯å¦è¦ä¿®æ”¹æ‰€æœ‰çš„å¼•ç”¨å‘¢ ?</li></ol><h2 id="3-å ä½ç¬¦ä¸æ ¼å¼åŒ–"><a href="#3-å ä½ç¬¦ä¸æ ¼å¼åŒ–" class="headerlink" title="3. å ä½ç¬¦ä¸æ ¼å¼åŒ–"></a>3. å ä½ç¬¦ä¸æ ¼å¼åŒ–</h2><p>æˆ‘ä»¬ä¸€å¼€å§‹ä¹Ÿæ˜¯ä½¿ç”¨ <code>%d</code> <code>%s</code> ä¹‹ç±»çš„ä¸œè¥¿åšå ä½ç¬¦, ä½†æ˜¯è¿™äº›ä¸œè¥¿æ˜¯ä¸¥æ ¼ä»¥æ¥å ä½ç¬¦åŠå‚æ•°çš„é¡ºåºæ¥æ›¿æ¢çš„, è€ŒåŒä¸€ä¸ªå ä½ç¬¦åœ¨ä¸åŒè¯­è¨€ä¸­çš„çš„ä½ç½®å¯èƒ½æ˜¯ä¸åŒçš„. æ¯”å¦‚:</p><blockquote><p>ä¸­æ–‡: â€œå†›å®˜ç»Ÿå¾¡ç­‰çº§æ¯å¢åŠ  %d(1)ï¼Œå¢åŠ å¸¦å…µé‡ %d(10)â€<br>è‹±æ–‡: â€œThe size of the troop increase %d(10) by officerâ€™s Command Level increase %d(1)â€</p></blockquote><p>å¤§å®¶å¯ä»¥çœ‹åˆ°, è¿™ä¸¤ç§è¯­è¨€ä¸‹ä¸¤ä¸ªå ä½ç¬¦çš„é¡ºåºæ˜¯å®Œå…¨ç›¸åçš„. å¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹å¼æ¥çš„è¯, å°±ä¼šå¯¹ç©å®¶é€ æˆè¯¯è§£. é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢?</p><blockquote><p>ä¸­æ–‡: â€œå†›å®˜ç»Ÿå¾¡ç­‰çº§æ¯å¢åŠ  [lv](1)ï¼Œå¢åŠ å¸¦å…µé‡ [amount](10)â€œ<br>è‹±æ–‡: â€œThe size of the troop increase [amount](10) by officerâ€™s Command Level increase [lv](1)â€œ</p></blockquote><p>æˆ‘ä»¬ä½¿ç”¨<code>æ˜ç¡®æ„ä¹‰çš„å ä½ç¬¦</code>æ¥å ä½.</p><h2 id="4-å›¾ç‰‡çš„å¤šè¯­è¨€"><a href="#4-å›¾ç‰‡çš„å¤šè¯­è¨€" class="headerlink" title="4. å›¾ç‰‡çš„å¤šè¯­è¨€"></a>4. å›¾ç‰‡çš„å¤šè¯­è¨€</h2><p>æˆ‘åœ¨ä¸€ç¯‡æ–‡ç« ä¸­çœ‹åˆ°è¯´è¦å°½å¯èƒ½çš„é¿å…ä½¿ç”¨å¸¦æœ‰æ–‡å­—çš„å›¾ç‰‡, ä½†æ˜¯è¿™ç§éœ€æ±‚æ˜¯æ— æ³•é¿å…çš„. å¦‚æœå®ç°ä¸åŒè¯­è¨€ä¸‹ç”¨ä¸åŒçš„å›¾ç‰‡å‘¢ ? æˆ‘ä»¬çš„åšæ³•æ˜¯ç»™è¿™ä¸ªå›¾ç‰‡çš„å‘½åä¸­åŠ å…¥æ ‡è®°, æ ‡è®°è¿™æ˜¯ä¸€ä¸ªå¤šè¯­è¨€å›¾ç‰‡, åœ¨é€šè¿‡ä¸€ä¸ªå‡½æ•°æ¥è·å¾—çœŸæ­£çš„å›¾ç‰‡è·¯å¾„.</p><p>ä¾‹å¦‚: æœ‰ä¸€ä¸ªå›¾ç‰‡çš„è·¯å¾„æ˜¯ <code>images/logo.png</code>, æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸º <code>images/logo[zh-CHS].png</code>, æ ‡è®°è¿™æ˜¯ä¸€ä¸ªä¸­æ–‡ä¸‹çš„å›¾ç‰‡, åŒç†ä¼šæœ‰ä¸€ä¸ª <code>images/logo[en].png</code>. çœŸæ­£åŠ è½½å›¾ç‰‡çš„æ—¶å€™, ä¼šé€šè¿‡å‡½æ•°æ›¿æ¢ä½¿ç”¨å½“å‰è¯­è¨€æ›¿æ¢æ‰é‡Œé¢çš„å ä½ç¬¦.</p><h1 id="äºŒ-ä»£ç æ”¯æŒ"><a href="#äºŒ-ä»£ç æ”¯æŒ" class="headerlink" title="äºŒ. ä»£ç æ”¯æŒ"></a>äºŒ. ä»£ç æ”¯æŒ</h1><h2 id="1-å½“å‰è¯­è¨€çš„ç¡®å®š"><a href="#1-å½“å‰è¯­è¨€çš„ç¡®å®š" class="headerlink" title="1. å½“å‰è¯­è¨€çš„ç¡®å®š"></a>1. å½“å‰è¯­è¨€çš„ç¡®å®š</h2><p>ä¸€å¼€å§‹æˆ‘ä»¬æ˜¯ç›´æ¥ä½¿ç”¨çš„ <code>device.language</code> æ¥ç¡®å®šå½“å‰è¯­è¨€çš„, ä½†å®é™…æƒ…å†µè¦å¤æ‚çš„å¤š. </p><h3 id="1-è¯­è¨€æ®‹ç¼º"><a href="#1-è¯­è¨€æ®‹ç¼º" class="headerlink" title="1). è¯­è¨€æ®‹ç¼º"></a>1). è¯­è¨€æ®‹ç¼º</h3><p>cocos é»˜è®¤åªæ”¯æŒ<strong>cnï¼šä¸­æ–‡, frï¼šæ³•è¯­, itï¼šæ„å¤§åˆ©è¯­, grï¼šå¾·è¯­, spï¼šè¥¿ç­ç‰™è¯­, ruï¼šä¿„è¯­, jpï¼šæ—¥è¯­, enï¼šè‹±è¯­</strong> è¿™å‡ ç§è¯­è¨€, å¦‚æœæˆ‘ä»¬è¦æ”¯æŒä¸€ä¸ªè¿™é‡Œé¢æ²¡æœ‰çš„è¯­è¨€æ€ä¹ˆåŠ ?</p><p>æˆ‘ä»¬éœ€è¦åˆ†åˆ«ä» Android å’Œ iOS å“ªé‡Œè·å–åˆ°è®¾å¤‡çš„å½“å‰è¯­è¨€ <code>language code</code>, ç„¶ååœ¨ lua ä¸­è¿›è¡Œåˆ¤æ–­.</p><p>Android:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getLanguageCode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Locale.getDefault().toString();&#125;</span><br></pre></td></tr></table></figure><p>iOS:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span>* language_code = [[<span class="built_in">NSLocale</span> preferredLanguages] objectAtIndex:<span class="number">0</span>];</span><br></pre></td></tr></table></figure><h3 id="2-ç®€ä½“-ç¹ä½“çš„ç¡®å®š"><a href="#2-ç®€ä½“-ç¹ä½“çš„ç¡®å®š" class="headerlink" title="2). ç®€ä½“/ç¹ä½“çš„ç¡®å®š"></a>2). ç®€ä½“/ç¹ä½“çš„ç¡®å®š</h3><p>è¿™ä¸ªç¡®å®å€¼å¾—æ‹¿å‡ºæ¥ä¸€è¯´, è¿™ä¸ª language_code å…¶å®æ˜¯æœ‰ä¸€å¥—æ ‡å‡†çš„, ä½†è¿™ä¸ªæ ‡å‡†æœ‰å¥½å‡ ä¸ªç‰ˆæœ¬, Android å’Œ iOS è¿”å›çš„å¯èƒ½ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†, iOS ä¸åŒç‰ˆæœ¬å¯èƒ½è¿”å›çš„ä¸æ˜¯åŒä¸€ä¸ªæ ‡å‡†, cocos åŸç”Ÿçš„é‚£ä¸ªå†™æ³•å®é™…ä¸Šæ˜¯æœ‰æ¼æ´çš„, å°±ä¸­æ–‡æ¥è¯´ä¼šæœ‰è¿™ä¹ˆå‡ ä¸ªå†™æ³•:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zh-CHS, zh-Hans, zh-CHT, zh-Hant, zh-cn, zh-tw, , zh-mo, zh-sg, zh-hk</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæˆ‘ä»¬éœ€è¦æŠŠè¿™äº›å¯èƒ½è½¬åŒ–ä¸ºä¸¤ç§ <code>ç®€ä½“/ç¹ä½“</code>, æˆ‘ä»¬æ˜¯è¿™ä¹ˆåšçš„:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> language = language_code</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">string</span>.startswith(language, <span class="string">"zh"</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">find</span>(language,<span class="string">"Hans"</span>) <span class="keyword">then</span></span><br><span class="line">        language = <span class="string">"zh-CHS"</span></span><br><span class="line">    <span class="keyword">elseif</span> <span class="built_in">string</span>.<span class="built_in">find</span>(language,<span class="string">"Hant"</span>) <span class="keyword">then</span></span><br><span class="line">        language = <span class="string">"zh-CHT"</span></span><br><span class="line">    <span class="keyword">elseif</span> <span class="built_in">string</span>.<span class="built_in">find</span>(language,<span class="string">"TW"</span>) <span class="keyword">then</span></span><br><span class="line">        language = <span class="string">"zh-CHT"</span></span><br><span class="line">    <span class="keyword">elseif</span> language == <span class="string">"zh-cn"</span> <span class="keyword">or</span> language == <span class="string">"zh-mo"</span> <span class="keyword">or</span> language == <span class="string">"zh-sg"</span> <span class="keyword">then</span></span><br><span class="line">        language = <span class="string">"zh-CHS"</span></span><br><span class="line">    <span class="keyword">elseif</span> language == <span class="string">"zh-hk"</span> <span class="keyword">or</span> language == <span class="string">"zh-tw"</span> <span class="keyword">then</span></span><br><span class="line">        language = <span class="string">"zh-CHT"</span>    </span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        language = <span class="string">"zh-CHS"</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>åŒç†, ä¸å…‰ä¸­æ–‡æ˜¯è¿™æ ·çš„, è‹±æ–‡ä¹ŸåŒæ ·æœ‰å¾ˆå¤šæ–¹è¨€. æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç”¨ <code>==</code> æ¥åˆ¤æ–­æŸä¸ªè¯­è¨€, è¦ç”¨ <code>startswith</code> .</p><h3 id="3-è€ƒè™‘æ”¯æŒçš„è¯­è¨€åˆ—è¡¨å’Œç©å®¶å­˜æ¡£"><a href="#3-è€ƒè™‘æ”¯æŒçš„è¯­è¨€åˆ—è¡¨å’Œç©å®¶å­˜æ¡£" class="headerlink" title="3). è€ƒè™‘æ”¯æŒçš„è¯­è¨€åˆ—è¡¨å’Œç©å®¶å­˜æ¡£"></a>3). è€ƒè™‘æ”¯æŒçš„è¯­è¨€åˆ—è¡¨å’Œç©å®¶å­˜æ¡£</h3><p>è¦è€ƒè™‘è¿™ä¹ˆä¸¤ä¸ªé—®é¢˜, é€šè¿‡ä¸Šä¸€æ­¥è·å–åˆ°ä¸€ä¸ªä½ ä¸æ”¯æŒçš„è¯­è¨€æ€ä¹ˆåŠ? æˆ‘ä»¬çš„åšæ³•æ˜¯å£°æ˜ä¸€ä¸ªé»˜è®¤è¯­è¨€<em>(è‹±è¯­)</em>, æŸä¸ªè¯­è¨€ä¸æ”¯æŒå°±ç”¨è¿™ä¸ªè¯­è¨€.</p><p>åŒæ—¶å¦‚æœæ¸¸æˆå†…æœ‰é€‰æ‹©è¯­è¨€åŠŸèƒ½çš„è¯, æˆ‘ä»¬è¦ä¼˜å…ˆä½¿ç”¨ç©å®¶é€‰æ‹©çš„è¯­è¨€.</p><p>å£°æ˜æ”¯æŒçš„è¯­è¨€:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">platform.language_support = </span><br><span class="line">&#123;</span><br><span class="line">  default = flavor.language.en,</span><br><span class="line">  support_list = &#123;</span><br><span class="line">    flavor.language.en,</span><br><span class="line">    flavor.language.zh_chs,</span><br><span class="line">    flavor.language.zh_cht,</span><br><span class="line">    flavor.language.ar,</span><br><span class="line">    flavor.language.ko,</span><br><span class="line">    flavor.language.th,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­è¯­è¨€:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> #(platform.language_support.support_list) &gt;= <span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">    platform.language = Record.getLanguage()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">table</span>.contain(platform.language_support.support_list, platform.language) <span class="keyword">then</span></span><br><span class="line">      platform.language = platform.language_support.default</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  platform.language = platform.language_support.default</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h2 id="2-tr"><a href="#2-tr" class="headerlink" title="2. tr"></a>2. tr</h2><p>tr å°±æ˜¯æ ¹æ® id è¿”å›çœŸæ­£æ–‡æœ¬çš„å‡½æ•°:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> text = json.decode(<span class="built_in">io</span>.readfile(cc.FileUtils:getInstance():fullPathForFilename((<span class="string">"native/"</span>..platform.language..<span class="string">".json"</span>))))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tr</span><span class="params">(_key)</span></span></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> _key <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">"???"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">return</span> text[<span class="built_in">tostring</span>(_key)] <span class="keyword">or</span> <span class="string">"404:"</span>..<span class="built_in">tostring</span>(_key)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•, è¿˜æœ‰ä¸€äº›å¯ä»¥æ‹“å±•çš„ç©ºé—´, æ¯”å¦‚æœ€è¿‘å‘ç°çš„åŒä¸€ä¸ªä¸­æ–‡å¦‚ä½•å¯¹åº”ä¸åŒ case è‹±æ–‡çš„é—®é¢˜. ä¸¾ä¸ªæ —å­: é“å…·çš„è‹±æ–‡æ˜¯ <code>item</code>, æˆ‘ä»¬å¯èƒ½å¾ˆå¤šåœ°æ–¹éƒ½ä¼šç”¨åˆ°è¿™ä¸ªå•è¯, ä½†æ˜¯ä¸åŒçš„åœ°æ–¹å¯èƒ½ä¼šæœ‰ä¸€äº›å°çš„åŒºåˆ«:</p><ol><li>ä¸»ç•Œé¢å…¥å£ä¸Šéœ€è¦æ˜¾ç¤ºä¸ºå…¨å¤§å†™: ITEM</li><li>è¡Œé¦–çš„æ‹¼æ¥éœ€è¦é¦–å­—æ¯å¤§å†™: Item</li><li>è¡Œä¸­çš„æ‹¼æ¥éœ€è¦å…¨å°å†™: item</li></ol><p>è¿™ä¸ªéš¾é“è¦å¤šç”¨å¥½å‡ ä¸ª id æ¥å®ç°å— ? æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>tr</code> çš„ç¬¬äºŒä¸ªå‚æ•°æ¥æŒ‡å®šæ ¼å¼. </p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tr(<span class="number">10000</span>, <span class="string">"upper"</span>) <span class="comment">-- å¤§å†™</span></span><br><span class="line">tr(<span class="number">10000</span>, <span class="string">"title"</span>) <span class="comment">-- é¦–å­—æ¯å¤§å†™</span></span><br><span class="line">tr(<span class="number">10000</span>) <span class="comment">-- å°å†™</span></span><br></pre></td></tr></table></figure><p>å†…éƒ¨å†å¤„ç†ä¸‹è¿™ä¸ªå‚æ•°å°±å¯ä»¥å®ç°åŒä¸€ä¸ªä¸­æ–‡å¯¹åº”ä¸åŒçš„è‹±æ–‡äº†.</p><h2 id="3-formatex"><a href="#3-formatex" class="headerlink" title="3. formatex"></a>3. formatex</h2><p>ä¸Šé¢è¯´è¿‡æœ‰ä¸€ä¸ªå‡½æ•°æ›¿æ¢å ä½ç¬¦, å…¶å®ç°å¦‚ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">string.formatex</span><span class="params">(format, map)</span></span></span><br><span class="line">    <span class="built_in">format</span> = <span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="built_in">format</span>, <span class="string">"%[(.-)]"</span>, map)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">format</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- example</span></span><br><span class="line"><span class="built_in">string</span>.formatex(<span class="string">"[attacker]ç äº†[defender]ä¸€åˆ€, é€ æˆäº†[damage]ä¼¤å®³"</span>, &#123;</span><br><span class="line">  attacker = <span class="string">"å¼ ä¸‰"</span>,</span><br><span class="line">  defender = <span class="string">"æå››"</span>,</span><br><span class="line">  damage = <span class="number">10</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¾ˆæ–¹ä¾¿çš„æœ‰æœ¨æœ‰ ?</p><h1 id="ä¸‰-UI-çš„é€‚é…"><a href="#ä¸‰-UI-çš„é€‚é…" class="headerlink" title="ä¸‰. UI çš„é€‚é…"></a>ä¸‰. UI çš„é€‚é…</h1><h2 id="1-å¤šä¸ªæ¨ªå‘æ’ç‰ˆ-Label"><a href="#1-å¤šä¸ªæ¨ªå‘æ’ç‰ˆ-Label" class="headerlink" title="1. å¤šä¸ªæ¨ªå‘æ’ç‰ˆ Label"></a>1. å¤šä¸ªæ¨ªå‘æ’ç‰ˆ Label</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸¤å¼ å›¾:</p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1fgo6l8umlkj20u007p759.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1fgo6o3ya7xj20u007pab6.jpg" alt=""></p><p>ä¸Šå›¾ä¸­çš„å·¦ä¾§çš„ Label åœ¨ä¸åŒè¯­è¨€ä¸‹çš„å®½åº¦æ˜¯ä¸ä¸€æ ·çš„, å¦‚æœæˆ‘ä»¬ä¸æƒ³åœ¨ä»£ç ä¸­æ‰‹åŠ¨è°ƒæ•´çš„è¯æœ‰è¿™ä¹ˆå‡ ä¸ªåŠæ³•:</p><ol><li>ä½¿ç”¨ä¸€ä¸ªå®¹å™¨å­˜æ”¾å¤šä¸ª Label, å®¹å™¨ä¼šè‡ªåŠ¨æ’ç‰ˆå¤šä¸ªå…ƒç´ çš„ä½ç½®</li><li>åœ¨ç¼–è¾‘ UI æ—¶å°±é¢„ç•™å¥½å¯ä¸€å®šçš„ç©ºé—´</li><li>å¦‚æœåªæœ‰ä¸¤ä¸ª Lable çš„è¯, å·¦ä¾§çš„å³å¯¹é½, å³ä¾§çš„å·¦å¯¹é½</li></ol><h2 id="2-Label-Overflow"><a href="#2-Label-Overflow" class="headerlink" title="2. Label Overflow"></a>2. Label Overflow</h2><p>è¿™ä¸ªæ¦‚å¿µæ˜¯ä» Cocos Creater å“ªé‡Œæ‰¾åˆ°çš„, å¦‚æœä¸€ä¸ª Label çš„å®é™…å°ºå¯¸è¶…å‡ºäº†å…¶åœ¨ UI ç¼–è¾‘æ—¶è®¾å®šçš„æœ€å¤§èŒƒå›´çš„è¯å¦‚ä½•å¤„ç†å‘¢ ?</p><ol><li>ç¼©å° Lable çš„å­—ä½“å°ºå¯¸</li><li>å¤šä½™çš„å­ä½¿ç”¨ â€¦ ä»£æ›¿</li><li>å¢å¤§ Label çš„é«˜åº¦</li></ol><p>æˆ‘åœ¨ Quick-x æäº†ä¸€ä¸ªå¾ˆç®€é™‹çš„å®ç°, åŸç†å°±æ˜¯å¼„ä¸€ä¸ªæ­»å¾ªç¯, åˆ¤æ–­å°ºå¯¸è¶…äº†å°±ç¼©å°ä¸€ä¸ªå•ä½, ä½†æ˜¯æ•ˆç‡ä¸é«˜, å°±ä¸è´´å®ç°äº†. </p><h2 id="3-é˜¿æ‹‰ä¼¯è¯­çš„é€‚é…"><a href="#3-é˜¿æ‹‰ä¼¯è¯­çš„é€‚é…" class="headerlink" title="3. é˜¿æ‹‰ä¼¯è¯­çš„é€‚é…"></a>3. é˜¿æ‹‰ä¼¯è¯­çš„é€‚é…</h2><p>å¤§å®¶éƒ½çŸ¥é“é˜¿æ‹‰ä¼¯è¯­çš„é˜…è¯»é¡ºåºæ˜¯ä»å³å¾€å·¦çš„, å› æ­¤æˆ‘ä»¬çš„ UI æœ€å¥½ä¹Ÿèƒ½æ˜¯ä»å³å¾€å·¦çš„. ä½†æ˜¯é™¤éä»ç«‹é¡¹ä¸€å¼€å§‹å°±æ–™æƒ³åˆ°äº†è¿™ä¸€ç‚¹, å¦åˆ™æ›´æ”¹å…¨éƒ¨ UI æ˜¯ä¸ç°å®çš„. </p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹éƒ¨åˆ† UI, å¦‚ä¸Šé¢æˆ‘ä»¬è¯´çš„ <strong>æ¨ªå‘æ’åˆ—çš„å¤šä¸ªUI</strong> , å¦‚æœæˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªå®¹å™¨æ¥å®ç°çš„è¯, é‚£ä¹ˆå¾ˆå®¹æ˜“çš„å®ç°å®¹å™¨å†…çš„å…ƒç´ é¡ºåºé€†è½¬.</p><p>æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæ€è·¯å®ç°äº†ä¸€ä¸ª BoxLayout , åœ¨é˜¿è¯­ä¸‹ layout æ—¶ä¼šä»å…ƒç´ çš„æœ€åä¸€ä¸ªå¼€å§‹, åå‘æ’ç‰ˆ.</p><p>å¦å¤–ä¸€ä¸ªç‰¹æ®Šå¤„ç†å°±æ˜¯ RichLabel, æˆ‘ä»¬è‡ªå·±å®ç°äº†ä¸€ä¸ªæŒ‰å­—ç¬¦éå†çš„å¯Œæ–‡æœ¬. ä½†æ˜¯é˜¿è¯­ä¸‹è¿™ä¸ªå®ç°å‡ ä¹å˜å¾—ä¸å¯ç”¨, äºæ˜¯åœ¨é˜¿è¯­ä¸‹æˆ‘ä»¬ä½¿ç”¨æ™®é€šæ–‡æœ¬æ¥æ›¿æ¢äº†å¯Œæ–‡æœ¬.</p><h1 id="ä¸‰-å¤–éƒ¨å·¥å…·"><a href="#ä¸‰-å¤–éƒ¨å·¥å…·" class="headerlink" title="ä¸‰. å¤–éƒ¨å·¥å…·"></a>ä¸‰. å¤–éƒ¨å·¥å…·</h1><h2 id="1-å¤šè¯­è¨€è½¬æ¢å·¥å…·"><a href="#1-å¤šè¯­è¨€è½¬æ¢å·¥å…·" class="headerlink" title="1. å¤šè¯­è¨€è½¬æ¢å·¥å…·"></a>1. å¤šè¯­è¨€è½¬æ¢å·¥å…·</h2><p>json ä½œä¸ºç¨‹åºè¯»å–çš„æ ¼å¼æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„, ä½†æ˜¯ç”¨æ¥ç»™ç¿»è¯‘äººå‘˜æ¥ç¿»è¯‘å°±å¾ˆä¸æ–¹ä¾¿äº†, excel åˆ™æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©. å› æ­¤æˆ‘ä»¬å®ç°äº†ä¸€å¥— <code>json &gt; excel</code> å’Œ <code>excel &gt; json</code> å·¥å…·ç”¨æ¥åšè¿™ä¸ªè½¬æ¢.</p><p>åŒæ—¶, ä¸ºäº†èƒ½æ›´é«˜æ•ˆçš„å¤„ç†å„ç§éœ€æ±‚, æˆ‘ä»¬è¿˜æœ‰ diff, format, deduplicate å·¥å…·.</p><h2 id="2-å¤šè¯­è¨€æå–å·¥å…·"><a href="#2-å¤šè¯­è¨€æå–å·¥å…·" class="headerlink" title="2. å¤šè¯­è¨€æå–å·¥å…·"></a>2. å¤šè¯­è¨€æå–å·¥å…·</h2><p>æˆ‘ä»¬çš„å¤šè¯­è¨€æœ‰å¾ˆå¤šæ˜¯é…ç½®åœ¨ excel ä¸­çš„, è¿™äº› excel æœ€ç»ˆä¼šè½¬æ¢ä¸ºæ¸¸æˆçš„é™æ€é…ç½®, æˆ‘ä»¬å¸Œæœ›æœ€ç»ˆåœ¨æ¸¸æˆä¸­è¯»å–çš„ä¸€ä¸ªå¤šè¯­è¨€çš„ id, è€Œä¸æ˜¯ä¸€ä¸²æ–‡æœ¬. è¿™æ ·åšèƒ½å¤Ÿé™ä½é™æ€é…ç½®çš„æ–‡ä»¶å¤§å°, å› ä¸ºæˆ‘ä»¬çš„æ–‡æœ¬æœ‰å¾ˆå¤šæ˜¯é‡å¤çš„.</p><p>å› æ­¤æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªæŠ½å–å·¥å…·, èƒ½å¤Ÿä¸º excel ä¸­çš„æ–‡æœ¬æ‰“ä¸Šæ ‡è®°, è¿™æ ·åœ¨è½¬æ¢çš„è¿‡ç¨‹ä¸­å°±å¯ä»¥ä½¿ç”¨ id, è€Œä¸æ˜¯æ–‡æœ¬äº†. æ•ˆæœå¦‚ä¸‹å›¾, # å‰æ˜¯æ–‡æœ¬, åé¢æ˜¯ id:</p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1fgp3n582xwj205902hgld.jpg" alt=""></p><p>æˆ‘ä»¬ç”¨çš„ç¼–è¾‘å™¨ CocosBuilder , å¾ˆå¤è€çš„ä¸€ä¸ª UI ç¼–è¾‘å™¨, å› æ­¤ä¹Ÿæ²¡æœ‰å¤šè¯­è¨€çš„åŠŸèƒ½, æ‰€ä»¥æˆ‘ä»¬åšäº†ä¸€ä¸ªä» ccb ä¸­æå–å¤šè¯­è¨€çš„å·¥å…·. ccb æœ¬èº«æ˜¯ä¸€ä¸ª plist çš„æ–‡ä»¶ç»“æ„, å¾ˆå¤šè¯­è¨€éƒ½æœ‰å¯¹åº”çš„è§£æåº“, å†™èµ·æ¥å¾ˆå®¹æ˜“.</p><hr><p>å‚è€ƒèµ„æ–™:</p><ol><li><a href="https://zh.wikipedia.org/wiki/ISO_639" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/ISO_639</a></li><li><a href="https://www.zhihu.com/question/20797118" target="_blank" rel="noopener">https://www.zhihu.com/question/20797118</a></li><li><a href="http://www.gameres.com/thread_480715_1_1.html" target="_blank" rel="noopener">http://www.gameres.com/thread_480715_1_1.html</a> (å‰è¾ˆçš„è¸©å‘æŒ‡å—, æ¨èé˜…è¯»)</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¶å®æœ¬æ¥æˆ‘çš„æ ‡é¢˜æ˜¯ â€œQuick-cocos2d-x ä¸­çš„å›½é™…åŒ–ä¸æœ¬åœ°åŒ–â€, å¤šè¯­è¨€è™½ç„¶æ˜¯å…¶ä¸­çš„ä¸»è¦å†…å®¹, ä½†è¿˜æœ‰å¾ˆå¤šé¢å¤–çš„å·¥ä½œ.&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚: åœ¨éŸ©å›½ä¸Šçº¿çš„æ¸¸æˆå¿…é¡»åœ¨æ¸¸æˆç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å¼¹å‡ºä¸€ä¸ªå†…å®¹ååˆ†é•¿çš„ç”¨æˆ·åè®®, ç”¨æˆ·åŒæ„åæ–¹å¯ç»§ç»­æ¸¸æˆ; æ¯”å¦‚å¾ˆå¤šèµŒåšæ€§è´¨çš„æ´»åŠ¨(æŠ½å¥–, æ‹‰éœ¸, è½¬ç›˜)éƒ½éœ€è¦ä¿®æ”¹ä¸ºå…¶ä»–è¡¨ç°å½¢å¼. è¿˜æœ‰ä¸€äº›æŠ€æœ¯æ–¹é¢çš„è¦æ±‚æ¯”å¦‚æ¸¸æˆç”¨æˆ·çš„æ•°æ®ä¸èƒ½å­˜åœ¨ cache ç›®å½•ä¸‹ç­‰ç­‰.&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå›½å®¶å’Œåœ°åŒºçš„è¦æ±‚éƒ½ä¸å°½ç›¸åŒ, æœ‰çš„æ˜¯ç¡¬æ€§çš„æ³•å¾‹æ³•è§„è¦æ±‚, æœ‰çš„åˆ™æ˜¯ç…§é¡¾åˆ°å½“åœ°é£ä¿—ä¹ æƒ¯ä»¥æé«˜ç”¨æˆ·ä½“éªŒ. å½“ç„¶, è¿™äº›å¹¶ä¸åœ¨æˆ‘ä»¬è¿™æ¬¡è®¨è®ºèŒƒç•´ä¹‹å†…, ç­‰æˆ‘ä»¬çš„ç»å†è¶³å¤Ÿä¸°å¯Œä¹‹åå¯ä»¥å†æ¬¡å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹.&lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
      <category term="i18n" scheme="http://blog.justbilt.com/tags/i18n/"/>
    
  </entry>
  
  <entry>
    <title>Quick-cocos2d-x è‡ªå®šä¹‰å¤´åƒ</title>
    <link href="http://blog.justbilt.com/2017/04/23/quick-x-user-avatar/"/>
    <id>http://blog.justbilt.com/2017/04/23/quick-x-user-avatar/</id>
    <published>2017-04-23T13:54:41.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´æˆ‘ä»¬å›¢é˜Ÿå®ç°äº†æ¸¸æˆä¸­è‡ªå®šä¹‰å¤´åƒæ¨¡å—, è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„åŠŸèƒ½, åŠ ä¸Šç½‘ä¸Šè¿™æ–¹é¢çš„èµ„æ–™ä¹Ÿä¸å¤š, æ‰€ä»¥ç»™å¤§å®¶åˆ†äº«ä¸‹æˆ‘ä»¬çš„åšæ³•. </p><p>è‡ªå®šä¹‰å¤´åƒè¿™ä¸ªåŠŸèƒ½ç‰µæ‰¯åˆ°çš„å†…å®¹è¿˜æ˜¯æ¯”è¾ƒå¤šçš„, ä¸€ä¸ªäººåšçš„è¯éœ€è¦æŠ€æœ¯å‚¨å¤‡æ¯”è¾ƒå¤§, å› æ­¤æˆ‘ä»¬å°†è¿™ä¸ªä»»åŠ¡åšäº†å¦‚ä¸‹çš„æ‹†åˆ†:</p><ol><li>é€‰æ‹©å¤´åƒ</li><li>ä¸Šä¼ å¤´åƒ</li><li>ä¸‹è½½å¤´åƒ</li><li>æ˜¾ç¤ºå¤´åƒ</li></ol><p>æ¯ä¸ªäººè´Ÿè´£å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†å†…å®¹, å†æŠŠè¿™äº›å°æ¨¡å—ç»„åˆèµ·æ¥å°±å®Œæˆäº†ä»»åŠ¡. </p><a id="more"></a><h1 id="ä¸€-é€‰æ‹©å¤´åƒ"><a href="#ä¸€-é€‰æ‹©å¤´åƒ" class="headerlink" title="ä¸€. é€‰æ‹©å¤´åƒ"></a>ä¸€. é€‰æ‹©å¤´åƒ</h1><p>å¤´åƒé€‰æ‹©è¿™éƒ¨åˆ†çš„å†…å®¹åŸºæœ¬ä¸Šå’Œ Quick æ²¡æœ‰å…³ç³», ä¸»è¦å†…å®¹æœ‰:</p><ol><li>æ‹ç…§/ç›¸å†Œ</li><li>å‰ªè£</li><li>è·å–å›¾åƒæ•°æ®</li></ol><p>è¿™éƒ¨åˆ†é€»è¾‘ Android/iOS éƒ½è¦å•ç‹¬å®ç°, æˆ‘ä»¬è‡ªå·±ä»å¤´å†™èµ·ææ€•ä¸å¤ªç°å®, æ¯•ç«Ÿæˆ‘ä»¬ä¸æ˜¯ä¸“ä¸šåšè¿™ä¸ªçš„, ä¸è¿‡ä¸ç”¨æ‹…å¿ƒ, å·²ç»æœ‰å‰è¾ˆä»¬ä¸ºæˆ‘ä»¬é€ å¥½äº†è½®å­. </p><p>Android ä¸Šæˆ‘ä»¬é€‰æ‹©æ˜¯çš„ <a href="https://github.com/crazycodeboy/TakePhoto" target="_blank" rel="noopener">TakePhoto</a> è¿™ä¸ªåº“, iOS ä¸Šæˆ‘ä»¬é€‰æ‹©çš„æ˜¯ <a href="https://github.com/windshg/VPImageCropper" target="_blank" rel="noopener">VPImageCropper</a>, å…·ä½“æ¥å…¥æ–¹å¼å¤§å®¶æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥. è¿™ä¸¤ä¸ªåº“æˆ‘ä»¬åšäº†å¾ˆå¾®å°çš„ä¿®æ”¹, ä»¥é€‚åº”é¡¹ç›®çš„å®é™…éœ€æ±‚, åŒæ—¶å› ä¸º Lua è¿™è¾¹å¯¹äºŒè¿›åˆ¶çš„æ•°æ®å¤„ç†æ¯”è¾ƒéº»çƒ¦, æˆ‘ä»¬é€‰æ‹©å°†å›¾ç‰‡æ•°æ®è¿›è¡Œ base64 ç¼–ç åè¿”å›ç»™ Lua ç«¯.</p><h1 id="äºŒ-ä¸Šä¼ å¤´åƒ"><a href="#äºŒ-ä¸Šä¼ å¤´åƒ" class="headerlink" title="äºŒ. ä¸Šä¼ å¤´åƒ"></a>äºŒ. ä¸Šä¼ å¤´åƒ</h1><p>ä¸Šä¼ å¤´åƒå…¶å®æ˜¯æ¯”è¾ƒç®€å•çš„, æˆ‘ä»¬å°è¯•è¿‡ tcp å’Œ http è¿™ä¸¤ç§ä¸Šä¼ æ–¹å¼. æˆ‘ä»¬åœ¨å°è¯• tcp ä¸Šä¼ çš„æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªå¾ˆæ£˜æ‰‹çš„é—®é¢˜, å°±æ˜¯å‘é€æ•°æ®è¿‡å¤§ä¼šå¯¼è‡´ tcp è¿æ¥æ–­å¼€. </p><p>è¿™ä¸ªé—®é¢˜ååˆ†è¯¡å¼‚, åŒæ ·é•¿åº¦çš„æ•°æ®, åœ¨ macOS å’Œ iOS ä¸Šæ²¡æœ‰ä»»ä½•é—®é¢˜, ä½†æ˜¯åœ¨ Android ä¸Šå°±ä¸è¡Œ, scoket åœ¨å‘é€æ•°æ®ä¸€æ®µæ—¶é—´åæ”¶åˆ°äº† RST æŒ‡ä»¤, ç´§æ¥ç€é“¾æ¥å°±ä¼šæ–­å¼€. å’ŒæœåŠ¡å™¨åŒå­¦ç ”ç©¶ä¸€æ®µæ—¶é—´åæ— æœ, å°±æ”¾å¼ƒäº†è¿™ä¸ªé—®é¢˜, è½¬ä¸ºä½¿ç”¨ http ä¸Šä¼ .</p><p>ä½¿ç”¨äº† http ä¹‹å, è¿˜æ˜¯ä¸Šä¼ å¤±è´¥, æœåŠ¡å™¨æ”¶åˆ°çš„ post è¯·æ±‚ä¸­æ²¡æœ‰ body, è€Œå®¢æˆ·ç«¯åŠ æ—¥å¿—æ˜¾ç¤ºæ•°æ®æ²¡æœ‰é—®é¢˜éƒ½å¡åˆ° body ä¸­äº†. ä½¿ç”¨æŠ“åŒ…å·¥å…·åˆ†æåç¡®å®é•¿åº¦æœ‰é—®é¢˜, è¿™å°±ååˆ†è¯¡å¼‚äº†. åœ¨å¶ç„¶é—´å‘ç°å¾®ä¿¡ä¹Ÿä¼šé‡åˆ°å›¾ç‰‡å‘å¸ƒå‡ºå»çš„æƒ…å†µå, æˆ‘ä»¬åˆ†ææ˜¯ wifi æœ‰é—®é¢˜, æ¢äº†å¦ä¸€ä¸ªç½‘ç»œä¹‹åå°±æ²¡æœ‰é—®é¢˜äº†.</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> req = network.createHTTPRequest(reponse, url, <span class="string">"POST"</span>)</span><br><span class="line"></span><br><span class="line">req:setTimeout(timeout)</span><br><span class="line">req:addRequestHeader(<span class="string">"Content-Type: mmf/bin"</span>)</span><br><span class="line">req:addRequestHeader(<span class="string">"Accept: mmf/bin"</span>)</span><br><span class="line">req:setPOSTData(imagedata)</span><br><span class="line"></span><br><span class="line">req:start()</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€æ®µæ¯”è¾ƒç®€å•çš„ http ä¸Šä¼ æ•°æ®çš„ä»£ç ç¤ºä¾‹, è¿™æœŸé—´æˆ‘è¿˜é‡åˆ°äº†å¦ä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜, å°±æ˜¯å®¢æˆ·ç«¯è¿™é‡Œæ˜æ˜å‘é€çš„æ˜¯ POST è¯·æ±‚, ä½†æ˜¯æœåŠ¡å™¨æ”¶åˆ°çš„å´æ˜¯ GET, body ä¸­æ²¡æœ‰æ•°æ®, åŒæ ·çš„ä»£ç æˆ‘ä»¬åœ¨ Mac ä¸Šä½¿ç”¨æ¨¡æ‹Ÿå™¨æ˜¯æ²¡æœ‰é—®é¢˜çš„, éå¸¸è¯¡å¼‚å‘€. http åœ¨ Android ä¸Šçš„å®ç°ä½äº QuickHTTPInterface.java ä¸­, ç»è¿‡åœ¨ Android æ–­ç‚¹è°ƒè¯•, å‘ç°å¹¶æ²¡æœ‰è°ƒç”¨ setRequestMethod . </p><p>åŸæ¥è¿™ç§ http è¯·æ±‚æˆ‘ä»¬æ˜¯å°è£…äº†ä¸€å±‚çš„, è¿™ä¸ª <code>POST</code> å’Œ <code>GET</code> æ˜¯é€šè¿‡å‚æ•°ä¼ å…¥çš„, å¤–éƒ¨ä¼ å…¥çš„å…¶å®æ˜¯ä¸€ä¸ªæšä¸¾. ç„¶è€Œåœ¨æˆ‘ä¹‹å‰çš„é‡æ„ä¸­, ä¿®æ”¹äº†è¿™ä¸ªæšä¸¾çš„åå­—, å¯¼è‡´ä¼ å…¥çš„å€¼æ˜¯ nil, è¿™å°±å¯¼è‡´æ²¡æœ‰è°ƒç”¨ createHTTPRequest æ—¶æ²¡æœ‰ä¼ å…¥ methed å‚æ•°, é»˜è®¤å°±æ˜¯ GET ç±»å‹çš„, å› ä¸ºå¹³å°çš„ http å®ç°ä¸åŒ, å¯¼è‡´æœ‰äº›å¹³å°æ­£å¸¸, æœ‰äº›å¹³å°ä¼šå‡ºé”™.</p><p>ä¸Šä¼ å¤´åƒçš„å†…å®¹å°±æ˜¯è¿™äº›.</p><h1 id="ä¸‰-ä¸‹è½½å¤´åƒ"><a href="#ä¸‰-ä¸‹è½½å¤´åƒ" class="headerlink" title="ä¸‰. ä¸‹è½½å¤´åƒ"></a>ä¸‰. ä¸‹è½½å¤´åƒ</h1><p>å¯¹äºè¿™ä¸ªé—®é¢˜, æˆ‘ä»¬å¼€å§‹è¿˜æ‰“ç®—åœ¨ c++ ç«¯ç”¨ curl å®ç°, ç„¶ååˆ°å¤„åˆ° Lua è¿™è¾¹ä½¿ç”¨, ç›´åˆ°å‘ç°äº† HttpClient çš„ <code>saveResponseData</code> æ¥å£. è°ƒç”¨äº†è¿™ä¸ªæ¥å£å¯ä»¥ç›´æ¥æŠŠ Response ä¸­çš„æ•°æ®ä¿å­˜åœ¨æœ¬åœ°, è¿™æ ·ä¸‹è½½å•ä¸ªæ–‡ä»¶å°±æå®šäº†. ä¸‹è½½ä»£ç å¦‚ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- httpä¸‹è½½</span></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">@param string _url _urlåœ°å€</span></span><br><span class="line"><span class="comment">@param string _savepath æŒ‡å®šçš„å­˜å‚¨è·¯å¾„</span></span><br><span class="line"><span class="comment">@param function _callfunc ä¸‹è½½å®Œæˆå›è°ƒæ–¹æ³•</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">_download</span><span class="params">(_url, _savepath, _callfunc)</span></span></span><br><span class="line"><span class="keyword">local</span> req = network.createHTTPRequest(</span><br><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(event)</span></span></span><br><span class="line">            <span class="keyword">if</span> event.name == <span class="string">"completed"</span> <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">--åˆ¤æ–­æ˜¯å¦ä¸‹è½½æˆåŠŸ</span></span><br><span class="line">                <span class="keyword">local</span> success = <span class="literal">false</span></span><br><span class="line">                <span class="keyword">local</span> code = event.request:getResponseStatusCode()</span><br><span class="line">                <span class="keyword">if</span> code == <span class="number">200</span> <span class="keyword">and</span> event.request:saveResponseData(_savepath) <span class="keyword">then</span></span><br><span class="line">                success = <span class="literal">true</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">if</span> _callfunc <span class="keyword">then</span></span><br><span class="line">                _callfunc(success, &#123;url = _url, req = event.request, <span class="built_in">path</span> = _savepath&#125;)</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span>, _url, <span class="string">"GET"</span>)</span><br><span class="line">    req:setTimeout(<span class="number">60</span>)</span><br><span class="line">    req:start()</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ•´ä¸ªä¸‹è½½åŠŸèƒ½å‘¢å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•, æˆ‘ä»¬åº”è¯¥è€ƒè™‘åˆ° <code>æœ¬åœ°ç¼“å­˜</code>, <code>å»é‡</code>, <code>é˜Ÿåˆ—é™åˆ¶</code>ç­‰æƒ…å†µ, è¿™æ ·æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªé€šç”¨çš„ä¸‹è½½æ¨¡å—, ä¸ä»…ä»…æ˜¯ä¸ºè‡ªå®šä¹‰å¤´åƒåŠŸèƒ½, å…¶ä»–çš„æ¨¡å—ä¹Ÿå¯ä»¥ä½¿ç”¨.</p><h1 id="å››-æ˜¾ç¤ºå¤´åƒ"><a href="#å››-æ˜¾ç¤ºå¤´åƒ" class="headerlink" title="å››. æ˜¾ç¤ºå¤´åƒ"></a>å››. æ˜¾ç¤ºå¤´åƒ</h1><p>è¿™ä¸ªåŠŸèƒ½å…¶å®å¾ˆç®€å•äº†, ä¸ºäº†ä»€ä¹ˆè¦å•ç‹¬æ‹¿å‡ºæ¥è¯´å‘¢? å°±æ˜¯æˆ‘ä»¬è¦å®ç°çš„å¾ˆä¼˜é›…. è‡ªå®šä¹‰å¤´åƒè¿™ä¸ªåŠŸèƒ½å¯èƒ½ä¸æ˜¯ä¸€å¼€å§‹å°±æå‡ºçš„, å› ä¸ºæ”¹äº† Native å±‚çš„ä»£ç , æ‰€ä»¥éœ€è¦çº¿ä¸Šæ¢åŒ…, è¿™å°±æ¯”è¾ƒéº»çƒ¦äº†, æ‰€ä»¥æˆ‘ä»¬è¿™ä¸ªæ¨¡å—è¦å’Œä¹‹å‰çš„å¤´åƒä¿æŒå…¼å®¹. </p><p>æˆ‘ä»¬æ¸¸æˆä¸­çš„æ˜¾ç¤ºå¤´åƒçš„åœ°æ–¹æœ‰å¾ˆå¤š, æˆ‘ä»¬ä¸èƒ½æŠŠä¸‹è½½çš„è°ƒç”¨å†™çš„åˆ°å¤„éƒ½æ˜¯, æ¯”è¾ƒä¼˜é›…çš„åšæ³•æ˜¯å®ç°ä¸€ä¸ªå¤´åƒæ§ä»¶, åœ¨è¿™ä¸ªæ§ä»¶å†…éƒ¨å¤„ç†æ™®é€šå¤´åƒå’Œè‡ªå®šä¹‰å¤´åƒçš„é€»è¾‘. ä¸ºäº†æé«˜ç”¨æˆ·ä½“éªŒ, ä¸‹è½½çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºä¸€å¼ æ›¿ä»£å›¾æˆ–è€…ä¹‹å‰çš„æ™®é€šå¤´åƒ.</p><hr><p>ä¸‹é¢ä¸Šä¸€å¼ æœ€ç»ˆçš„æ•ˆæœå›¾:</p><p><img src="http://ww1.sinaimg.cn/large/7f870d23ly1ffd57bsbyij20f00qo0u0.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰æ®µæ—¶é—´æˆ‘ä»¬å›¢é˜Ÿå®ç°äº†æ¸¸æˆä¸­è‡ªå®šä¹‰å¤´åƒæ¨¡å—, è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„åŠŸèƒ½, åŠ ä¸Šç½‘ä¸Šè¿™æ–¹é¢çš„èµ„æ–™ä¹Ÿä¸å¤š, æ‰€ä»¥ç»™å¤§å®¶åˆ†äº«ä¸‹æˆ‘ä»¬çš„åšæ³•. &lt;/p&gt;
&lt;p&gt;è‡ªå®šä¹‰å¤´åƒè¿™ä¸ªåŠŸèƒ½ç‰µæ‰¯åˆ°çš„å†…å®¹è¿˜æ˜¯æ¯”è¾ƒå¤šçš„, ä¸€ä¸ªäººåšçš„è¯éœ€è¦æŠ€æœ¯å‚¨å¤‡æ¯”è¾ƒå¤§, å› æ­¤æˆ‘ä»¬å°†è¿™ä¸ªä»»åŠ¡åšäº†å¦‚ä¸‹çš„æ‹†åˆ†:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€‰æ‹©å¤´åƒ&lt;/li&gt;
&lt;li&gt;ä¸Šä¼ å¤´åƒ&lt;/li&gt;
&lt;li&gt;ä¸‹è½½å¤´åƒ&lt;/li&gt;
&lt;li&gt;æ˜¾ç¤ºå¤´åƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯ä¸ªäººè´Ÿè´£å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†å†…å®¹, å†æŠŠè¿™äº›å°æ¨¡å—ç»„åˆèµ·æ¥å°±å®Œæˆäº†ä»»åŠ¡. &lt;/p&gt;
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
  </entry>
  
  <entry>
    <title>æ´ç™–æ‚£è€…çš„ Git GUI æŒ‡å—</title>
    <link href="http://blog.justbilt.com/2017/04/12/the-git-for-neat-freak/"/>
    <id>http://blog.justbilt.com/2017/04/12/the-git-for-neat-freak/</id>
    <published>2017-04-12T15:34:12.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´æˆ‘çœ‹åˆ°äº†ä¸€ç¯‡æ–‡ç« , <a href="http://hungyuhei.github.io/2012/08/07/better-git-commit-graph-using-pull---rebase-and-merge---no-ff.html" target="_blank" rel="noopener">æ´ç™–è€…ç”¨ Gitï¼špull â€“rebase å’Œ merge â€“no-ff</a> , å‘ç°å’Œæˆ‘ä»¬ç›®å‰çš„å·¥ä½œæµç¨‹å¾ˆåƒ, åŒºåˆ«åœ¨äºæˆ‘ä»¬æ˜¯ä½¿ç”¨ GUI å·¥å…·æ¥åšçš„è¿™äº›, ä¹Ÿåšäº†ä¸€äº›æ–°çš„å°è¯•.</p><a id="more"></a><p>æ³¨: é˜…è¯»ä¸‹é¢çš„æ–‡ç« å‰, æˆ‘é»˜è®¤ä½ å·²ç»è¯»è¿‡ä¸Šé¢æ¨èçš„é‚£ç¯‡æ–‡ç« , æœ¬ç¯‡æ–‡ç« ä¸ä¼šèµ˜è¿°å…¶ä¸­çš„å†…å®¹.</p><h1 id="ä¸€-pull-â€“rebase-å’Œ-merge-â€“no-ff"><a href="#ä¸€-pull-â€“rebase-å’Œ-merge-â€“no-ff" class="headerlink" title="ä¸€. pull â€“rebase å’Œ merge â€“no-ff"></a>ä¸€. pull â€“rebase å’Œ merge â€“no-ff</h1><p>ä½¿ç”¨è½¯ä»¶: <a href="https://www.sourcetreeapp.com/" target="_blank" rel="noopener">SourceTree</a></p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>SourceTree éœ€è¦æ›´æ”¹è¿™äº›åå¥½è®¾ç½®: </p><blockquote><p>Allow force push</p></blockquote><p>ä½äº General æ ‡ç­¾, å¦‚æœæœ‰è¿½è¸ªçš„è¿œç«¯, æœ¬åœ° rebase åä¼šé€ æˆæœ¬åœ°æäº¤å†å²å’Œå†å²ä¸ä¸€è‡´, å¿…é¡»å¼ºåˆ¶æ¨ (Force Push) æ‰èƒ½æ¨é€åˆ°è¿œç«¯. å‹¾é€‰è¿™ä¸ªé€‰é¡¹å, ä¼šåœ¨ push ç•Œé¢ä¸Šå¤šå‡ºä¸€ä¸ª Force push é€‰é¡¹.</p><p><img src="https://ww1.sinaimg.cn/large/006tKfTcgy1feoct36xyhj30lx0k0whu.jpg" alt=""></p><blockquote><p>Use rebase instead of merge by default for tracked branches</p></blockquote><p>è¿™ä¸ªå°±æ˜¯é‚£ç¯‡æ–‡ç« ä¸­çš„ <code>git pull --rebase</code> , å‹¾é€‰å pull ç•Œé¢ä¸Šçš„ Rebase instead of merge é€‰é¡¹ä¼šé»˜è®¤å¤„äºå‹¾é€‰çŠ¶æ€ .</p><blockquote><p>Do not fast-forward when merging, always create commit</p></blockquote><p>è¿™ä¸ªå°±æ˜¯ <code>merge --no-ff</code> , åˆå¹¶åˆ†æ”¯å, æ€»æ˜¯ä¼šäº§ç”Ÿä¸€æ¬¡ Merge Commit .</p><blockquote><p>Display author date instead of commit data in log (å¯é€‰)</p></blockquote><p>ä¸€æ—¦ rebase å, æäº¤æ—¶é—´å°±ä¼šå˜æˆ rebase çš„æ—¶é—´, å½±å“åˆ¤æ–­, å¦‚æœå‹¾é€‰è¿™ä¸ªé€‰é¡¹, å°±ä¼šä¸€ç›´æ˜¾ç¤º commit åˆ›å»ºæ—¶çš„æ—¥æœŸ, è¿™æ¡ä¸æ˜¯å¿…é¡»çš„, å¤§å®¶æ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©.</p><h2 id="pull-â€“rebase"><a href="#pull-â€“rebase" class="headerlink" title="pull â€“rebase"></a>pull â€“rebase</h2><blockquote><p>git pull â€“rebase</p></blockquote><p><img src="https://ww1.sinaimg.cn/large/006tKfTcly1feohl206naj30mk0fajup.jpg" alt=""></p><p>å¦‚æœæ‰“ç®— pull ä¸€ä¸ª <strong>æ²¡æœ‰è·Ÿè¸ªä¸­</strong> çš„è¿œç«¯åˆ†æ”¯, å³ä½¿ä½ ä¿®æ”¹äº†åå¥½è®¾ç½®, <code>Rebase instead of merge</code> é€‰é¡¹ä¹Ÿä¸ä¼šé»˜è®¤å‹¾é€‰, éœ€è¦æ‰‹åŠ¨å‹¾é€‰.</p><blockquote><p>git rebase <branch></branch></p></blockquote><p><img src="https://ww3.sinaimg.cn/large/006tKfTcly1feoifjhienj30jb0bz0xi.jpg" alt=""></p><p>å‡å¦‚æƒ³è®© A åˆ†æ”¯ä¸Šçš„è¯¥åŠ¨éƒ½åŸºäº B åˆ†æ”¯, å…ˆä¿è¯ä½ å¤„äº A åˆ†æ”¯, åœ¨ BRANCHES ä¸­ B ä¸Šå³é”®é€‰æ‹© <code>Rebase current changes onto B</code> .</p><blockquote><p>rebase å†²çªåçš„å¤„ç†</p></blockquote><p>rebase è¿‡ç¨‹å®é™…ä¸Šå¯ä»¥ç†è§£ä¸ºæ˜¯å°†å½“å‰åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ commit å†ä¸€æ¬¡æ¬¡åº”ç”¨çš„è¿‡ç¨‹, é‚£ä¹ˆå¦‚æœå…¶ä¸­ä¸€æ­¥å†²çªäº†æ€ä¹ˆåŠ?</p><p>rebase ä¼šæš‚åœä¸‹æ¥, ç­‰å¾…ä½ è§£å†³å®Œå†²çªåçš„æ“ä½œ. å¦‚æœåœ¨ç»ˆç«¯ä¸­çš„è¯, ä½ æœ‰å››ä¸ªé€‰é¡¹å¯é€‰:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git rebase --<span class="built_in">continue</span> //ç»§ç»­</span><br><span class="line">git rebase --skip //è·³è¿‡</span><br><span class="line">git rebase --abort //ç»ˆæ­¢</span><br><span class="line">git rebase --quit //ç»“æŸ</span><br></pre></td></tr></table></figure><p>åœ¨ SourceTree ä¸­, æˆ‘ä»¬è§£å†³å®Œå†²çªå, å¯ä»¥ç‚¹å‡» <code>Commit</code> æŒ‰é’®, è¿™æ—¶ä¼šå‡ºç°ä¸‹é¢è¿™ä¸ªç•Œé¢:</p><p><img src="https://ww1.sinaimg.cn/large/006tKfTcly1feoohf4h49j30hs07u0u0.jpg" alt=""></p><p><code>Abort Rebase</code> , <code>Continue Rebase</code> åˆ†åˆ«ä¸ <code>--continue</code> å’Œ <code>--abort</code> å¯¹åº”. å¦‚æœè§£å†³å®Œå†²çªåè¿™æ¬¡ Commit ä¸åŒ…å«ä»»ä½• Changes çš„è¯, æˆ‘ä»¬å°±éœ€è¦ <code>--skip</code> äº†, å¾ˆä¸å¹¸çš„æ˜¯ SourceTree å¹¶æ²¡æœ‰æä¾›è¿™ä¸ªé€‰é¡¹, åªèƒ½åœ¨ç»ˆç«¯ä¸­æ“ä½œ.</p><h2 id="merge-â€“no-ff"><a href="#merge-â€“no-ff" class="headerlink" title="merge â€“no-ff"></a>merge â€“no-ff</h2><p><img src="https://ww2.sinaimg.cn/large/006tKfTcly1feoipaaqqoj30jb0c2tbm.jpg" alt=""></p><p>å’Œ rebase æ“ä½œåŸºæœ¬ä¸€è‡´, èœå•é€‰æ‹© <code>Merge B into A</code>. ä¸‹é¢ä¼šå¼¹å‡ºè¿™ä¸ªç•Œé¢:</p><p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1feois0fn45j30il08jwfl.jpg" alt=""></p><blockquote><p>Commit merged changes immediately</p></blockquote><p>å‹¾é€‰æˆ–å¦‚æœåˆå¹¶æ²¡æœ‰å†²çªçš„è¯, ä¼šè‡ªåŠ¨æäº¤è¿™æ¬¡ Merege Commit, å¦åˆ™çš„è¯, ä½ éœ€è¦æ‰‹åŠ¨æäº¤.</p><blockquote><p>Include messages form commits being merged in merge commit</p></blockquote><p>ä¼šæŠŠè¿™ä¸ªåˆ†æ”¯ä¸Šçš„æ‰€æœ‰çš„æäº¤æ—¥å¿—é™„åŠ åˆ° Merege Commit çš„æäº¤æ—¥å¿—ä¸­.</p><h1 id="äºŒ-rebase-befroe-merge"><a href="#äºŒ-rebase-befroe-merge" class="headerlink" title="äºŒ. rebase befroe merge"></a>äºŒ. rebase befroe merge</h1><p>å°±æ˜¯åœ¨ merge å‰å…ˆ rebase, å‡å¦‚æˆ‘ä»¬æƒ³æŠŠ B åˆå¹¶è¿› A ä¸­, åº”å½“å…ˆåœ¨ B ä¸Šé¢ rebase A, å†åˆ‡æ¢åˆ° A ä¸Šé¢ merge B. è¿™æ ·å¯ä»¥é¿å…å‡ºç°ä¸‹é¢è¿™æ ·çš„å†å²:</p><p><img src="https://ww2.sinaimg.cn/large/006tKfTcly1feojg14lnjj301003q3yh.jpg" alt=""></p><p>è¿™æ ·åš, è¿˜ä¼šé™„å¸¦ä¸€ä¸ªå¥½å¤„, å°±æ˜¯ä¼šä½¿å¾—è¿™æ¬¡ <code>Merege Commit</code> éå¸¸çš„çº¯ç²¹, å› ä¸ºåœ¨ rebase æ—¶å·²ç»æŠŠæ½œåœ¨çš„å†²çªéƒ½è§£å†³å®Œäº†, æ‰€ä»¥è¿™æ¬¡ merge ä¸€å®šä¸ä¼šæœ‰å†²çª, è¿™æ · Merege Commit çš„æ”¹åŠ¨å°±ä¼šå’Œåˆ†æ”¯ B çš„æ”¹åŠ¨å®Œå…¨ä¸€è‡´, ä¸ä¼šå†æœ‰å…¶ä»–çš„æ”¹åŠ¨(è§£å†³å†²çªæ—¶çš„ä¿®æ”¹).</p><h1 id="ä¸‰-åˆå¹¶å‰æ•´ç†åˆ†æ”¯"><a href="#ä¸‰-åˆå¹¶å‰æ•´ç†åˆ†æ”¯" class="headerlink" title="ä¸‰. åˆå¹¶å‰æ•´ç†åˆ†æ”¯"></a>ä¸‰. åˆå¹¶å‰æ•´ç†åˆ†æ”¯</h1><p>ä½¿ç”¨è½¯ä»¶: <a href="http://gitup.co/" target="_blank" rel="noopener">GitUp</a></p><p>Gitup åŠŸèƒ½ååˆ†ç¥å¥‡, è€Œä¸”è¿˜æä¾›äº†å¾ˆå¼ºå¤§çš„ undo/redo æ“ä½œ, æ‰€ä»¥å¯ä»¥å¾ˆä¸è´Ÿè´£ä»»çš„è¯´, å¤§å®¶å¯ä»¥éšæ„å°è¯•å…¶ä¸­çš„å„ç§åŠŸèƒ½, ä¸å¿…æ‹…å¿ƒæŠŠä»“åº“ææŒ‚.</p><p>å¦‚æœåšæŒä½¿ç”¨ rebase è¯, å°±ä¼šæ˜ç™½ rebase çš„å¤æ‚åº¦, æ˜¯ä¸è¿™ä¸ªåˆ†æ”¯ä¸Šçš„ commit æ¬¡æ•°æœ‰ä¸€å®šå…³ç³»çš„. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ rebase å‰æ•´ç†è¿™ä¸ªåˆ†æ”¯:</p><blockquote><p>åˆå¹¶ç›¸åŒåŠŸèƒ½çš„ Commit </p></blockquote><p><img src="https://ww2.sinaimg.cn/large/006tKfTcly1feok1ndseyj30pe0iemzi.jpg" alt=""></p><p>ä½¿ç”¨ gitup æ‰“å¼€ä»“åº“, éšä¾¿åœ¨ä¸€æ¬¡ commit ä¸Šå³é”®, ä¾¿å¯ä»¥çœ‹åˆ°ä¸Šå›¾çš„èœå•. è¿™é‡Œé¢æœ‰æ‰€æœ‰çš„æ“ä½œ, ä¸‹é¢æˆ‘æ¥è¯´ä¸€ä¸‹å¸¸ç”¨çš„:</p><blockquote><p>Fixup with Parent / Squash with Parent</p></blockquote><p>ä½œç”¨éƒ½æ˜¯å°†æœ¬æ¬¡æäº¤å’Œä¸Šä¸€æ¬¡åˆå¹¶, åŒºåˆ«æ˜¯åè€…å¯ä»¥åŒæ—¶ä¿®æ”¹æäº¤æ—¥å¿—.</p><blockquote><p>Swap with Parent / Child</p></blockquote><p>å°±æ˜¯è®²ä¸¤æ¬¡æäº¤äº’æ¢ä½ç½®, æ¯”å¦‚ä½ æœ‰ A-B-C ä¸‰æ¬¡æäº¤, ä½ æƒ³æŠŠ A å’Œ C åˆå¹¶, ä½†æ˜¯ä¸­é—´éš”ç€ä¸€ä¸ª B, è¿™æ—¶å°±æ˜¯æŠŠ B å’Œ C çš„ä½ç½®äº¤æ¢å Squash.</p><blockquote><p>Split</p></blockquote><p>å°†ä¸€æ¬¡æäº¤æ‹†åˆ†ä¸ºä¸¤æ¬¡, ä¸è¿‡æ‹†åˆ†ç²’åº¦åªèƒ½åˆ°æ–‡ä»¶çº§. ä¹Ÿå¾ˆå¸¸ç”¨, æ¯”å¦‚è¯¯å°†ä¸€äº›ä¸å±äºè¿™æ¬¡æäº¤åšçš„æ”¹åŠ¨æäº¤äº†ä¸Šå», å¯ä»¥ç”¨è¿™ä¸ªæ‹†åˆ†å‡ºæ¥.</p><h1 id="å››-åè®°"><a href="#å››-åè®°" class="headerlink" title="å››. åè®°"></a>å››. åè®°</h1><p><img src="https://ww3.sinaimg.cn/large/006tKfTcly1feolo8so66j305k0m8gmk.jpg" alt=""></p><p>è¿™ä¸ªæ˜¯æˆ‘ä»¬åšæŒäº†ä¸€æ®µæ—¶é—´ä¹‹åçš„æäº¤å†å²å¯¹æ¯”, å·¦ä¾§æ‚ä¹±æ— ç« , çŠ¬ç‰™å‘²äº’, è¿™æ˜¯ä¸€æ¡æ— æ³•ç›´è§†çš„æäº¤å†å², å³ä¾§çš„åˆ™æ¸…æ™°ä¸å°‘. </p><p><img src="https://ww4.sinaimg.cn/large/006tKfTcly1feoluos10ej30n604hab9.jpg" alt=""></p><p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ç­›é€‰å™¨ä¸­çš„ <code>All Parents</code> ä¸º <code>First parent only</code>, è¿™æ ·æˆ‘ä»¬ä½åˆ†æ”¯ä¸Šçš„å†å²ä¾¿åªå‰©ä¸‹äº† Merge Commit ,é‚£ä¹ˆåªçœ‹è¿™äº› Commit ä¾¿å¯ä»¥çŸ¥é“æ•´ä¸ªåˆ†æ”¯çš„è¿›åŒ–å†ç¨‹.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰æ®µæ—¶é—´æˆ‘çœ‹åˆ°äº†ä¸€ç¯‡æ–‡ç« , &lt;a href=&quot;http://hungyuhei.github.io/2012/08/07/better-git-commit-graph-using-pull---rebase-and-merge---no-ff.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ´ç™–è€…ç”¨ Gitï¼špull â€“rebase å’Œ merge â€“no-ff&lt;/a&gt; , å‘ç°å’Œæˆ‘ä»¬ç›®å‰çš„å·¥ä½œæµç¨‹å¾ˆåƒ, åŒºåˆ«åœ¨äºæˆ‘ä»¬æ˜¯ä½¿ç”¨ GUI å·¥å…·æ¥åšçš„è¿™äº›, ä¹Ÿåšäº†ä¸€äº›æ–°çš„å°è¯•.&lt;/p&gt;
    
    </summary>
    
    
      <category term="neat-freak" scheme="http://blog.justbilt.com/tags/neat-freak/"/>
    
      <category term="git" scheme="http://blog.justbilt.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>å¤šè¯´, å†è§ !</title>
    <link href="http://blog.justbilt.com/2017/03/25/bye-duoshuo-bye-comment/"/>
    <id>http://blog.justbilt.com/2017/03/25/bye-duoshuo-bye-comment/</id>
    <published>2017-03-25T01:30:30.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¤§çº¦æ˜¯åœ¨å‰å‡ å¤©åˆ·å¾®åšçš„æ—¶å€™çœ‹åˆ°æœ‰äººè¯´å¤šè¯´è¦å…³ç«™äº†, èµ¶ç´§å»å¤‡ä»½è¯„è®º balabala â€¦ , éš¾ä»¥ç½®ä¿¡, èµ¶ç´§å»æˆ‘çš„é‚®ç®±æ‰¾äº†ä¸‹, æœç„¶æ‰¾åˆ°äº†è¿™å°é‚®ä»¶:</p><p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fdyu57rth7j30pi08bab4.jpg" alt=""></p><p>éœ‡æƒŠ !!! ä¾ç„¶éš¾ä»¥ç½®ä¿¡ !!!</p><a id="more"></a><p>æˆ‘æ€¥å¿™æŠŠè¿™ä¸ªæ¶ˆæ¯è½¬å‘åˆ°äº†å…¬å¸çš„å¾®ä¿¡ç¾¤é‡Œ, å´å¾ˆå¿«å°±è¢«å…¶ä»–æ¶ˆæ¯æ·¹æ²¡, æ²¡æœ‰æ¿€èµ·ä¸€ç‚¹æµªèŠ±.</p><p><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fdyuh2osr9j30bu0j2gmh.jpg" alt=""></p><p>ä»–ä»¬å¯èƒ½ä¹Ÿå¾ˆå¥‡æ€ª, å¤šè¯´æ˜¯ä»€ä¹ˆé¬¼, å…³é—­äº†å’Œæˆ‘æœ‰ä»€ä¹ˆå…³ç³» ? å—¯å“ª, æ¯•ç«Ÿå†™åšå’Œè¯»åšéƒ½åªæ˜¯å°ä¼—çš„éœ€æ±‚.</p><p>å°†æ—¶é—´æ‹¨å› 2013 å¹´, é‚£æ—¶æˆ‘åˆšæŠŠåšå®¢ä» WordPress åˆ‡æ¢åˆ° hexo, é‚£æ—¶ hexo çš„é»˜è®¤è¯„è®ºè¿˜æ˜¯ disqus å‘¢, ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› , é€Ÿåº¦éå¸¸æ…¢. ç»è¿‡ä¸€ç•ªæŸ¥æ‰¾, é€‰æ‹©äº†å¤šè¯´, é€Ÿåº¦å¿«, è¿˜æ”¯æŒå›½å†…çš„å„ç§ç¤¾äº¤è´¦å·ç™»å½•, å…è´¹, å¾ˆè‰¯å¿ƒ.</p><p><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fdyujgpr90j30um0kk0wp.jpg" alt=""></p><p>æˆ‘åœ¨æ–°åšå®¢å†™çš„ç¬¬ä¸€ç¯‡æ–‡ç« æ˜¯ <a href="http://blog.justbilt.com/2013/11/03/elbow/">&lt;&lt;å¼¯ç®¡(æ‹è§’)å¯¹æ–¹å‘çš„æ”¹å˜&gt;&gt;</a> ,æ—¶é—´ <code>2013/11/03</code>, æ”¶åˆ°çš„ç¬¬ä¸€æ¡è¯„è®ºæ˜¯:</p><p><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fdyuxow26aj30nf022weq.jpg" alt=""></p><p>æ˜¯ firedragonpzy å…„å‘æ¥çš„[ç»™åŠ›], è¿™ä¹ˆå¤šå¹´è¿‡å»äº†, ä¸çŸ¥ä»–ç°åœ¨åšä»€ä¹ˆ?ã€€</p><p>æœ€åä¸€ç¯‡æœ‰å¤šè¯´è¯„è®ºçš„æ–‡ç« æ˜¯ <a href="http://blog.justbilt.com/2017/02/24/some-change-for-blog/">&lt;&lt;æœ€è¿‘åšå®¢çš„ä¸€äº›å˜åŒ–&gt;&gt;</a>, æ—¶é—´ <code>2017/02/24</code>, æ˜¯å›å¤å±±äººçš„åæ§½:</p><p><img src="https://ww4.sinaimg.cn/large/006tNbRwly1fdyv73hz7fj30ng040aai.jpg" alt=""></p><p>æ‰€ä»¥, ä½ ä»¥ä¸ºå¤šè¯´çš„å…³é—­æ„å‘³ç€ä»€ä¹ˆ ? </p><blockquote><p>é‚£æ—¶ cocos2d-x è¿˜ååˆ†ç«çˆ†,<br>é‚£æ—¶æˆ‘è¿˜åœ¨ç”¨ c++,<br>é‚£å¹´æˆ‘æ‰ 21 å².</p></blockquote><hr><p>å¥½å§, ç°åœ¨å…³é—­è£…é€¼æ¨¡å¼.</p><p>è™½ç„¶ç”¨äº†è¿™ä¹ˆå¤šå¹´çš„è¯„è®º, ä½†æ­£å¦‚ @ç‹å­äº­ åšä¸»åœ¨<a href="https://jysperm.me/2016/05/remove-comments-and-wechat/" target="_blank" rel="noopener">è¿™ç¯‡</a>æ–‡ç« ä¸­æ‰€è¨€:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä»å¦ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œæˆ‘å†™äº†è¿™ä¹ˆå¤šå¹´åšå®¢ï¼Œæ”¶åˆ°çš„å¤§éƒ¨åˆ†è¯„è®ºéƒ½å’Œæ–‡ç« å†…å®¹æ— å…³ â€”â€” ä»–ä»¬åœ¨æŠŠæ–‡ç« çš„è¯„è®ºå½“ä½œç•™è¨€æ¿æ¥ä½¿ç”¨ï¼Œå’Œæˆ‘æ‰“ä¸ªæ‹›å‘¼æˆ–è€…è¯¢é—®ä¸€ä¸‹è¿‘å†µã€‚</span><br><span class="line">å½“ç„¶æˆ‘ä¹Ÿæ›¾æ”¶åˆ°æå°‘éƒ¨åˆ†ä¸€äº›è®¤çœŸæ’°å†™çš„è¯„è®ºï¼Œæˆ‘ä¹Ÿå¸Œæœ›ç»§ç»­ç»™è¿™äº›äººç•™å‡ºä¸€äº›ç©ºé—´ï¼šæˆ‘ä¼šä»¥é‚®ä»¶çš„å½¢å¼æ¥å—æ–‡ç« è¯„è®ºï¼Œæˆ‘ä¼šæŒ‘é€‰å…¶ä¸­å¯¹è¯»è€…æœ‰ä»·å€¼çš„éƒ¨åˆ†å±•ç¤ºåœ¨æ–‡ç« çš„æœ«å°¾ã€‚</span><br></pre></td></tr></table></figure><p>å­äº­åŒå­¦è¯´çš„ç‰¹åˆ«å¥½, åˆšå¥½å€Ÿç€å¤šè¯´å…³é—­çš„æœºä¼š, æˆ‘ç§»é™¤äº†åšå®¢ä¸­çš„è¯„è®ºç³»ç»Ÿ, åªä¿ç•™äº† <code>å…³äº</code> è¿™ä¸ªçŒæ°´ç•Œé¢çš„è¯„è®º, è¿˜è®¾ç«‹äº†ä¸€ä¸ªå°é—¨æ§›, åªæœ‰æ‹¥æœ‰ github è´¦å·çš„æœ‹å‹æ‰èƒ½è¯„è®º.</p><p>ä»¥åä¾¿ä¼šçœå¿ƒä¸å°‘å§.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤§çº¦æ˜¯åœ¨å‰å‡ å¤©åˆ·å¾®åšçš„æ—¶å€™çœ‹åˆ°æœ‰äººè¯´å¤šè¯´è¦å…³ç«™äº†, èµ¶ç´§å»å¤‡ä»½è¯„è®º balabala â€¦ , éš¾ä»¥ç½®ä¿¡, èµ¶ç´§å»æˆ‘çš„é‚®ç®±æ‰¾äº†ä¸‹, æœç„¶æ‰¾åˆ°äº†è¿™å°é‚®ä»¶:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ww3.sinaimg.cn/large/006tNbRwly1fdyu57rth7j30pi08bab4.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;éœ‡æƒŠ !!! ä¾ç„¶éš¾ä»¥ç½®ä¿¡ !!!&lt;/p&gt;
    
    </summary>
    
    
      <category term="blog" scheme="http://blog.justbilt.com/tags/blog/"/>
    
      <category term="duoshuo" scheme="http://blog.justbilt.com/tags/duoshuo/"/>
    
      <category term="comment" scheme="http://blog.justbilt.com/tags/comment/"/>
    
  </entry>
  
  <entry>
    <title>æœ€è¿‘æ iOS ç‰ˆé‡åˆ°çš„ä¸€äº›é—®é¢˜å’ŒæŠ€å·§ (å››)</title>
    <link href="http://blog.justbilt.com/2017/03/12/ios-dev-tips-4/"/>
    <id>http://blog.justbilt.com/2017/03/12/ios-dev-tips-4/</id>
    <published>2017-03-12T02:25:47.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯è¿™åŠå¹´æ iOS æ—¶é‡åˆ°çš„ä¸€äº›é—®é¢˜, å†™ä¸‹æ¥, å¸Œæœ›ä¼šå¸®åˆ°å¤§å®¶. å› ä¸ºæ—¶é—´ç²¾åŠ›æœ‰é™, æœ‰äº›é—®é¢˜, å¹¶æ²¡æœ‰è§£å†³æ–¹æ¡ˆ, åªæ˜¯é¥¶äº†è¿‡å».</p><a id="more"></a><h2 id="ä¸€-iOS-æ²™ç›’æµ‹è¯•-æ— æ³•è¿æ¥åˆ°APPSTORE"><a href="#ä¸€-iOS-æ²™ç›’æµ‹è¯•-æ— æ³•è¿æ¥åˆ°APPSTORE" class="headerlink" title="ä¸€. iOS æ²™ç›’æµ‹è¯• æ— æ³•è¿æ¥åˆ°APPSTORE"></a>ä¸€. iOS æ²™ç›’æµ‹è¯• æ— æ³•è¿æ¥åˆ°APPSTORE</h2><p>ç¡®å®šæ˜¯æµ‹è¯•æœº, æ²™ç›’è´¦å·ç™»å½•çš„ä¹Ÿæ²¡æœ‰é—®é¢˜, å°±æ˜¯æ— æ³•å……å€¼.</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>æ¢äº†ä¸€ä¸ªæµ‹è¯•æœºå°±å¥½äº†</p><h2 id="äºŒ-xcodebuilder-exportArchive-dev-å¤±è´¥"><a href="#äºŒ-xcodebuilder-exportArchive-dev-å¤±è´¥" class="headerlink" title="äºŒ. xcodebuilder -exportArchive dev å¤±è´¥"></a>äºŒ. xcodebuilder -exportArchive dev å¤±è´¥</h2><p>è¿™ä¸ªé—®é¢˜å‘ç”Ÿåœ¨æˆ‘ä»¬çš„ iOS æ‰“åŒ…è„šæœ¬ä¸­, ä¼šæŠ¥é”™:</p><blockquote><p>IDEDistribution: Step failed: <idedistributionthinningstep: 0x7fa72bbd50e0="">: Error Domain=IDEDistributionErrorDomain Code=14 â€œNo applicable devices found.â€</idedistributionthinningstep:></p></blockquote><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>ä¸€å¼€å§‹æˆ‘ä½¿ç”¨äº†è€çš„ ipa å¯¼å‡ºæ–¹æ¡ˆ <code>xcrun -sdk iphoneos PackageApplication</code> , è¿™æ ·è™½ç„¶å¯ä»¥å¯¼å‡ºäº†, ä½†æ˜¯ç»å¸¸æ— æ³•å®‰è£…åˆ°æµ‹è¯•æœº, è¿˜å¾—ç”¨ XCode æ‰“å¼€å½’æ¡£æ–‡ä»¶æ‰‹åŠ¨å¯¼å‡º dev ç‰ˆæœ¬. å°±è¿™æ ·å‡‘æ´»äº†ä¸€æ®µæ—¶é—´å, æˆ‘ç»ˆäºä¸‹å®šå†³å¿ƒè§£å†³è¿™ä¸ªé—®é¢˜äº†. åŸæ¥æ¯æ¬¡ <code>exportArchive</code> ä¼šæœ‰æœ‰ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶, æŸ¥çœ‹ /var/folders/â€¦/IDEDistribution.standard.log å¾—çŸ¥æ˜¯æˆ‘çš„ ruby ç¯å¢ƒæœ‰é—®é¢˜:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[NOTE]</span><br><span class="line">You may have encountered a bug in the Ruby interpreter or extension libraries.</span><br><span class="line">Bug reports are welcome.</span><br><span class="line">Don't forget to include the above Crash Report log file.</span><br><span class="line">For details: http://www.ruby-lang.org/bugreport.html</span><br></pre></td></tr></table></figure><p>åœ¨ StackOverflow ä¸Šæ‰¾åˆ°äº†<a href="http://stackoverflow.com/questions/39634404/xcodebuild-exportarchive-no-applicable-devices-found/42027456#42027456" target="_blank" rel="noopener">è¿™ä¸ªè§£å†³æ–¹æ¡ˆ</a>, ä½¿ç”¨ <code>xcbuild-safe.sh</code> æ›¿æ¢ <code>xcodebuilder</code> å°±å¥½äº†</p><h2 id="ä¸‰-You-must-supply-a-CFBundleIdentifier-for-this-request"><a href="#ä¸‰-You-must-supply-a-CFBundleIdentifier-for-this-request" class="headerlink" title="ä¸‰. You must supply a CFBundleIdentifier for this request"></a>ä¸‰. You must supply a CFBundleIdentifier for this request</h2><p>ä¸Šä¼  dis åŒ…æ—¶é‡åˆ°è¿™ä¸ªé”™è¯¯:</p><p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fdjuz90b3cj30w40g2aar.jpg" alt=""></p><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>åœ¨<a href="http://www.jianshu.com/p/2d229dfb34a6" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ä¸­æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ:</p><blockquote><p>infor.plistè¡¨ä¸­Bundle OS Type code æ ä¸ºç©ºæˆ–è€…éAPPL<br>å…·ä½“è®¾ç½®è·¯å¾„ä¸ºï¼Œé¡¹ç›®çš„TARGETS &gt;&gt; infor &gt;&gt; Custom iOS Target Properties &gt;&gt; Bundle OS Type codeï¼Œæ£€æŸ¥æ˜¯å¦ä¸ºç©ºæˆ–è€…å…¶ä»–ã€‚å°†è¯¥é€‰é¡¹è®¾ç½®ä¸º APPLã€‚è‡ªæ­¤ï¼Œé‡æ–°ä¸Šä¼ æˆåŠŸã€‚</p></blockquote><p>è™½ç„¶è§£å†³äº†, ä½†æ˜¯æ¯”è¾ƒå¥‡æ€ªçš„æ˜¯, æˆ‘å¥½å¤šé¡¹ç›®æ²¡æœ‰è®¾ç½®ä¹Ÿå¯ä»¥ä¸Šä¼ æˆåŠŸ.</p><h2 id="å››-è¿æ¥-VPN-åæœ‰çš„-http-è¯·æ±‚ä¼šå¤±è´¥"><a href="#å››-è¿æ¥-VPN-åæœ‰çš„-http-è¯·æ±‚ä¼šå¤±è´¥" class="headerlink" title="å››. è¿æ¥ VPN åæœ‰çš„ http è¯·æ±‚ä¼šå¤±è´¥"></a>å››. è¿æ¥ VPN åæœ‰çš„ http è¯·æ±‚ä¼šå¤±è´¥</h2><p>è¿™ä¸ªå¾ˆè¯¡å¼‚å‘€, ä¸è¿æ¥ VPN æ²¡æœ‰ä»»ä½•é—®é¢˜.</p><h3 id="è§£å†³æ–¹æ¡ˆ-3"><a href="#è§£å†³æ–¹æ¡ˆ-3" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>æˆ‘åœ¨ Exception Domain æ·»åŠ å¯¹åº”åŸŸåä¹‹åå°±å¯ä»¥è®¿é—®äº†. çŒœæµ‹æ˜¯ä¸æ˜¯æœçˆ¹å¯¹å¤§é™† ip æ”¾å®½äº†è¦æ±‚ ? å“ˆå“ˆå“ˆ</p><h2 id="äº”-This-action-could-not-be-completed-Try-again-22421"><a href="#äº”-This-action-could-not-be-completed-Try-again-22421" class="headerlink" title="äº”. This action could not be completed.Try again.(-22421)"></a>äº”. This action could not be completed.Try again.(-22421)</h2><p>è¿˜æ˜¯ä¸Šä¼  dis åŒ…åˆ° iTunes åå°çš„æ—¶å€™, ä¼šé‡åˆ°è¿™ä¸ªé”™è¯¯:</p><p><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fdjv6l9qzij30dh038wep.jpg" alt=""></p><h3 id="è§£å†³æ–¹æ¡ˆ-4"><a href="#è§£å†³æ–¹æ¡ˆ-4" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>åœ¨<a href="http://www.jianshu.com/p/a9f818ac1066" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ä¸­æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆ:</p><blockquote><p>æš‚æ—¶è¯·ä½¿ç”¨ -Application Loaderä¸Šä¼ appç¨‹åº</p></blockquote><h2 id="å…­-iOS-æ²™ç›’æµ‹è¯•å……å€¼ä¸€æ¬¡æˆåŠŸ-ä¸€æ¬¡å¤±è´¥"><a href="#å…­-iOS-æ²™ç›’æµ‹è¯•å……å€¼ä¸€æ¬¡æˆåŠŸ-ä¸€æ¬¡å¤±è´¥" class="headerlink" title="å…­. iOS æ²™ç›’æµ‹è¯•å……å€¼ä¸€æ¬¡æˆåŠŸ, ä¸€æ¬¡å¤±è´¥"></a>å…­. iOS æ²™ç›’æµ‹è¯•å……å€¼ä¸€æ¬¡æˆåŠŸ, ä¸€æ¬¡å¤±è´¥</h2><p>åœ¨æ²™ç›’æµ‹è¯•å……å€¼æ—¶, è¿™æ¬¡å¤±è´¥äº†, ä¸‹æ¬¡å°±ä¼šæˆåŠŸ, ä¸»è¦å‘ç”Ÿåœ¨å°é¢é¢çš„å……å€¼é¡¹ä¸Š.</p><h3 id="è§£å†³æ–¹æ¡ˆ-5"><a href="#è§£å†³æ–¹æ¡ˆ-5" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p><img src="https://ww2.sinaimg.cn/large/006tNbRwly1fdjvcfmifbj31as0foq6c.jpg" alt=""></p><p>è‹¹æœå•†åº—æŠ½é£, æ²¡å•¥è§£å†³æ–¹æ¡ˆ.</p><h2 id="å…­-è‹¹æœæäº¤å®¡æ ¸ï¼Œå› ä¸ºåº”ç”¨åç§°ä¸åˆæ³•è¢«æ‹’ï¼Œæ”¹å®Œæäº¤è¿˜æ˜¯è¢«æ‹’"><a href="#å…­-è‹¹æœæäº¤å®¡æ ¸ï¼Œå› ä¸ºåº”ç”¨åç§°ä¸åˆæ³•è¢«æ‹’ï¼Œæ”¹å®Œæäº¤è¿˜æ˜¯è¢«æ‹’" class="headerlink" title="å…­. è‹¹æœæäº¤å®¡æ ¸ï¼Œå› ä¸ºåº”ç”¨åç§°ä¸åˆæ³•è¢«æ‹’ï¼Œæ”¹å®Œæäº¤è¿˜æ˜¯è¢«æ‹’"></a>å…­. è‹¹æœæäº¤å®¡æ ¸ï¼Œå› ä¸ºåº”ç”¨åç§°ä¸åˆæ³•è¢«æ‹’ï¼Œæ”¹å®Œæäº¤è¿˜æ˜¯è¢«æ‹’</h2><p>è¿™ä¸ªæ˜¯è‹¹æœçš„å›å¤:</p><blockquote><p>We still find that your app name to be displayed on the App Store includes descriptors, which are not appropriate for use in an app name.<br>Specifically, the following words in your app names are considered descriptors</p></blockquote><h3 id="è§£å†³æ–¹æ¡ˆ-6"><a href="#è§£å†³æ–¹æ¡ˆ-6" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>å¯ä»¥æŸ¥çœ‹æ˜¯å¦åœ¨iTunes connect åå°æ·»åŠ äº†å¤šä¸ªè¯­è¨€ï¼Œè€Œåªä¿®æ”¹äº†ä¸€ç§è¯­è¨€ã€‚</p><h2 id="ä¸ƒ-XCode-å®‰è£…åº”ç”¨å‡ºé”™"><a href="#ä¸ƒ-XCode-å®‰è£…åº”ç”¨å‡ºé”™" class="headerlink" title="ä¸ƒ. XCode å®‰è£…åº”ç”¨å‡ºé”™"></a>ä¸ƒ. XCode å®‰è£…åº”ç”¨å‡ºé”™</h2><p>è¿™ä¸ªæ˜¯é”™è¯¯å†…å®¹:</p><blockquote><p>This applicationâ€™s application-identifier entitlement does not match that of the installed application. These values must match for an upgrade to be allowed.</p></blockquote><h3 id="è§£å†³æ–¹æ¡ˆ-7"><a href="#è§£å†³æ–¹æ¡ˆ-7" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>åˆ é™¤æ‰‹æœºä¸Šå·²ç»å®‰è£…çš„åº”ç”¨å°±å¥½äº†</p>]]></content>
    
    <summary type="html">
    
      ä¸‡ä¸€é‡ä¸Šäº†å‘¢?
    
    </summary>
    
    
      <category term="iOS" scheme="http://blog.justbilt.com/tags/iOS/"/>
    
      <category term="iOS-Dev-Tips" scheme="http://blog.justbilt.com/tags/iOS-Dev-Tips/"/>
    
  </entry>
  
  <entry>
    <title>Quick-Cocos2d-x ä¸­çš„é¢å‘å¯¹è±¡</title>
    <link href="http://blog.justbilt.com/2017/03/04/quick-x-oop/"/>
    <id>http://blog.justbilt.com/2017/03/04/quick-x-oop/</id>
    <published>2017-03-04T02:04:44.000Z</published>
    <updated>2017-07-09T03:09:19.000Z</updated>
    
    <content type="html"><![CDATA[<p>è™½è¯´ç°åœ¨ä¸€ç›´æå€¡ç»„åˆä¼˜äºç»§æ‰¿, ä½†æ˜¯æˆ‘ä»¬è¿™å¸®æ·±å— c++ æ¯’å®³çš„å¤§å¥½é’å¹´è¿˜æ˜¯å¯¹ç»§æ‰¿æœ‰ç€æ·±æ·±çš„æ„Ÿæƒ…. Lua è¿™é—¨è¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æä¾›é¢å‘å¯¹è±¡çš„æœºåˆ¶, ä¸è¿‡æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„é€šè¿‡ Lua çš„ metatable æ¥å®ç°ä¸€å¥—é¢å‘å¯¹è±¡çš„æœºåˆ¶.</p><a id="more"></a><h1 id="ä¸€-å®ç°æœºåˆ¶"><a href="#ä¸€-å®ç°æœºåˆ¶" class="headerlink" title="ä¸€. å®ç°æœºåˆ¶"></a>ä¸€. å®ç°æœºåˆ¶</h1><p>å®ç°çš„åŸç†å¾ˆç®€å•, å¦‚æœä¸€ä¸ª Lua çš„ table1 é€šè¿‡ <code>setmetatable</code> å‡½æ•°è®¾ç½®äº†å…ƒè¡¨ä¹‹å, å¦‚æœè¯•å›¾è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ <code>å±æ€§</code>, å°±ä¼šè§¦å‘è¿™ä¸ª metatable çš„ <code>__index</code> å…ƒæ–¹æ³•, è¿™ä¸ª __index å¯ä»¥æ˜¯å¦ä¸€ä¸ª table2 , è¿™æ ·å®ƒå°±å›å»è¿™ä¸ª table2 ä¸­å»æ‰¾é‚£ä¸ªå±æ€§äº†, å¦‚æœ table2 ä¸­è¿˜æ²¡æœ‰çš„è¯, å°±ä¼šè§¦å‘ table2 çš„å…ƒæ–¹æ³•, å°±è¿™æ ·ä¸€å±‚ä¸€å±‚çš„å¾€ä¸Šæ‰¾. æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªååˆ†ç®€å•çš„æ —å­æ¥æµ‹è¯•ä¸‹è¿™ä¸ªåŠŸèƒ½:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> a = &#123;aa = <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">local</span> b = &#123;bb = <span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">local</span> c = &#123;cc = <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>(b, &#123;<span class="built_in">__index</span> = a&#125;)</span><br><span class="line"><span class="built_in">setmetatable</span>(c, &#123;<span class="built_in">__index</span> = b&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"aa:"</span>, c.aa, <span class="string">"bb:"</span>, c.bb, <span class="string">"cc"</span>, c.cc) <span class="comment">-- output: aa:  1   bb: 2   cc  3</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸Š, åªæ˜¯åŠ äº†ä¸¤ä¸ª <code>setmetatable</code>, c ä¾¿å¯ä»¥è®¿é—®åˆ° a å’Œ b çš„å±æ€§, æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡.</p><h1 id="äºŒ-Quick-cocos2d-x-ä¸­çš„å®ç°"><a href="#äºŒ-Quick-cocos2d-x-ä¸­çš„å®ç°" class="headerlink" title="äºŒ. Quick-cocos2d-x ä¸­çš„å®ç°"></a>äºŒ. Quick-cocos2d-x ä¸­çš„å®ç°</h1><p>Quick-Cocos2d-x ä½œä¸ºä¸€ä¸ª framework è‡ªç„¶ä¹Ÿå®ç°äº†ä¸€å¥—è¿™æ ·çš„æœºåˆ¶, å› ä¸ºå‡½æ•°å®ç°æ¯”è¾ƒé•¿, æ‰€ä»¥æˆ‘å°±ä¸ç²˜è´´ä»£ç äº†, å¤§å®¶å¯ä»¥<a href="https://github.com/chukong/quick-cocos2d-x/blob/master/framework/functions.lua#L281-L339" target="_blank" rel="noopener">è·³è½¬è¿™é‡ŒæŸ¥çœ‹</a>. çºµè§‚è¿™æ®µä»£ç , å¯ä»¥ä»¥æœ€å¤–å±‚çš„ <code>if-else</code> å°†è¿™æ®µé€»è¾‘åˆ†æˆä¸¤éƒ¨åˆ†, ç»§æ‰¿è‡ª Cocos çš„å¯¹è±¡å’Œç»§æ‰¿è‡ª Lua çš„ Table, ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåˆ†å‘¢ ?</p><p>å› ä¸º Cocos çš„å¯¹è±¡åœ¨ Lua ä¸­çš„ type æ˜¯ <code>userdata</code>, æ˜¯ä¸èƒ½è®¾ç½® metatable çš„, æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰è¯´çš„é‚£å¥—ç»§æ‰¿çš„æ–¹æ³•å°±è¡Œä¸é€šäº†, Quick-cocos2d-x åœ¨è¿™é‡Œçš„é€‰æ‹©æ˜¯æŠŠæ‰€æœ‰çš„å˜é‡éƒ½å¤åˆ¶ä¸€ä»½, åšäº†ä¸€æ¬¡ä¸€ç»´çš„æ·±æ‹·è´. </p><p>æ‰€ä»¥, æŠ›å¼€ç»§æ‰¿çš„å®ç°ä¸åŒ, è¿™ä¸¤ä¸ªåˆ†æ”¯çš„é€»è¾‘æ˜¯ä¸€è‡´çš„. æˆ‘ä»¬ç²¾ç®€ä¸‹, å¯ä»¥åˆ†ç¦»å‡ºä¸‹é¢è¿™æ®µç®€çŸ­çš„ä»£ç :</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">class</span><span class="params">(_name, _super)</span></span></span><br><span class="line">    <span class="keyword">local</span> cls = &#123;__cname = _name, super = _super&#125;</span><br><span class="line">    <span class="keyword">if</span> _super <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">setmetatable</span>(cls, &#123;<span class="built_in">__index</span> = _super&#125;)</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cls.ctor = <span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cls.new</span><span class="params">(...)</span></span></span><br><span class="line">        <span class="keyword">local</span> instance = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123;<span class="built_in">__index</span> = cls&#125;)</span><br><span class="line">        instance:ctor(...)</span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> cls</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>è¿™çŸ­çŸ­åå‡ è¡Œä»£ç å‡ ä¹å·²ç»åŒ…å«äº†é¢å‘å¯¹è±¡çš„æ‰€æœ‰ç‰¹æ€§, æœ‰å®ä¾‹å‡½æ•° <code>new</code>, æœ‰é»˜è®¤æ„é€ å‡½æ•° <code>ctor</code>, å¯ä»¥è®¿é—®çˆ¶ç±» <code>super</code>. </p><p>å¤§å®¶å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç æœ‰ä¸¤æ¬¡ <code>setmetatable</code>, ç¬¬ä¸€æ¬¡æ˜¯åœ¨åˆ›å»º cls çš„æ—¶å€™, æ˜¯ä¸ºäº†è®© cls èƒ½å¤Ÿè®¿é—®åˆ° super ä¸­çš„å±æ€§; ç¬¬äºŒæ¬¡æ˜¯åœ¨äº§ç”Ÿå®ä¾‹ <code>instance</code> çš„æ—¶å€™, æ˜¯ä¸ºäº†è®©å®ä¾‹èƒ½å¤Ÿè®¿é—®åˆ° cls ä¸­çš„å±æ€§. </p><h1 id="ä¸‰-è¦æ³¨æ„çš„åœ°æ–¹"><a href="#ä¸‰-è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="ä¸‰. è¦æ³¨æ„çš„åœ°æ–¹"></a>ä¸‰. è¦æ³¨æ„çš„åœ°æ–¹</h1><p>ä¸‹é¢è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªå…¸å‹çš„é¢å‘å¯¹è±¡ç¤ºä¾‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> Animal = class(<span class="string">"Animal"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal:ctor</span><span class="params">(_name)</span></span></span><br><span class="line">    self.name = _name</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal:say</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"i couldn't say!"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> Dog = class(<span class="string">"Dog"</span>, Animal)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog:ctor</span><span class="params">(_name, _age)</span></span></span><br><span class="line">    Dog.super.ctor(self, _name)</span><br><span class="line">    self.age = _age</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog:say</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">"I'm a %s, my name is %s, i'm %s years old."</span>, self.__cname, self.name, self.age))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Dog.new(<span class="string">"Jack"</span>, <span class="number">5</span>):say()</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹ç¬¬ <code>14</code> è¡Œä»£ç , è¿™è¡Œä»£ç æœ‰äº›å¥‡æ€ª.</p><h2 id="1-ä¸ºä»€ä¹ˆç”¨ç±»åå»è°ƒç”¨-super"><a href="#1-ä¸ºä»€ä¹ˆç”¨ç±»åå»è°ƒç”¨-super" class="headerlink" title="1. ä¸ºä»€ä¹ˆç”¨ç±»åå»è°ƒç”¨ super ?"></a>1. ä¸ºä»€ä¹ˆç”¨ç±»åå»è°ƒç”¨ super ?</h2><p>å½“ç»§æ‰¿åˆ°ç¬¬ä¸‰å±‚çš„æ—¶å€™ self.super ä» C è·³è½¬åˆ° B æ—¶ self è¿˜æ˜¯ C çš„å®ä¾‹, è¿™æ—¶ B ä¸­ self.super å…¶å®è¿˜ B, å°±ä¼šé€ æˆ stack overflow.</p><h2 id="2-ä¸ºä»€ä¹ˆæ˜¯ç±»å-super-è€Œä¸æ˜¯-super"><a href="#2-ä¸ºä»€ä¹ˆæ˜¯ç±»å-super-è€Œä¸æ˜¯-super" class="headerlink" title="2. ä¸ºä»€ä¹ˆæ˜¯ç±»å . super è€Œä¸æ˜¯ : super ?"></a>2. ä¸ºä»€ä¹ˆæ˜¯ç±»å <code>.</code> super è€Œä¸æ˜¯ <code>:</code> super ?</h2><p>é¦–å…ˆå¤§å®¶è¦æ˜ç™½ Lua ä¸­ <code>.</code> å’Œ <code>:</code> è°ƒç”¨å‡½æ•°çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ ?</p><blockquote><p>å†’å·è°ƒç”¨æ˜¯ Lua æä¾›çš„ä¸€ä¸ªè¯­æ³•ç³–, é»˜è®¤ä¼šå°†å‡½æ•°çš„è°ƒç”¨è€…ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥.</p></blockquote><p>åŒºåˆ«åœ¨äºçˆ¶ç±»çš„å‡½æ•°æ”¶åˆ°çš„ self æ˜¯ <code>self</code> (å³ Dog çš„å®ä¾‹) è¿˜æ˜¯ <code>Dog.super</code> (å³ Animal) , å¾ˆæ˜æ˜¾åº”è¯¥æ˜¯åè€….</p><h1 id="å››-æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹"><a href="#å››-æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹" class="headerlink" title="å››. æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹"></a>å››. æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹</h1><p>å¾ˆæ—©ä¹‹å‰å°±æ‹œè¯»è¿‡<a href="http://jennal.com/2014/10/18/cocos2dx-lua-oop/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>, è¿™ç¯‡æ–‡ç« ä¸­åˆ—ä¸¾äº†ä¸€äº›ä½œè€…çš„ç–‘æƒ‘, å¾ˆæœ‰æ”¶è·, å¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹. æ–‡ç« ä¸­æå‡ºäº†ä¸¤æ¡:</p><blockquote><p>é—®é¢˜1ï¼šä»çˆ¶ç±»åšæ·±åº¦æ‹·è´<br>é—®é¢˜4ï¼šåˆ›å»ºå®ä¾‹æ—¶çš„æ·±åº¦æ‹·è´</p></blockquote><p>ä½œè€…å½“æ—¶å¯èƒ½å¿½ç•¥äº†æˆ‘ä»¬åˆšæ‰åšçš„è§£é‡Š: <em>æ— æ³•å‘ä¸€ä¸ª userdata è®¾ç½® metatable</em> , é‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œæ˜¯å¦çœŸçš„éœ€è¦ä¸€æ¬¡æ·±æ‹·è´å‘¢ ? è®©æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜:</p><blockquote><p>æ—¢ç„¶ Cocos çš„å¯¹è±¡æ˜¯ä¸€ä¸ª <code>userdata</code>, é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆå¯ä»¥å¾€è¿™ä¸ª userdata ä¸Šæ·»åŠ æ–°çš„ Lua å±æ€§å‘¢ ?</p></blockquote><p>Quick-Cocos2d-x ä¸º C++ å¯¼å‡º Lua æ¥å£çš„å·¥å…·æ˜¯ tolua++ , å…¶ä¸­æœ‰ä¸¤ä¸ªæ¥å£å«: <code>tolua.setpeer</code> å’Œ <code>tolua.gerpeer</code> , è¿™ä¸ª peer åˆæ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ ?</p><p><img src="https://ww1.sinaimg.cn/large/006tNc79ly1fdbsvt09tnj313o08ewg5.jpg" alt=""></p><p>è¿™å¼ å›¾æ˜¯å…­æœˆå¤§å¤§åœ¨ Cocos è®ºå›ä¸­çš„å›å¤, æˆ‘ä»¬å¯ä»¥ç†è§£ä¸º <code>peer</code> æ˜¯ç”¨æ¥å­˜å‚¨ C++ å¯¹è±¡åœ¨ Lua ä¸­çš„æ‰©å±•çš„, ä»–çš„æœ¬è´¨æ˜¯ä¸€ä¸ª table. å¦‚æœæˆ‘ä»¬è¯•å›¾è®¿é—®ä¸€ä¸ª userdata ç±»å‹çš„å±æ€§æ—¶, å¦‚æœè¿™ä¸ª userdata è®¾ç½®äº† peer è¡¨, ä¼šä¼˜å…ˆä»è¿™ä¸ªè¡¨ä¸­å–å€¼.</p><p>æ—¢ç„¶è¿™ä¸ª <code>peer</code> æ˜¯ä¸€ä¸ª table, é‚£ä¹ˆæ˜¯å¦å¯ä»¥ä¸ºè¿™ä¸ª table è®¾ç½®å…ƒè¡¨, è¿™æ ·åœ¨ peer è¡¨ä¸­æ‰¾ä¸åˆ°å°±ä¼šè§¦å‘ __index .</p><p>æˆ‘ä»¬å¯¹ class çš„å®ç°åšå‡ºä¸‹é¢çš„ä¿®æ”¹:</p><p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fdbtiv4cbaj30v009i3zv.jpg" alt=""></p><p>ç”¨è®¾ç½® peer è¡¨çš„ metatable æ¥ä»£æ›¿åŸæ¥çš„æ·±æ‹·è´, é‡æ–°è¿è¡Œæˆ‘ä»¬çš„é¡¹ç›®, å®Œç¾. è®©æˆ‘ä»¬æƒ³æƒ³ä¸‹è¿™ä¸ªå®ç°å¸¦æ¥çš„ä¼˜åŠ¿: <strong>æ›´å¿«, æ›´çœå†…å­˜</strong>, ä¸ºæ­¤æˆ‘åšäº†ä¸€ä¸ªå°çš„æ€§èƒ½æµ‹è¯•:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> A = class(<span class="string">"A"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> cc.Node:<span class="built_in">create</span>()</span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">100</span> <span class="keyword">do</span></span><br><span class="line">    A[<span class="string">"a_index_"</span>..i] = i</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> B = class(<span class="string">"B"</span>, A)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, <span class="number">100</span> <span class="keyword">do</span></span><br><span class="line">    B[<span class="string">"b_index_"</span>..i] = i</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">10000</span> <span class="keyword">do</span></span><br><span class="line">    B.new()</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>æˆ‘è®¾è®¡äº† A,B ä¸¤ä¸ªç±», B ç»§æ‰¿è‡ª A, æ¯ä¸ªå„æœ‰ 100 ä¸ªæˆå‘˜å˜é‡, æœ€ååˆ›å»º 10000 ä¸ª B çš„å®ä¾‹. ç»Ÿè®¡äº†ä¸‹å†…å­˜çš„å ç”¨æƒ…å†µå’Œè€—æ—¶. ç»“æœå¦‚ä¸‹:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ·±æ‹·è´:</span><br><span class="line">è€—æ—¶: <span class="number">2.988687</span></span><br><span class="line">å†…å­˜: <span class="number">134.1</span>M</span><br><span class="line"></span><br><span class="line"><span class="built_in">setmetatable</span>:</span><br><span class="line">è€—æ—¶: <span class="number">0.107388</span></span><br><span class="line">å†…å­˜: <span class="number">38.9</span>M</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç›¸å·®å¾ˆå¤šå‘€, æ„Ÿè§‰è‡ªå·±é©¬ä¸Šå°±è¦èµ°ä¸Šäººç”Ÿå·…å³°äº†. æ—¢ç„¶ç›¸å·®è¿™ä¹ˆå¤š, è€Œå»–å¤§è²Œä¼¼ä¹Ÿæ—©å·²å‘ç°äº†è¿™ä¸ªé—®é¢˜:</p><p><img src="https://ww3.sinaimg.cn/large/006tNbRwly1fdbv2g5bfoj30m208mjs8.jpg" alt=""></p><p>ä¸ºä»€ä¹ˆç›´åˆ° 3.3 ç‰ˆæœ¬è¿˜æ²¡æœ‰æ”¹åŠ¨å‘¢ ? è«éæ˜¯æˆ‘å“ªé‡Œè®¡ç®—é”™äº†, æŠ›å¼€æµ‹è¯•, æˆ‘åœ¨æˆ‘ä»¬çš„ä¸€ä¸ªçº¿ä¸Šé¡¹ç›®ä¸­åšäº†ä¸€ä¸ªçœŸæ˜¯çš„æµ‹è¯•, ç»“æœä»¤æˆ‘å¤§è·Œçœ¼é•œ.</p><blockquote><p>ç›¸å·®æ— å‡ </p></blockquote><p>ä»”ç»†æƒ³äº†ä¸‹, æ˜¯å¦æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰ 100 ä¸ªå±æ€§, æ¸¸æˆå†…æ˜¯å¦ä¼šåŒæ—¶å­˜åœ¨ 1w ä¸ªå¯¹è±¡ ? æ‰€ä»¥é‚£ä»½æµ‹è¯•æ˜¯æ²¡æœ‰æ„ä¹‰çš„, ä½†æ˜¯è¿™ä¸ªæ”¹åŠ¨å´æ˜¯å¾ˆæœ‰æ„ä¹‰çš„.</p><p>å…¶å®åœ¨å‘ç° peer è¡¨ä¹‹å‰, æˆ‘è¿˜åšè¿‡å¦ä¸€ä¸ªå°è¯•, å¯¹äº userdata ç±»å‹çš„å®ä¾‹, ä¸è¿”å›è¿™ä¸ªå®ä¾‹, è€Œæ˜¯è¿”å›ä¸€ä¸ª table, æœ‰ä¸€ä¸ªå±æ€§ <code>_cobj</code> , è®¾ç½®è¿™ä¸ª table çš„å…ƒè¡¨, ä½¿å¾—æ‰€æœ‰çš„å±æ€§éƒ½ä¼˜å…ˆä» <code>_cobj</code> ä¸­å–, å–ä¸åˆ°å†å» super ä¸­å–, åæ¥å› ä¸ºæ”¹åŠ¨å¤ªå¤§, å°±æ”¾å¼ƒäº†, ä¸è¿‡åœ¨è¿™ä¸ªæ”¹åŠ¨çš„è¿‡ç¨‹ä¸­æ„å¤–çš„å‘ç° peer è¡¨çš„å­˜åœ¨.</p><p>å¤šæŠ˜è…¾, æ€»ä¼šæœ‰æ‰€æ”¶è·çš„.</p>]]></content>
    
    <summary type="html">
    
      æ²¡æœ‰å¯¹è±¡? è‡ªå·± new ä¸€ä¸ªå°±å¥½äº†å˜›!
    
    </summary>
    
    
      <category term="Quick-Cocos2d-x" scheme="http://blog.justbilt.com/tags/Quick-Cocos2d-x/"/>
    
  </entry>
  
</feed>
